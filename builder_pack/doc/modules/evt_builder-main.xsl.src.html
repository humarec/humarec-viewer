<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html><head><title>XML source view</title><link rel="stylesheet" type="text/css" href="../xmlverbatim.css"></link></head><body class="xmlverb-default"><tt>
<!-- converted by xmlverbatim.xsl 1.1, (c) O. Becker -->
<div xmlns:xd="http://www.pnp-software.com/XSLTdoc" class="xmlverb-default">&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1">stylesheet</a></span><span class="xmlverb-ns-name"> xmlns:xsl</span>="<span class="xmlverb-ns-uri">http://www.w3.org/1999/XSL/Transform</span>"<span class="xmlverb-ns-name"> xmlns:xs</span>="<span class="xmlverb-ns-uri">http://www.w3.org/2001/XMLSchema</span>"<span class="xmlverb-ns-name"> xmlns:eg</span>="<span class="xmlverb-ns-uri">http://www.tei-c.org/ns/Examples</span>"<span class="xmlverb-ns-name"> xmlns:xd</span>="<span class="xmlverb-ns-uri">http://www.pnp-software.com/XSLTdoc</span>"<span class="xmlverb-ns-name"> xmlns:fn</span>="<span class="xmlverb-ns-uri">http://www.w3.org/2005/xpath-functions</span>"<span class="xmlverb-ns-name"> xmlns:tei</span>="<span class="xmlverb-ns-uri">http://www.tei-c.org/ns/1.0</span>"<span class="xmlverb-ns-name"> xmlns</span>="<span class="xmlverb-ns-uri">http://www.w3.org/1999/xhtml</span>" <span class="xmlverb-attr-name">xpath-default-namespace</span>="<span class="xmlverb-attr-content">http://www.tei-c.org/ns/1.0</span>" <span class="xmlverb-attr-name">version</span>="<span class="xmlverb-attr-content">2.0</span>" <span class="xmlverb-attr-name">exclude-result-prefixes</span>="<span class="xmlverb-attr-content">#all</span>"&gt;<span class="xmlverb-text"><br></br>
        <br></br>
        </span><div class="xd">
	
	&lt;<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name"><a name="d20e3">doc</a></span> <span class="xmlverb-attr-name">type</span>="<span class="xmlverb-attr-content">stylesheet</span>"&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name"><a name="d20e5">short</a></span>&gt;<span class="xmlverb-text"><br></br>
                        EN: Main calls for building the system<br></br>
                        IT: Le chiamate principali per il build del sistema<br></br>
                </span>&lt;/<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name">short</span>&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;/<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name">doc</span>&gt;</div><span class="xmlverb-text"><br></br>
<br></br>
        </span>&lt;!--<span class="xmlverb-comment"> All </span>--&gt;<span class="xmlverb-text"><br></br>
    </span><div class="xd">
	
	&lt;<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name"><a name="d20e11">doc</a></span>&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name"><a name="d20e13">short</a></span>&gt;<span class="xmlverb-text"><br></br>
                        EN: Main system call<br></br>
                        IT: Chiamata principale del sistema<br></br>
        </span>&lt;/<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name">short</span>&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name"><a name="d20e16">detail</a></span>&gt;<span class="xmlverb-text"><br></br>
                        EN: The first part outputs the HTML files for the different edition levels, while the second one calls the general template to build the index.<br></br>
                        IT: La prima parte produce in output i file HTML delle diverse edizioni, mentre la seconda richiama il template generale per il build della index.<br></br>
                </span>&lt;/<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name">detail</span>&gt;<span class="xmlverb-text"><br></br>
    </span>&lt;/<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name">doc</span>&gt;</div><span class="xmlverb-text"><br></br>
        <br></br>
        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e20">output</a></span> <span class="xmlverb-attr-name">indent</span>="<span class="xmlverb-attr-content">yes</span>" <span class="xmlverb-attr-name">method</span>="<span class="xmlverb-attr-content">html</span>" <span class="xmlverb-attr-name">encoding</span>="<span class="xmlverb-attr-content">UTF-8</span>" <span class="xmlverb-attr-name">media-type</span>="<span class="xmlverb-attr-content">text/plain</span>" <span class="xmlverb-attr-name">doctype-public</span>="<span class="xmlverb-attr-content">-//W3C//DTD XHTML 1.0 Strict//EN</span>" <span class="xmlverb-attr-name">doctype-system</span>="<span class="xmlverb-attr-content">http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd</span>" /&gt;<span class="xmlverb-text"><br></br>
<br></br>
        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e22">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">root</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">/</span>" /&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e25">template</a></span> <span class="xmlverb-attr-name">match</span>="<span class="xmlverb-attr-content">/</span>" <span class="xmlverb-attr-name">priority</span>="<span class="xmlverb-attr-content">1</span>"&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;!--<span class="xmlverb-comment"> Found the node(s) for embedded transcription</span>--&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;!--<span class="xmlverb-comment"> <br></br>
                        &lt;xsl:choose&gt;<br></br>
                                &lt;xsl:when test="tei:TEI/tei:sourceDoc"&gt;<br></br>
                                <br></br>
                                &lt;xsl:apply-templates select="." mode="splitPages4embedded"&gt;&lt;/xsl:apply-templates&gt;<br></br>
                                &lt;xsl:apply-templates select="." mode="structure_generation4embedded"&gt;&lt;/xsl:apply-templates&gt;<br></br>
                        &lt;/xsl:when&gt;<br></br>
                        &lt;xsl:otherwise&gt;<br></br>
                                &lt;xsl:apply-templates select="$step0" mode="splitPages"&gt;&lt;/xsl:apply-templates&gt;<br></br>
                                &lt;xsl:apply-templates select="$step0" mode="file4search"&gt;&lt;/xsl:apply-templates&gt;<br></br>
                                &lt;xsl:apply-templates select="$step0" mode="structure_generation"&gt;&lt;/xsl:apply-templates&gt;<br></br>
                        &lt;/xsl:otherwise&gt;<br></br>
                &lt;/xsl:choose&gt;</span>--&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;!--<span class="xmlverb-comment"> CDP: Embedded </span>--&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;!--<span class="xmlverb-comment"> EN: If there is at least a &lt;sourceDoc&gt; element the transformations for embedded are activated </span>--&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;!--<span class="xmlverb-comment"> IT: Le trasformazioni per l'embedded transcription vengono attivate se nel documento esiste almeno un elemento &lt;sourceDoc&gt; </span>--&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e38">if</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">tei:TEI/tei:sourceDoc</span>"&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e40">apply-templates</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">.</span>" <span class="xmlverb-attr-name">mode</span>="<span class="xmlverb-attr-content">splitPages4embedded</span>" /&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;!--<span class="xmlverb-comment"> SEARCH </span>--&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e44">if</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">$search=true()</span>"&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e46">apply-templates</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">.</span>" <span class="xmlverb-attr-name">mode</span>="<span class="xmlverb-attr-content">file4search4embedded</span>" /&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">if</span>&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">if</span>&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;!--<span class="xmlverb-comment"> EN: If there is at least a &lt;text&gt; element the transformations for parallel transcription are activated </span>--&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;!--<span class="xmlverb-comment"> IT: Le trasformazioni per la parallel transcription vengono attivate se nel documento esiste almeno un elemento &lt;text&gt; </span>--&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e54">if</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">tei:TEI/tei:text</span>"&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e56">apply-templates</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$step0</span>" <span class="xmlverb-attr-name">mode</span>="<span class="xmlverb-attr-content">splitPages</span>" /&gt;<span class="xmlverb-text"><br></br>
                        <br></br>
                        </span>&lt;!--<span class="xmlverb-comment"> HEADER INFORMATION </span>--&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e60">if</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">$headerInfo=true()</span>"&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e62">call-template</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">headerInfo</span>" /&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">if</span>&gt;<span class="xmlverb-text"><br></br>
                        <br></br>
                        </span>&lt;!--<span class="xmlverb-comment"> MANUSCRIPT DESCRIPTION </span>--&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e67">if</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">$msDesc=true()</span>"&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e69">call-template</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">msDesc</span>" /&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">if</span>&gt;<span class="xmlverb-text"><br></br>
                        <br></br>
                        </span>&lt;!--<span class="xmlverb-comment"> REGESTO </span>--&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e75">if</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">$regesto=true()</span>"&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e77">for-each</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">tei:TEI/tei:text/tei:group/tei:text</span>"&gt;<span class="xmlverb-text"><br></br>
                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e79">call-template</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">regesto</span>" /&gt;<span class="xmlverb-text">        <br></br>
                                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">for-each</span>&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">if</span>&gt;<span class="xmlverb-text"><br></br>
                        <br></br>
                        </span>&lt;!--<span class="xmlverb-comment"> FRONT INFORMATION </span>--&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e85">if</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">$frontInfo=true()</span>"&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e87">choose</a></span>&gt;<span class="xmlverb-text"><br></br>
                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e89">when</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">$root//tei:text/tei:group</span>"&gt;<span class="xmlverb-text"><br></br>
                                                </span>&lt;!--<span class="xmlverb-comment"> Gestione TEXT multipli in tei:group </span>--&gt;<span class="xmlverb-text"><br></br>
                                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e93">for-each</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$root//tei:text/tei:group/tei:text</span>"&gt;<span class="xmlverb-text"><br></br>
                                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e95">if</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">current()/tei:front</span>"&gt;<span class="xmlverb-text"><br></br>
                                                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e97">call-template</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">front</span>" /&gt;<span class="xmlverb-text"><br></br>
                                                        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">if</span>&gt;<span class="xmlverb-text">                                                <br></br>
                                                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">for-each</span>&gt;<span class="xmlverb-text"><br></br>
                                        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">when</span>&gt;<span class="xmlverb-text"><br></br>
                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e102">otherwise</a></span>&gt;<span class="xmlverb-text"><br></br>
                                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e104">for-each</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">tei:TEI/tei:text</span>"&gt;<span class="xmlverb-text"><br></br>
                                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e106">if</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">current()/tei:front</span>"&gt;<span class="xmlverb-text"><br></br>
                                                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e108">call-template</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">front</span>" /&gt;<span class="xmlverb-text"><br></br>
                                                        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">if</span>&gt;<span class="xmlverb-text"><br></br>
                                                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">for-each</span>&gt;<span class="xmlverb-text"><br></br>
                                        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">otherwise</span>&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">choose</span>&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">if</span>&gt;<span class="xmlverb-text"><br></br>
                        <br></br>
                        </span>&lt;!--<span class="xmlverb-comment"> LISTS </span>--&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e117">if</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">$list_person=true()</span>"&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e119">result-document</a></span> <span class="xmlverb-attr-name">method</span>="<span class="xmlverb-attr-content">html</span>" <span class="xmlverb-attr-name">encoding</span>="<span class="xmlverb-attr-content">UTF-8</span>" <span class="xmlverb-attr-name">media-type</span>="<span class="xmlverb-attr-content">text/plain</span>" <span class="xmlverb-attr-name">byte-order-mark</span>="<span class="xmlverb-attr-content">yes</span>" <span class="xmlverb-attr-name">href</span>="<span class="xmlverb-attr-content">{$filePrefix}/data/output_data/liste/listPerson.html</span>" <span class="xmlverb-attr-name">indent</span>="<span class="xmlverb-attr-content">yes</span>"&gt;<span class="xmlverb-text"><br></br>
                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e121">element</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">div</span>"&gt;<span class="xmlverb-text"><br></br>
                                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e123">attribute</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">id</span>"&gt;<span class="xmlverb-text">listPerson</span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">attribute</span>&gt;<span class="xmlverb-text"><br></br>
                                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e126">attribute</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">class</span>"&gt;<span class="xmlverb-text">can-change-font-size</span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">attribute</span>&gt;<span class="xmlverb-text"><br></br>
                                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e129">call-template</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">listPerson</span>" /&gt;<span class="xmlverb-text"><br></br>
                                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e131">apply-templates</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$step0</span>" <span class="xmlverb-attr-name">mode</span>="<span class="xmlverb-attr-content">listPersonOccurences</span>" /&gt;<span class="xmlverb-text"><br></br>
                                        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">element</span>&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">result-document</span>&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">if</span>&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e136">if</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">$list_place=true()</span>"&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e138">result-document</a></span> <span class="xmlverb-attr-name">method</span>="<span class="xmlverb-attr-content">html</span>" <span class="xmlverb-attr-name">encoding</span>="<span class="xmlverb-attr-content">UTF-8</span>" <span class="xmlverb-attr-name">media-type</span>="<span class="xmlverb-attr-content">text/plain</span>" <span class="xmlverb-attr-name">byte-order-mark</span>="<span class="xmlverb-attr-content">yes</span>" <span class="xmlverb-attr-name">href</span>="<span class="xmlverb-attr-content">{$filePrefix}/data/output_data/liste/listPlace.html</span>" <span class="xmlverb-attr-name">indent</span>="<span class="xmlverb-attr-content">yes</span>"&gt;<span class="xmlverb-text"><br></br>
                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e140">element</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">div</span>"&gt;<span class="xmlverb-text"><br></br>
                                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e142">attribute</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">id</span>"&gt;<span class="xmlverb-text">listPlace</span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">attribute</span>&gt;<span class="xmlverb-text"><br></br>
                                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e145">attribute</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">class</span>"&gt;<span class="xmlverb-text">can-change-font-size</span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">attribute</span>&gt;<span class="xmlverb-text"><br></br>
                                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e148">call-template</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">listPlace</span>" /&gt;<span class="xmlverb-text"><br></br>
                                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e150">apply-templates</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$step0</span>" <span class="xmlverb-attr-name">mode</span>="<span class="xmlverb-attr-content">listPlaceOccurences</span>" /&gt;<span class="xmlverb-text"><br></br>
                                        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">element</span>&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">result-document</span>&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">if</span>&gt;<span class="xmlverb-text"><br></br>
                        <br></br>
                        </span>&lt;!--<span class="xmlverb-comment"> SEARCH </span>--&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e158">if</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">$search=true()</span>"&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e160">apply-templates</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$step0</span>" <span class="xmlverb-attr-name">mode</span>="<span class="xmlverb-attr-content">file4search</span>" /&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">if</span>&gt;<span class="xmlverb-text"><br></br>
                        <br></br>
                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">if</span>&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;!--<span class="xmlverb-comment"> EN: The index and structure generation are the same for both the parallel and the embedded  </span>--&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;!--<span class="xmlverb-comment"> IT: La generazione dell'index e della struttura sono uguali sia per la parallel sia per l'embedded </span>--&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e169">call-template</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">index</span>" /&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e171">apply-templates</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">.</span>" <span class="xmlverb-attr-name">mode</span>="<span class="xmlverb-attr-content">structure_generation</span>" /&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">template</span>&gt;<span class="xmlverb-text"><br></br>
        <br></br>
        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e174">template</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">index</span>"&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;!--<span class="xmlverb-comment"> EN: Index generation. The index_build template can be found in html_build/evt_builder-callhtml.xsl </span>--&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;!--<span class="xmlverb-comment"> IT: Generazione della index. Il template index_build si trova in html_build/evt_builder-callhtml.xsl </span>--&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e180">result-document</a></span> <span class="xmlverb-attr-name">method</span>="<span class="xmlverb-attr-content">html</span>" <span class="xmlverb-attr-name">encoding</span>="<span class="xmlverb-attr-content">UTF-8</span>" <span class="xmlverb-attr-name">media-type</span>="<span class="xmlverb-attr-content">text/plain</span>" <span class="xmlverb-attr-name">href</span>="<span class="xmlverb-attr-content">{$filePrefix}/index.html</span>" <span class="xmlverb-attr-name">indent</span>="<span class="xmlverb-attr-content">yes</span>"&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e182">call-template</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">index_build</span>" /&gt;<span class="xmlverb-text">                        <br></br>
                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">result-document</span>&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">template</span>&gt;<span class="xmlverb-text"><br></br>
<br></br>
        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e186">template</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">page</span>"&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;!--<span class="xmlverb-comment"> CDP:embedded </span>--&gt;<span class="xmlverb-text">        <br></br>
                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e190">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">pb_n</span>"&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e192">choose</a></span>&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e194">when</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">@xml:id</span>"&gt;<span class="xmlverb-text"><br></br>
                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e196">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">@xml:id</span>" /&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">when</span>&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e199">when</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">@n</span>"&gt;<span class="xmlverb-text"><br></br>
                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e201">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">@n</span>" /&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">when</span>&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e204">when</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">@facs</span>"&gt;<span class="xmlverb-text"><br></br>
                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e206">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">@facs</span>" /&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">when</span>&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e209">otherwise</a></span>&gt;<span class="xmlverb-text"><br></br>
                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e211">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">position()</span>" /&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">otherwise</span>&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">choose</span>&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">variable</span>&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;!--<span class="xmlverb-comment"> EN: For every single page, the system generates the corresponding edition. Data_structure template is in html_builder/evt_builder-callhtml.xsl </span>--&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;!--<span class="xmlverb-comment"> IT: Per ogni pagina, genera le corrispettive edizioni. Il template data_structure si trova in html_build/evt_builder-callhtml.xsl </span>--&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e220">for-each</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$edition_array</span>"&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e222">if</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">.!=''</span>"&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e224">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">edition_current</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">lower-case(.)</span>" /&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e226">result-document</a></span> <span class="xmlverb-attr-name">method</span>="<span class="xmlverb-attr-content">html</span>" <span class="xmlverb-attr-name">encoding</span>="<span class="xmlverb-attr-content">UTF-8</span>" <span class="xmlverb-attr-name">media-type</span>="<span class="xmlverb-attr-content">text/plain</span>" <span class="xmlverb-attr-name">byte-order-mark</span>="<span class="xmlverb-attr-content">yes</span>" <span class="xmlverb-attr-name">href</span>="<span class="xmlverb-attr-content">{$filePrefix}/data/output_data/{$edition_current}/page_{$pb_n}_{$edition_current}.html</span>" <span class="xmlverb-attr-name">indent</span>="<span class="xmlverb-attr-content">yes</span>"&gt;<span class="xmlverb-text"><br></br>
                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e228">call-template</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">data_structure</span>"&gt;<span class="xmlverb-text"><br></br>
                                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e230">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">output</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$edition_current</span>" /&gt;<span class="xmlverb-text"><br></br>
                                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e232">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">pb_n</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$pb_n</span>" /&gt;<span class="xmlverb-text"><br></br>
                                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e234">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">edition_pos</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">position()</span>" /&gt;<span class="xmlverb-text"><br></br>
                                        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">call-template</span>&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">result-document</span>&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">if</span>&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">for-each</span>&gt;<span class="xmlverb-text"><br></br>
    </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">template</span>&gt;<span class="xmlverb-text"><br></br>
        <br></br>
        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e241">template</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">edition_level</span>"&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e243">param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">pb_n</span>" /&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e245">param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">edition_pos</span>" /&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e247">if</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">$edition_pos=1</span>"&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e249">choose</a></span>&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;!--<span class="xmlverb-comment"> CDP:embedded </span>--&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;!--<span class="xmlverb-comment"> Se il file e' codificato in Embedded Transcription e almeno un elemento &lt;zone&gt; presenta le coordinate spaziali <br></br>
                                        viene attivata la trasformazione per il collegamento testo immagine </span>--&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e255">when</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">($root//tei:sourceDoc)and(current-group()/tei:zone[@lrx][@lry][@ulx][@uly])</span>"&gt;<span class="xmlverb-text"><br></br>
                                        </span>&lt;!--<span class="xmlverb-comment">&lt;xsl:copy-of select="current-group()"/&gt; </span>--&gt;&lt;!--<span class="xmlverb-comment"> &lt;-use this to find split errors </span>--&gt;<span class="xmlverb-text"><br></br>
                                        </span>&lt;!--<span class="xmlverb-comment">&lt;xsl:variable name="text"&gt;&lt;xsl:apply-templates select="current-group()" mode="dipl"/&gt;&lt;/xsl:variable&gt;</span>--&gt;<span class="xmlverb-text"><br></br>
                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e262">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">text</span>"&gt;&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e263">apply-templates</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">current-group()</span>" <span class="xmlverb-attr-name">mode</span>="<span class="xmlverb-attr-content">ITLembedded</span>"&gt;<span class="xmlverb-text"><br></br>
                                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e265">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">edition_level</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$ed_name1</span>" /&gt;<span class="xmlverb-text"><br></br>
                                        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">apply-templates</span>&gt;&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">variable</span>&gt;<span class="xmlverb-text"><br></br>
                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e268">apply-templates</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$text</span>" <span class="xmlverb-attr-name">mode</span>="<span class="xmlverb-attr-content">dipl</span>" /&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">when</span>&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;!--<span class="xmlverb-comment"> IT: Se c'è il surface viene creato un albero temporaneo che corrisponde al gruppo corrente trasformato in base al livello di edizione;<br></br>
                                                                                 a questo viene applicato il template per il collegamento testo-immagine</span>--&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e273">when</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">$root//tei:facsimile/tei:surface[translate(@corresp, '#', '')=$pb_n]//tei:zone[@rendition='Line']</span>"&gt;<span class="xmlverb-text"><br></br>
                                        </span>&lt;!--<span class="xmlverb-comment">&lt;xsl:copy-of select="current-group()"/&gt;</span>--&gt;<span class="xmlverb-text"> </span>&lt;!--<span class="xmlverb-comment"> &lt;-use this to find split errors </span>--&gt;<span class="xmlverb-text"><br></br>
                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e279">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">text</span>"&gt;&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e280">apply-templates</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">current-group()</span>" <span class="xmlverb-attr-name">mode</span>="<span class="xmlverb-attr-content">dipl</span>" /&gt;&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">variable</span>&gt;<span class="xmlverb-text"><br></br>
                                        </span>&lt;!--<span class="xmlverb-comment"> IT: aggiungi elementi div per linee di testo </span>--&gt;<span class="xmlverb-text"><br></br>
                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e284">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">text2</span>"&gt;<span class="xmlverb-text"><br></br>
                                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e286">call-template</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">divLine</span>"&gt;<span class="xmlverb-text"><br></br>
                                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e288">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">text</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$text</span>" /&gt;<span class="xmlverb-text"><br></br>
                                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e290">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">ed_name</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$ed_name1</span>" /&gt;<span class="xmlverb-text"><br></br>
                                                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">call-template</span>&gt;<span class="xmlverb-text"><br></br>
                                        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">variable</span>&gt;<span class="xmlverb-text"><br></br>
                                        </span>&lt;!--<span class="xmlverb-comment"> IT: trasforma el per ITL e HS</span>--&gt;<span class="xmlverb-text"><br></br>
                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e297">apply-templates</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$text2</span>" <span class="xmlverb-attr-name">mode</span>="<span class="xmlverb-attr-content">ITL</span>" /&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">when</span>&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;!--<span class="xmlverb-comment"> EN: If the surface element is not present only the diplomatic edition templates are applied </span>--&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;!--<span class="xmlverb-comment"> IT: Se non c'è il surface devo applicare direttamente i templates per l'edizione diplomatica </span>--&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e305">otherwise</a></span>&gt;<span class="xmlverb-text"><br></br>
                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e307">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">text</span>"&gt;&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e308">apply-templates</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">current-group()</span>" <span class="xmlverb-attr-name">mode</span>="<span class="xmlverb-attr-content">dipl</span>" /&gt;&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">variable</span>&gt;<span class="xmlverb-text"><br></br>
                                        </span>&lt;!--<span class="xmlverb-comment"> IT: aggiungi elementi div per linee di testo </span>--&gt;<span class="xmlverb-text"><br></br>
                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e312">call-template</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">divLine</span>"&gt;<span class="xmlverb-text"><br></br>
                                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e314">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">text</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$text</span>" /&gt;<span class="xmlverb-text"><br></br>
                                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e316">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">ed_name</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$ed_name1</span>" /&gt;<span class="xmlverb-text"><br></br>
                                        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">call-template</span>&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">otherwise</span>&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">choose</span>&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">if</span>&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e322">if</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">$edition_pos=2</span>"&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e324">choose</a></span>&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;!--<span class="xmlverb-comment"> CDP:embedded </span>--&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;!--<span class="xmlverb-comment"> EN: If the text is encoded in Embedded Transcription and there is at least one &lt;one&gt; element with spatial coordinates<br></br>
                                                 the transformation for the image-text link will be activated </span>--&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;!--<span class="xmlverb-comment"> IT: Se il file e' codificato in Embedded Transcription e almeno un elemento &lt;zone&gt; presenta le coordinate spaziali <br></br>
                                                 viene attivata la trasformazione per il collegamento testo immagine </span>--&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e332">when</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">($root//tei:sourceDoc)and(current-group()/tei:zone[@lrx][@lry][@ulx][@uly])</span>"&gt;<span class="xmlverb-text"><br></br>
                                        </span>&lt;!--<span class="xmlverb-comment">&lt;xsl:copy-of select="current-group()"/&gt;</span>--&gt;<span class="xmlverb-text"> </span>&lt;!--<span class="xmlverb-comment"> &lt;-use this to find split errors </span>--&gt;<span class="xmlverb-text"><br></br>
                                        </span>&lt;!--<span class="xmlverb-comment">&lt;xsl:variable name="text"&gt;&lt;xsl:apply-templates select="current-group()" mode="interp"/&gt;&lt;/xsl:variable&gt;</span>--&gt;<span class="xmlverb-text"><br></br>
                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e340">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">text</span>"&gt;&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e341">apply-templates</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">current-group()</span>" <span class="xmlverb-attr-name">mode</span>="<span class="xmlverb-attr-content">ITLembedded</span>"&gt;<span class="xmlverb-text"><br></br>
                                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e343">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">edition_level</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$ed_name2</span>" /&gt;<span class="xmlverb-text"><br></br>
                                        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">apply-templates</span>&gt;&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">variable</span>&gt;<span class="xmlverb-text"><br></br>
                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e346">apply-templates</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$text</span>" <span class="xmlverb-attr-name">mode</span>="<span class="xmlverb-attr-content">interp</span>" /&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">when</span>&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;!--<span class="xmlverb-comment"> IT: Se c'è il surface viene creato un albero temporaneo che corrisponde al gruppo corrente trasformato in base al livello di edizione;<br></br>
                                                                                 a questo viene applicato il template per il collegamento testo-immagine</span>--&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e352">when</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">$root//tei:facsimile/tei:surface[translate(@corresp, '#', '')=$pb_n]//tei:zone[@rendition='Line']</span>"&gt;<span class="xmlverb-text"><br></br>
                                        </span>&lt;!--<span class="xmlverb-comment">&lt;xsl:copy-of select="current-group()"/&gt;</span>--&gt;<span class="xmlverb-text"> </span>&lt;!--<span class="xmlverb-comment"> &lt;-use this to find split errors </span>--&gt;<span class="xmlverb-text"><br></br>
                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e358">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">text</span>"&gt;&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e359">apply-templates</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">current-group()</span>" <span class="xmlverb-attr-name">mode</span>="<span class="xmlverb-attr-content">interp</span>" /&gt;&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">variable</span>&gt;<span class="xmlverb-text"><br></br>
                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e361">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">text2</span>"&gt;<span class="xmlverb-text"><br></br>
                                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e363">call-template</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">divLine</span>"&gt;<span class="xmlverb-text"><br></br>
                                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e365">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">text</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$text</span>" /&gt;<span class="xmlverb-text"><br></br>
                                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e367">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">ed_name</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$ed_name2</span>" /&gt;<span class="xmlverb-text"><br></br>
                                                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">call-template</span>&gt;<span class="xmlverb-text"><br></br>
                                        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">variable</span>&gt;<span class="xmlverb-text"><br></br>
                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e371">apply-templates</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$text2</span>" <span class="xmlverb-attr-name">mode</span>="<span class="xmlverb-attr-content">ITL</span>" /&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">when</span>&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;!--<span class="xmlverb-comment"> EN: If the surface element is not present only the diplomatic edition templates are applied </span>--&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;!--<span class="xmlverb-comment"> IT: Se non c'è il surface devo applicare direttamente i templates per l'edizione diplomatica</span>--&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e378">otherwise</a></span>&gt;<span class="xmlverb-text"><br></br>
                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e380">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">text</span>"&gt;&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e381">apply-templates</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">current-group()</span>" <span class="xmlverb-attr-name">mode</span>="<span class="xmlverb-attr-content">interp</span>" /&gt;&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">variable</span>&gt;<span class="xmlverb-text"><br></br>
                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e383">call-template</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">divLine</span>"&gt;<span class="xmlverb-text"><br></br>
                                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e385">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">text</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$text</span>" /&gt;<span class="xmlverb-text"><br></br>
                                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e387">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">ed_name</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$ed_name2</span>" /&gt;<span class="xmlverb-text"><br></br>
                                        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">call-template</span>&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">otherwise</span>&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">choose</span>&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">if</span>&gt;<span class="xmlverb-text"><br></br>
                <br></br>
        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">template</span>&gt;<span class="xmlverb-text"><br></br>
        <br></br>
        </span>&lt;!--<span class="xmlverb-comment"> HEADER INFO </span>--&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e396">template</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">headerInfo</span>"&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e398">result-document</a></span> <span class="xmlverb-attr-name">method</span>="<span class="xmlverb-attr-content">html</span>" <span class="xmlverb-attr-name">encoding</span>="<span class="xmlverb-attr-content">UTF-8</span>" <span class="xmlverb-attr-name">media-type</span>="<span class="xmlverb-attr-content">text/plain</span>" <span class="xmlverb-attr-name">byte-order-mark</span>="<span class="xmlverb-attr-content">yes</span>" <span class="xmlverb-attr-name">href</span>="<span class="xmlverb-attr-content">{$filePrefix}/data/output_data/prefatory_matter/header_info.html</span>" <span class="xmlverb-attr-name">indent</span>="<span class="xmlverb-attr-content">yes</span>"&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e400">call-template</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">headerInfo_generation</span>" /&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">result-document</span>&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">template</span>&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;!--<span class="xmlverb-comment"> MS DESCRIPTION </span>--&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e407">template</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">msDesc</span>"&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e409">result-document</a></span> <span class="xmlverb-attr-name">method</span>="<span class="xmlverb-attr-content">html</span>" <span class="xmlverb-attr-name">encoding</span>="<span class="xmlverb-attr-content">UTF-8</span>" <span class="xmlverb-attr-name">media-type</span>="<span class="xmlverb-attr-content">text/plain</span>" <span class="xmlverb-attr-name">byte-order-mark</span>="<span class="xmlverb-attr-content">yes</span>" <span class="xmlverb-attr-name">href</span>="<span class="xmlverb-attr-content">{$filePrefix}/data/output_data/prefatory_matter/ms_desc.html</span>" <span class="xmlverb-attr-name">indent</span>="<span class="xmlverb-attr-content">yes</span>"&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e411">call-template</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">msDesc_generation</span>" /&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">result-document</span>&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">template</span>&gt;<span class="xmlverb-text"><br></br>
        <br></br>
        </span>&lt;!--<span class="xmlverb-comment"> FRONT </span>--&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e417">template</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">front</span>"&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e419">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">front</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">current()/tei:front</span>" /&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e421">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">doc_id</span>"&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e423">choose</a></span>&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e425">when</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">current()/@xml:id</span>"&gt;<span class="xmlverb-text"><br></br>
                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e427">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">current()/@xml:id</span>" /&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">when</span>&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e430">when</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">current()/tei:body/tei:div[@subtype='edition_text']/@xml:id</span>"&gt;<span class="xmlverb-text"><br></br>
                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e432">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">current()/tei:body/tei:div[@subtype='edition_text']/@xml:id</span>" /&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">when</span>&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e435">otherwise</a></span>&gt;<span class="xmlverb-text"><br></br>
                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e437">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">''</span>" /&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">otherwise</span>&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">choose</span>&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">variable</span>&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e442">if</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">not($doc_id='')</span>"&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e444">result-document</a></span> <span class="xmlverb-attr-name">method</span>="<span class="xmlverb-attr-content">html</span>" <span class="xmlverb-attr-name">encoding</span>="<span class="xmlverb-attr-content">UTF-8</span>" <span class="xmlverb-attr-name">media-type</span>="<span class="xmlverb-attr-content">text/plain</span>" <span class="xmlverb-attr-name">byte-order-mark</span>="<span class="xmlverb-attr-content">yes</span>" <span class="xmlverb-attr-name">href</span>="<span class="xmlverb-attr-content">{$filePrefix}/data/output_data/prefatory_matter/front/front_doc_{$doc_id}.html</span>" <span class="xmlverb-attr-name">indent</span>="<span class="xmlverb-attr-content">yes</span>"&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e446">call-template</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">front_generation</span>"&gt;<span class="xmlverb-text"><br></br>
                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e448">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">front</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$front</span>" /&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">call-template</span>&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">result-document</span>&gt;<span class="xmlverb-text">        <br></br>
                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">if</span>&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">template</span>&gt;<span class="xmlverb-text"><br></br>
        <br></br>
        </span>&lt;!--<span class="xmlverb-comment"> REGESTO </span>--&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e456">template</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">regesto</span>"&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e458">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">doc_id</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">@xml:id</span>" /&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e460">result-document</a></span> <span class="xmlverb-attr-name">method</span>="<span class="xmlverb-attr-content">html</span>" <span class="xmlverb-attr-name">encoding</span>="<span class="xmlverb-attr-content">UTF-8</span>" <span class="xmlverb-attr-name">media-type</span>="<span class="xmlverb-attr-content">text/plain</span>" <span class="xmlverb-attr-name">byte-order-mark</span>="<span class="xmlverb-attr-content">yes</span>" <span class="xmlverb-attr-name">href</span>="<span class="xmlverb-attr-content">{$filePrefix}/data/output_data/prefatory_matter/regesto/regesto_doc_{$doc_id}.html</span>" <span class="xmlverb-attr-name">indent</span>="<span class="xmlverb-attr-content">yes</span>"&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e462">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">front</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">current()/tei:front</span>" /&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e464">call-template</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">doc_regesto</span>"&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e466">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">doc_id</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$doc_id</span>" /&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e468">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">front</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$front</span>" /&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">call-template</span>&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">result-document</span>&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">template</span>&gt;<span class="xmlverb-text"><br></br>
        <br></br>
        </span>&lt;!--<span class="xmlverb-comment"> LIST PERSON </span>--&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e476">template</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">listPerson</span>"&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e478">element</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">ul</span>"&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e480">attribute</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">id</span>"&gt;<span class="xmlverb-text">ul_listPerson</span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">attribute</span>&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e483">attribute</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">class</span>"&gt;<span class="xmlverb-text">ul_list</span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">attribute</span>&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e486">for-each</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$root//tei:listPerson/person</span>"&gt;<span class="xmlverb-text"><br></br>
                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e488">element</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">li</span>"&gt;<span class="xmlverb-text"><br></br>
                                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e490">attribute</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">id</span>"&gt;&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e491">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">@xml:id</span>" /&gt;&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">attribute</span>&gt;<span class="xmlverb-text"><br></br>
                                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e493">attribute</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">class</span>"&gt;<span class="xmlverb-text">list_element</span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">attribute</span>&gt;<span class="xmlverb-text"><br></br>
                                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e496">attribute</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">data-order-list</span>"&gt;&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e497">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">substring(tei:persName/tei:forename, 1, 1)</span>" /&gt;<span class="xmlverb-text"><br></br>
                                                        </span>&lt;!--<span class="xmlverb-comment">&lt;xsl:value-of select="substring(@xml:id, 1, 1)"/&gt;</span>--&gt;<span class="xmlverb-text"><br></br>
                                                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">attribute</span>&gt;<span class="xmlverb-text"><br></br>
                                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e502">call-template</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">person</span>" /&gt;<span class="xmlverb-text"><br></br>
                                        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">element</span>&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">for-each</span>&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">element</span>&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">template</span>&gt;<span class="xmlverb-text"><br></br>
        <br></br>
        </span>&lt;!--<span class="xmlverb-comment"> LIST PLACE </span>--&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e510">template</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">listPlace</span>"&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e512">element</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">ul</span>"&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e514">attribute</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">id</span>"&gt;<span class="xmlverb-text">ul_listPlace</span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">attribute</span>&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e517">attribute</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">class</span>"&gt;<span class="xmlverb-text">ul_list</span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">attribute</span>&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e520">for-each</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$root//tei:listPlace/place</span>"&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e522">element</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">li</span>"&gt;<span class="xmlverb-text"><br></br>
                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e524">attribute</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">id</span>"&gt;&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e525">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">@xml:id</span>" /&gt;&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">attribute</span>&gt;<span class="xmlverb-text"><br></br>
                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e527">attribute</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">class</span>"&gt;<span class="xmlverb-text">list_element</span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">attribute</span>&gt;<span class="xmlverb-text"><br></br>
                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e530">attribute</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">data-order-list</span>"&gt;&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e531">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">substring(tei:settlement, 1, 1)</span>" /&gt;<span class="xmlverb-text"><br></br>
                                                </span>&lt;!--<span class="xmlverb-comment">&lt;xsl:value-of select="substring(@xml:id, 1, 1)"/&gt;</span>--&gt;<span class="xmlverb-text"><br></br>
                                        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">attribute</span>&gt;<span class="xmlverb-text"><br></br>
                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e536">call-template</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">place</span>" /&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">element</span>&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">for-each</span>&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">element</span>&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">template</span>&gt;<span class="xmlverb-text"><br></br>
        <br></br>
        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e542">template</a></span> <span class="xmlverb-attr-name">match</span>="<span class="xmlverb-attr-content">text()</span>" <span class="xmlverb-attr-name">mode</span>="<span class="xmlverb-attr-content">deleteSpaces</span>"&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e544">choose</a></span>&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e546">when</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">ancestor::*[@xml:space][1]/@xml:space='preserve'</span>"&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e548">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">.</span>" /&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">when</span>&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e551">otherwise</a></span>&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;!--<span class="xmlverb-comment"> Retain one leading space if node isn't first, has<br></br>
             non-space content, and has leading space.</span>--&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e555">if</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">position()!=1 and matches(.,'^\s') and normalize-space()!=''</span>"&gt;<span class="xmlverb-text"><br></br>
                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e557">text</a></span>&gt;<span class="xmlverb-text"> </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">text</span>&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">if</span>&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e561">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">normalize-space(.)</span>" /&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e563">choose</a></span>&gt;<span class="xmlverb-text"><br></br>
                                        </span>&lt;!--<span class="xmlverb-comment"> node is an only child, and has content but it's all space </span>--&gt;<span class="xmlverb-text"><br></br>
                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e567">when</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">last()=1 and string-length()!=0 and normalize-space()=''</span>"&gt;<span class="xmlverb-text"><br></br>
                                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e569">text</a></span>&gt;<span class="xmlverb-text"> </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">text</span>&gt;<span class="xmlverb-text"><br></br>
                                        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">when</span>&gt;<span class="xmlverb-text"><br></br>
                                        </span>&lt;!--<span class="xmlverb-comment"> node isn't last, isn't first, and has trailing space </span>--&gt;<span class="xmlverb-text"><br></br>
                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e575">when</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">position()!=1 and position()!=last() and matches(.,'\s$')</span>"&gt;<span class="xmlverb-text"><br></br>
                                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e577">text</a></span>&gt;<span class="xmlverb-text"> </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">text</span>&gt;<span class="xmlverb-text"><br></br>
                                        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">when</span>&gt;<span class="xmlverb-text"><br></br>
                                        </span>&lt;!--<span class="xmlverb-comment"> node isn't last, is first, has trailing space, and has non-space content   </span>--&gt;<span class="xmlverb-text"><br></br>
                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e584">when</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">position()=1 and matches(.,'\s$') and normalize-space()!=''</span>"&gt;<span class="xmlverb-text"><br></br>
                                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e586">text</a></span>&gt;<span class="xmlverb-text"> </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">text</span>&gt;<span class="xmlverb-text"><br></br>
                                        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">when</span>&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">choose</span>&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">otherwise</span>&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">choose</span>&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">template</span>&gt;<span class="xmlverb-text"><br></br>
        <br></br>
        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e594">template</a></span> <span class="xmlverb-attr-name">match</span>="<span class="xmlverb-attr-content">@*|node()</span>" <span class="xmlverb-attr-name">mode</span>="<span class="xmlverb-attr-content">delete_el1</span>"&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e596">copy</a></span>&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e598">apply-templates</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">@*|node()</span>" <span class="xmlverb-attr-name">mode</span>="<span class="xmlverb-attr-content">#current</span>" /&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">copy</span>&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">template</span>&gt;<span class="xmlverb-text"><br></br>
        <br></br>
        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e602">template</a></span> <span class="xmlverb-attr-name">match</span>="<span class="xmlverb-attr-content">node()[name()='span'][@class='dipl-choice_popup']/node()[name()='span'][@class='dipl-reg']</span>" <span class="xmlverb-attr-name">mode</span>="<span class="xmlverb-attr-content">delete_el1</span>"&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;!--<span class="xmlverb-comment"> DO NOTHING </span>--&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">template</span>&gt;<span class="xmlverb-text"><br></br>
        <br></br>
        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e608">template</a></span> <span class="xmlverb-attr-name">match</span>="<span class="xmlverb-attr-content">node()[name()='div'][@class='dipl-zone']</span>" <span class="xmlverb-attr-name">mode</span>="<span class="xmlverb-attr-content">delete_el1</span>"&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;!--<span class="xmlverb-comment"> DO NOTHING </span>--&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">template</span>&gt;<span class="xmlverb-text"><br></br>
        <br></br>
        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e613">template</a></span> <span class="xmlverb-attr-name">match</span>="<span class="xmlverb-attr-content">node()[name()='div'][@class='dipl-attachment']</span>" <span class="xmlverb-attr-name">mode</span>="<span class="xmlverb-attr-content">delete_el1</span>"&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;!--<span class="xmlverb-comment"> DO NOTHING </span>--&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">template</span>&gt;<span class="xmlverb-text"><br></br>
        <br></br>
        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e618">template</a></span> <span class="xmlverb-attr-name">match</span>="<span class="xmlverb-attr-content">@*|node()</span>" <span class="xmlverb-attr-name">mode</span>="<span class="xmlverb-attr-content">delete_el2</span>"&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e620">copy</a></span>&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e622">apply-templates</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">@*|node()</span>" <span class="xmlverb-attr-name">mode</span>="<span class="xmlverb-attr-content">#current</span>" /&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">copy</span>&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">template</span>&gt;<span class="xmlverb-text"><br></br>
        <br></br>
        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e626">template</a></span> <span class="xmlverb-attr-name">match</span>="<span class="xmlverb-attr-content">node()[name()='span'][@class='interp-choice_popup']/node()[name()='span'][@class='interp-orig']|node()[name()='span'][@class='interp-corr']</span>" <span class="xmlverb-attr-name">mode</span>="<span class="xmlverb-attr-content">delete_el2</span>"&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;!--<span class="xmlverb-comment"> DO NOTHING </span>--&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">template</span>&gt;<span class="xmlverb-text"><br></br>
        <br></br>
        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e631">template</a></span> <span class="xmlverb-attr-name">match</span>="<span class="xmlverb-attr-content">node()[name()='div'][@class='interp-zone']</span>" <span class="xmlverb-attr-name">mode</span>="<span class="xmlverb-attr-content">delete_el2</span>"&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;!--<span class="xmlverb-comment"> DO NOTHING </span>--&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">template</span>&gt;<span class="xmlverb-text"><br></br>
        <br></br>
        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e636">template</a></span> <span class="xmlverb-attr-name">match</span>="<span class="xmlverb-attr-content">node()[name()='div'][@class='interp-attachment']</span>" <span class="xmlverb-attr-name">mode</span>="<span class="xmlverb-attr-content">delete_el2</span>"&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;!--<span class="xmlverb-comment"> DO NOTHING </span>--&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">template</span>&gt;<span class="xmlverb-text"><br></br>
        <br></br>
        <br></br>
        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e642">template</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">search_file</span>"&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e644">if</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">$edition_array[1]!=''</span>"&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e646">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">edition_current</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">lower-case($edition_array[1])</span>" /&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e648">result-document</a></span> <span class="xmlverb-attr-name">method</span>="<span class="xmlverb-attr-content">text</span>" <span class="xmlverb-attr-name">href</span>="<span class="xmlverb-attr-content">{$filePrefix}/data/output_data/{$edition_current}/{$edition_current}.json</span>" <span class="xmlverb-attr-name">indent</span>="<span class="xmlverb-attr-content">no</span>"&gt;<span class="xmlverb-text"><br></br>
                                {"pages": [<br></br>
                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e650">for-each-group</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">//node()[name()=$ed_content]/descendant-or-self::node()[name()=$start_split]/node()</span>" <span class="xmlverb-attr-name">group-starting-with</span>="<span class="xmlverb-attr-content">//tei:pb</span>"&gt;<span class="xmlverb-text"><br></br>
                                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e652">choose</a></span>&gt;<span class="xmlverb-text"><br></br>
                                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e654">when</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">current-group()/(descendant-or-self::lb)</span>"&gt;<span class="xmlverb-text"><br></br>
                                                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e656">for-each-group</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">current-group()[not(self::pb)]</span>" <span class="xmlverb-attr-name">group-starting-with</span>="<span class="xmlverb-attr-content">tei:lb</span>"&gt;<span class="xmlverb-text"><br></br>
                                                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e658">if</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">current-group()[not((string-length(normalize-space()))= 0)]</span>"&gt;<span class="xmlverb-text"><br></br>
                                                                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e660">choose</a></span>&gt;<span class="xmlverb-text"><br></br>
                                                                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e662">when</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">following::lb</span>"&gt;<span class="xmlverb-text"><br></br>
                                                                                                { <br></br>
                                                                                                        "line" : "</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e664">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">if(self::tei:lb/@n) then(concat(self::tei:lb/@n, '|line ',self::tei:lb/@n)) else('no line info |no line info')</span>" /&gt;<span class="xmlverb-text">",<br></br>
                                                                                                        "text" : "</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e666">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">var</span>"&gt;&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e667">apply-templates</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">current-group()[not(self::tei:lb)]</span>" <span class="xmlverb-attr-name">mode</span>="<span class="xmlverb-attr-content">dipl</span>" /&gt;&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">variable</span>&gt;<span class="xmlverb-text"><br></br>
                                                                                                                          </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e669">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">var1</span>"&gt;&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e670">apply-templates</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$var</span>" <span class="xmlverb-attr-name">mode</span>="<span class="xmlverb-attr-content">delete_el1</span>" /&gt;&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">variable</span>&gt;<span class="xmlverb-text"><br></br>
                                                                                                                          </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e672">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">var2</span>"&gt;&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e673">apply-templates</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$var1//text()[not(ancestor::span)]</span>" <span class="xmlverb-attr-name">mode</span>="<span class="xmlverb-attr-content">deleteSpaces</span>" /&gt;&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">variable</span>&gt;<span class="xmlverb-text"><br></br>
                                                                                                                          </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e675">copy-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">replace($var2, '(\\|/)', '$1$1')</span>" /&gt;<span class="xmlverb-text">",<br></br>
                                                                                                        "tags" : "</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e678">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">parent::div[@subtype='edition_text']/@xml:id</span>" /&gt;<span class="xmlverb-text">|</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e680">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">parent::div[@subtype='edition_text']/@n</span>" /&gt;<span class="xmlverb-text">",<br></br>
                                                                                                        "loc" : "</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e682">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">if(preceding::pb[1]/@xml:id) then(preceding::pb[1]/@xml:id) else('no_page_info')</span>" /&gt;<span class="xmlverb-text">|</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e684">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">if(preceding::pb[1]/@n) then(preceding::pb[1]/@n) else('no_page_info')</span>" /&gt;<span class="xmlverb-text">"<br></br>
                                                                                                },<br></br>
                                                                                        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">when</span>&gt;<span class="xmlverb-text"><br></br>
                                                                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e687">otherwise</a></span>&gt;<span class="xmlverb-text"><br></br>
                                                                                                { <br></br>
                                                                                                        "line" : "</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e689">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">if(self::tei:lb/@n) then(concat(self::tei:lb/@n, '|line ',self::tei:lb/@n)) else('no line info |no line info')</span>" /&gt;<span class="xmlverb-text">",<br></br>
                                                                                                        "text" : "</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e691">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">var</span>"&gt;&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e692">apply-templates</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">current-group()[not(self::tei:lb)]</span>" <span class="xmlverb-attr-name">mode</span>="<span class="xmlverb-attr-content">dipl</span>" /&gt;&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">variable</span>&gt;<span class="xmlverb-text"><br></br>
                                                                                                                          </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e694">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">var1</span>"&gt;&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e695">apply-templates</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$var</span>" <span class="xmlverb-attr-name">mode</span>="<span class="xmlverb-attr-content">delete_el1</span>" /&gt;&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">variable</span>&gt;<span class="xmlverb-text"><br></br>
                                                                                                                          </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e697">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">var2</span>"&gt;&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e698">apply-templates</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$var1//text()[not(ancestor::span)]</span>" <span class="xmlverb-attr-name">mode</span>="<span class="xmlverb-attr-content">deleteSpaces</span>" /&gt;&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">variable</span>&gt;<span class="xmlverb-text"><br></br>
                                                                                                                          </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e700">copy-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">replace($var2, '(\\|/)', '$1$1')</span>" /&gt;<span class="xmlverb-text">",<br></br>
                                                                                                        "tags" : "</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e703">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">parent::div[@subtype='edition_text']/@xml:id</span>" /&gt;<span class="xmlverb-text">|</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e705">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">parent::div[@subtype='edition_text']/@n</span>" /&gt;<span class="xmlverb-text">",<br></br>
                                                                                                        "loc" : "</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e707">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">if(preceding::pb[1]/@xml:id) then(preceding::pb[1]/@xml:id) else('no_page_info')</span>" /&gt;<span class="xmlverb-text">|</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e709">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">if(preceding::pb[1]/@n) then(preceding::pb[1]/@n) else('no_page_info')</span>" /&gt;<span class="xmlverb-text">"<br></br>
                                                                                                }<br></br>
                                                                                        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">otherwise</span>&gt;<span class="xmlverb-text"><br></br>
                                                                                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">choose</span>&gt;<span class="xmlverb-text"><br></br>
                                                                        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">if</span>&gt;<span class="xmlverb-text"><br></br>
                                                                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">for-each-group</span>&gt;<span class="xmlverb-text"><br></br>
                                                        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">when</span>&gt;<span class="xmlverb-text"><br></br>
                                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e716">otherwise</a></span>&gt;<span class="xmlverb-text"><br></br>
                                                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e718">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">var</span>"&gt;&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e719">apply-templates</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">current-group()[not(self::tei:pb)]</span>" <span class="xmlverb-attr-name">mode</span>="<span class="xmlverb-attr-content">dipl</span>" /&gt;&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">variable</span>&gt;<span class="xmlverb-text"><br></br>
                                                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e721">copy-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$var//text()</span>" /&gt;<span class="xmlverb-text"><br></br>
                                                        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">otherwise</span>&gt;<span class="xmlverb-text"><br></br>
                                                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">choose</span>&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">for-each-group</span>&gt;<span class="xmlverb-text"><br></br>
                                ]}<br></br>
                        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">result-document</span>&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">if</span>&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e728">if</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">$edition_array[2]!=''</span>"&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e730">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">edition_current</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">lower-case($edition_array[2])</span>" /&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e732">result-document</a></span> <span class="xmlverb-attr-name">method</span>="<span class="xmlverb-attr-content">text</span>" <span class="xmlverb-attr-name">href</span>="<span class="xmlverb-attr-content">{$filePrefix}/data/output_data/{$edition_current}/{$edition_current}.json</span>" <span class="xmlverb-attr-name">indent</span>="<span class="xmlverb-attr-content">no</span>"&gt;<span class="xmlverb-text"><br></br>
                                {"pages": [<br></br>
                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e734">for-each-group</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">//node()[name()=$ed_content]/descendant-or-self::node()[name()=$start_split]/node()</span>" <span class="xmlverb-attr-name">group-starting-with</span>="<span class="xmlverb-attr-content">//tei:pb</span>"&gt;<span class="xmlverb-text"><br></br>
                                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e736">choose</a></span>&gt;<span class="xmlverb-text"><br></br>
                                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e738">when</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">current-group()/(descendant-or-self::lb)</span>"&gt;<span class="xmlverb-text"><br></br>
                                                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e740">for-each-group</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">current-group()[not(self::pb)]</span>" <span class="xmlverb-attr-name">group-starting-with</span>="<span class="xmlverb-attr-content">tei:lb</span>"&gt;<span class="xmlverb-text"><br></br>
                                                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e742">if</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">current-group()[not((string-length(normalize-space()))= 0)]</span>"&gt;<span class="xmlverb-text"><br></br>
                                                                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e744">choose</a></span>&gt;<span class="xmlverb-text"><br></br>
                                                                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e746">when</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">following::lb</span>"&gt;<span class="xmlverb-text"><br></br>
                                                                                                { <br></br>
                                                                                                        "line" : "</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e748">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">if(self::tei:lb/@n) then(concat(self::tei:lb/@n, '|line ',self::tei:lb/@n)) else('no line info |no line info')</span>" /&gt;<span class="xmlverb-text">",<br></br>
                                                                                                          "text" : "</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e750">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">var</span>"&gt;&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e751">apply-templates</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">current-group()[not(self::tei:lb)]</span>" <span class="xmlverb-attr-name">mode</span>="<span class="xmlverb-attr-content">interp</span>" /&gt;&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">variable</span>&gt;<span class="xmlverb-text"><br></br>
                                                                                                                          </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e753">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">var1</span>"&gt;&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e754">apply-templates</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$var</span>" <span class="xmlverb-attr-name">mode</span>="<span class="xmlverb-attr-content">delete_el2</span>" /&gt;&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">variable</span>&gt;<span class="xmlverb-text"><br></br>
                                                                                                                          </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e756">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">var2</span>"&gt;&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e757">apply-templates</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$var1//text()[not(ancestor::span)]</span>" <span class="xmlverb-attr-name">mode</span>="<span class="xmlverb-attr-content">deleteSpaces</span>" /&gt;&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">variable</span>&gt;<span class="xmlverb-text"><br></br>
                                                                                                                          </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e759">copy-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">replace($var2, '(\\|/)', '$1$1')</span>" /&gt;<span class="xmlverb-text">",<br></br>
                                                                                                        "tags" : "</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e762">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">parent::div[@subtype='edition_text']/@xml:id</span>" /&gt;<span class="xmlverb-text">|</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e764">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">parent::div[@subtype='edition_text']/@n</span>" /&gt;<span class="xmlverb-text">",<br></br>
                                                                                                        "loc" : "</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e766">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">if(preceding::pb[1]/@xml:id) then(preceding::pb[1]/@xml:id) else('no_page_info')</span>" /&gt;<span class="xmlverb-text">|</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e768">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">if(preceding::pb[1]/@n) then(preceding::pb[1]/@n) else('no_page_info')</span>" /&gt;<span class="xmlverb-text">"<br></br>
                                                                                                },<br></br>
                                                                                        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">when</span>&gt;<span class="xmlverb-text"><br></br>
                                                                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e771">otherwise</a></span>&gt;<span class="xmlverb-text"><br></br>
                                                                                                { <br></br>
                                                                                                        "line" : "</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e773">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">if(self::tei:lb/@n) then(concat(self::tei:lb/@n, '|line ',self::tei:lb/@n)) else('no line info |no line info')</span>" /&gt;<span class="xmlverb-text">",<br></br>
                                                                                                        "text" : "</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e775">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">var</span>"&gt;&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e776">apply-templates</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">current-group()[not(self::tei:lb)]</span>" <span class="xmlverb-attr-name">mode</span>="<span class="xmlverb-attr-content">interp</span>" /&gt;&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">variable</span>&gt;<span class="xmlverb-text"><br></br>
                                                                                                                          </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e778">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">var1</span>"&gt;&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e779">apply-templates</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$var</span>" <span class="xmlverb-attr-name">mode</span>="<span class="xmlverb-attr-content">delete_el2</span>" /&gt;&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">variable</span>&gt;<span class="xmlverb-text"><br></br>
                                                                                                                          </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e781">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">var2</span>"&gt;&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e782">apply-templates</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$var1//text()[not(ancestor::span)]</span>" <span class="xmlverb-attr-name">mode</span>="<span class="xmlverb-attr-content">deleteSpaces</span>" /&gt;&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">variable</span>&gt;<span class="xmlverb-text"><br></br>
                                                                                                                          </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e784">copy-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">replace($var2, '(\\|/)', '$1$1')</span>" /&gt;<span class="xmlverb-text">",<br></br>
                                                                                                        "tags" : "</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e787">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">parent::div[@subtype='edition_text']/@xml:id</span>" /&gt;<span class="xmlverb-text">|</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e789">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">parent::div[@subtype='edition_text']/@n</span>" /&gt;<span class="xmlverb-text">",<br></br>
                                                                                                "loc" : "</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e791">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">if(preceding::pb[1]/@xml:id) then(preceding::pb[1]/@xml:id) else('no_page_info')</span>" /&gt;<span class="xmlverb-text">|</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e793">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">if(preceding::pb[1]/@n) then(preceding::pb[1]/@n) else('no_page_info')</span>" /&gt;<span class="xmlverb-text">"<br></br>
                                                                                                }<br></br>
                                                                                        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">otherwise</span>&gt;<span class="xmlverb-text"><br></br>
                                                                                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">choose</span>&gt;<span class="xmlverb-text"><br></br>
                                                                        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">if</span>&gt;<span class="xmlverb-text"><br></br>
                                                                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">for-each-group</span>&gt;<span class="xmlverb-text"><br></br>
                                                        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">when</span>&gt;<span class="xmlverb-text"><br></br>
                                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e800">when</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">current-group()/(descendant-or-self::p)</span>"&gt;<span class="xmlverb-text"><br></br>
                                                                </span>&lt;!--<span class="xmlverb-comment">&lt;xsl:variable name="var"&gt;&lt;xsl:apply-templates select="current-group()[not(self::tei:pb)]" mode="interp"/&gt;&lt;/xsl:variable&gt;<br></br>
                                                                &lt;xsl:copy-of select="$var//text()"&gt;&lt;/xsl:copy-of&gt;</span>--&gt;<span class="xmlverb-text"><br></br>
                                                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e804">for-each-group</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">current-group()/body/descendant::p</span>" <span class="xmlverb-attr-name">group-starting-with</span>="<span class="xmlverb-attr-content">//tei:p</span>"&gt;<span class="xmlverb-text"><br></br>
                                                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e806">choose</a></span>&gt;<span class="xmlverb-text"><br></br>
                                                                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e808">when</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">following::p</span>"&gt;<span class="xmlverb-text"><br></br>
                                                                                        {<br></br>
                                                                                        "line" : "</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e810">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">@xml:id</span>" /&gt;<span class="xmlverb-text">|par </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e812">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">@n</span>" /&gt;<span class="xmlverb-text">",<br></br>
                                                                                        "text" : </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e814">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">var</span>"&gt;&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e815">apply-templates</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">current-group()[not(self::tei:pb)]</span>" <span class="xmlverb-attr-name">mode</span>="<span class="xmlverb-attr-content">dipl</span>" /&gt;&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">variable</span>&gt;<span class="xmlverb-text">"</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e817">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">fn:normalize-space($var)</span>" /&gt;<span class="xmlverb-text">",<br></br>
                                                                                        "tags" : "</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e819">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">ancestor::text[1]/@xml:id</span>" /&gt;<span class="xmlverb-text">|</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e822">call-template</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">generateTextLabel</span>"&gt;&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e823">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">text_id</span>"&gt;&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e824">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">ancestor::text[1]/@xml:id</span>" /&gt;&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">with-param</span>&gt;&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">call-template</span>&gt;<span class="xmlverb-text">",<br></br>
                                                                                        "loc" : "</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e826">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">preceding::pb[1]/@xml:id</span>" /&gt;<span class="xmlverb-text">|</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e828">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">preceding::pb[1]/@n</span>" /&gt;<span class="xmlverb-text">"<br></br>
                                                                                        },<br></br>
                                                                                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">when</span>&gt;<span class="xmlverb-text"><br></br>
                                                                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e831">otherwise</a></span>&gt;<span class="xmlverb-text"><br></br>
                                                                                        {<br></br>
                                                                                        "line" : "</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e833">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">@xml:id</span>" /&gt;<span class="xmlverb-text">|par </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e835">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">@n</span>" /&gt;<span class="xmlverb-text">",<br></br>
                                                                                        "text" : </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e837">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">var</span>"&gt;&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e838">apply-templates</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">current-group()[not(self::tei:pb)]</span>" <span class="xmlverb-attr-name">mode</span>="<span class="xmlverb-attr-content">dipl</span>" /&gt;&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">variable</span>&gt;<span class="xmlverb-text">"</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e840">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">fn:normalize-space($var)</span>" /&gt;<span class="xmlverb-text">",<br></br>
                                                                                        "tags" : "</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e842">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">ancestor::text[1]/@xml:id</span>" /&gt;<span class="xmlverb-text">|</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e845">call-template</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">generateTextLabel</span>"&gt;&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e846">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">text_id</span>"&gt;&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e847">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">ancestor::text[1]/@xml:id</span>" /&gt;&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">with-param</span>&gt;&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">call-template</span>&gt;<span class="xmlverb-text">",<br></br>
                                                                                        "loc" : "</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e849">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">preceding::pb[1]/@xml:id</span>" /&gt;<span class="xmlverb-text">|</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e851">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">preceding::pb[1]/@n</span>" /&gt;<span class="xmlverb-text">"<br></br>
                                                                                        }<br></br>
                                                                                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">otherwise</span>&gt;<span class="xmlverb-text"><br></br>
                                                                        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">choose</span>&gt;<span class="xmlverb-text"><br></br>
                                                                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">for-each-group</span>&gt;<span class="xmlverb-text"><br></br>
                                                        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">when</span>&gt;<span class="xmlverb-text"><br></br>
                                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e857">otherwise</a></span>&gt;<span class="xmlverb-text"><br></br>
                                                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e859">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">var</span>"&gt;&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e860">apply-templates</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">current-group()[not(self::tei:pb)]</span>" <span class="xmlverb-attr-name">mode</span>="<span class="xmlverb-attr-content">interp</span>" /&gt;&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">variable</span>&gt;<span class="xmlverb-text"><br></br>
                                                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e862">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">var1</span>"&gt;&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e863">apply-templates</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$var</span>" <span class="xmlverb-attr-name">mode</span>="<span class="xmlverb-attr-content">delete_el2</span>" /&gt;&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">variable</span>&gt;<span class="xmlverb-text"><br></br>
                                                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e865">copy-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$var1//text()</span>" /&gt;<span class="xmlverb-text"><br></br>
                                                        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">otherwise</span>&gt;<span class="xmlverb-text"><br></br>
                                                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">choose</span>&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">for-each-group</span>&gt;<span class="xmlverb-text"><br></br>
                                ]}<br></br>
                        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">result-document</span>&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">if</span>&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">template</span>&gt;<span class="xmlverb-text"><br></br>
        <br></br>
        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e873">template</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">search_file4embedded</span>"&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e875">if</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">$edition_array[1]!=''</span>"&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e877">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">edition_current</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">lower-case($edition_array[1])</span>" /&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e879">result-document</a></span> <span class="xmlverb-attr-name">method</span>="<span class="xmlverb-attr-content">text</span>" <span class="xmlverb-attr-name">href</span>="<span class="xmlverb-attr-content">{$filePrefix}/data/output_data/{$edition_current}/{$edition_current}.json</span>" <span class="xmlverb-attr-name">indent</span>="<span class="xmlverb-attr-content">no</span>"&gt;<span class="xmlverb-text"><br></br>
                                {"pages": [<br></br>
                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e881">for-each</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$root//tei:surface</span>"&gt;<span class="xmlverb-text"><br></br>
                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e883">if</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">current()/@xml:id</span>"&gt;<span class="xmlverb-text"><br></br>
                                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e885">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">pageId</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">if(@xml:id) then (@xml:id) else (@n)</span>" /&gt;<span class="xmlverb-text"><br></br>
                                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e887">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">pageLabel</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">if(@n) then (@n) else (@xml:id)</span>" /&gt;<span class="xmlverb-text"><br></br>
                                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e889">choose</a></span>&gt;<span class="xmlverb-text"><br></br>
                                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e891">when</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">current()/(descendant-or-self::lb)</span>"&gt;<span class="xmlverb-text"><br></br>
                                                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e893">for-each-group</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">current()[not(self::pb)]</span>" <span class="xmlverb-attr-name">group-starting-with</span>="<span class="xmlverb-attr-content">tei:lb</span>"&gt;<span class="xmlverb-text"><br></br>
                                                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e895">if</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">current-group()[not((string-length(normalize-space()))= 0)]</span>"&gt;<span class="xmlverb-text"><br></br>
                                                                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e897">choose</a></span>&gt;<span class="xmlverb-text"><br></br>
                                                                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e899">when</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">following::lb</span>"&gt;<span class="xmlverb-text"><br></br>
                                                                                                { <br></br>
                                                                                                "line" : "</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e901">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">if(self::tei:lb/@n) then(concat(self::tei:lb/@n, '|line ',self::tei:lb/@n)) else('no line info|no line info')</span>" /&gt;<span class="xmlverb-text">",<br></br>
                                                                                                "text" : "</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e903">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">var</span>"&gt;&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e904">apply-templates</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">current-group()[not(self::tei:lb)]</span>" <span class="xmlverb-attr-name">mode</span>="<span class="xmlverb-attr-content">dipl</span>" /&gt;&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">variable</span>&gt;<span class="xmlverb-text"><br></br>
                                                                                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e906">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">var1</span>"&gt;&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e907">apply-templates</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$var</span>" <span class="xmlverb-attr-name">mode</span>="<span class="xmlverb-attr-content">delete_el1</span>" /&gt;&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">variable</span>&gt;<span class="xmlverb-text"><br></br>
                                                                                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e909">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">var2</span>"&gt;&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e910">apply-templates</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$var1//text()[not(ancestor::span)]</span>" <span class="xmlverb-attr-name">mode</span>="<span class="xmlverb-attr-content">deleteSpaces</span>" /&gt;&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">variable</span>&gt;<span class="xmlverb-text"><br></br>
                                                                                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e912">copy-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">replace($var2, '(\\|/)', '$1$1')</span>" /&gt;<span class="xmlverb-text">",<br></br>
                                                                                                "tags" : "</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e915">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">ancestor::tei:sourceDoc/@xml:id</span>" /&gt;<span class="xmlverb-text">|</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e917">choose</a></span>&gt;&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e918">when</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">ancestor::tei:sourceDoc/@n</span>"&gt;&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e919">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">ancestor::tei:sourceDoc/@n</span>" /&gt;&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">when</span>&gt;&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e920">otherwise</a></span>&gt;&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e921">call-template</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">generateTextLabel</span>"&gt;&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e922">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">text_id</span>"&gt;&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e923">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">ancestor::tei:sourceDoc/@xml:id</span>" /&gt;&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">with-param</span>&gt;&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">call-template</span>&gt;&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">otherwise</span>&gt;&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">choose</span>&gt;<span class="xmlverb-text">",<br></br>
                                                                                                "loc" : "</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e925">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$pageId</span>" /&gt;<span class="xmlverb-text">|</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e927">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$pageLabel</span>" /&gt;<span class="xmlverb-text">"<br></br>
                                                                                                },<br></br>
                                                                                        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">when</span>&gt;<span class="xmlverb-text"><br></br>
                                                                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e930">otherwise</a></span>&gt;<span class="xmlverb-text"><br></br>
                                                                                                { <br></br>
                                                                                                "line" : "</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e932">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">if(self::tei:lb/@n) then(concat(self::tei:lb/@n, '|line ',self::tei:lb/@n)) else('no line info|no line info')</span>" /&gt;<span class="xmlverb-text">",<br></br>
                                                                                                "text" : "</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e934">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">var</span>"&gt;&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e935">apply-templates</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">current-group()[not(self::tei:lb)]</span>" <span class="xmlverb-attr-name">mode</span>="<span class="xmlverb-attr-content">dipl</span>" /&gt;&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">variable</span>&gt;<span class="xmlverb-text"><br></br>
                                                                                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e937">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">var1</span>"&gt;&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e938">apply-templates</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$var</span>" <span class="xmlverb-attr-name">mode</span>="<span class="xmlverb-attr-content">delete_el1</span>" /&gt;&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">variable</span>&gt;<span class="xmlverb-text"><br></br>
                                                                                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e940">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">var2</span>"&gt;&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e941">apply-templates</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$var1//text()[not(ancestor::span)]</span>" <span class="xmlverb-attr-name">mode</span>="<span class="xmlverb-attr-content">deleteSpaces</span>" /&gt;&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">variable</span>&gt;<span class="xmlverb-text"><br></br>
                                                                                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e943">copy-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">replace($var2, '(\\|/)', '$1$1')</span>" /&gt;<span class="xmlverb-text">",<br></br>
                                                                                                "tags" : "</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e946">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">ancestor::tei:sourceDoc/@xml:id</span>" /&gt;<span class="xmlverb-text">|</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e948">choose</a></span>&gt;&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e949">when</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">ancestor::tei:sourceDoc/@n</span>"&gt;&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e950">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">ancestor::tei:sourceDoc/@n</span>" /&gt;&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">when</span>&gt;&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e951">otherwise</a></span>&gt;&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e952">call-template</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">generateTextLabel</span>"&gt;&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e953">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">text_id</span>"&gt;&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e954">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">ancestor::tei:sourceDoc/@xml:id</span>" /&gt;&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">with-param</span>&gt;&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">call-template</span>&gt;&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">otherwise</span>&gt;&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">choose</span>&gt;<span class="xmlverb-text">",<br></br>
                                                                                                "loc" : "</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e956">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$pageId</span>" /&gt;<span class="xmlverb-text">|</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e958">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$pageLabel</span>" /&gt;<span class="xmlverb-text">"<br></br>
                                                                                                }<br></br>
                                                                                        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">otherwise</span>&gt;<span class="xmlverb-text"><br></br>
                                                                                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">choose</span>&gt;<span class="xmlverb-text"><br></br>
                                                                        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">if</span>&gt;<span class="xmlverb-text"><br></br>
                                                                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">for-each-group</span>&gt;<span class="xmlverb-text"><br></br>
                                                        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">when</span>&gt;<span class="xmlverb-text"><br></br>
                                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e965">when</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">current()/(descendant-or-self::line)</span>"&gt;<span class="xmlverb-text"><br></br>
                                                                </span>&lt;!--<span class="xmlverb-comment">&lt;xsl:variable name="var"&gt;&lt;xsl:apply-templates select="current-group()[not(self::tei:pb)]" mode="interp"/&gt;&lt;/xsl:variable&gt;<br></br>
                                                                &lt;xsl:copy-of select="$var//text()"&gt;&lt;/xsl:copy-of&gt;</span>--&gt;<span class="xmlverb-text"><br></br>
                                                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e969">for-each-group</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">current()/descendant::line</span>" <span class="xmlverb-attr-name">group-starting-with</span>="<span class="xmlverb-attr-content">//tei:line</span>"&gt;<span class="xmlverb-text"><br></br>
                                                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e971">choose</a></span>&gt;<span class="xmlverb-text"><br></br>
                                                                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e973">when</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">following::line</span>"&gt;<span class="xmlverb-text"><br></br>
                                                                                        {<br></br>
                                                                                        "line" : "</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e975">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">if(@xml:id) then (@xml:id) else('no line info')</span>" /&gt;<span class="xmlverb-text">|</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e977">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">if(@n) then(concat('line ',@n)) else('no line info')</span>" /&gt;<span class="xmlverb-text">",<br></br>
                                                                                        "text" : </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e979">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">var</span>"&gt;&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e980">apply-templates</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">current-group()[not(self::tei:pb)]</span>" <span class="xmlverb-attr-name">mode</span>="<span class="xmlverb-attr-content">dipl</span>" /&gt;&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">variable</span>&gt;<span class="xmlverb-text">"</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e982">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">fn:normalize-space($var)</span>" /&gt;<span class="xmlverb-text">",<br></br>
                                                                                        "tags" : "</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e984">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">ancestor::tei:sourceDoc/@xml:id</span>" /&gt;<span class="xmlverb-text">|</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e987">choose</a></span>&gt;&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e988">when</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">ancestor::tei:sourceDoc/@n</span>"&gt;&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e989">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">ancestor::tei:sourceDoc/@n</span>" /&gt;&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">when</span>&gt;&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e990">otherwise</a></span>&gt;&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e991">call-template</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">generateTextLabel</span>"&gt;&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e992">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">text_id</span>"&gt;&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e993">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">ancestor::tei:sourceDoc/@xml:id</span>" /&gt;&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">with-param</span>&gt;&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">call-template</span>&gt;&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">otherwise</span>&gt;&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">choose</span>&gt;<span class="xmlverb-text">",<br></br>
                                                                                        "loc" : "</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e995">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$pageId</span>" /&gt;<span class="xmlverb-text">|</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e997">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$pageLabel</span>" /&gt;<span class="xmlverb-text">"<br></br>
                                                                                        },<br></br>
                                                                                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">when</span>&gt;<span class="xmlverb-text"><br></br>
                                                                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1000">otherwise</a></span>&gt;<span class="xmlverb-text"><br></br>
                                                                                        {<br></br>
                                                                                        "line" : "</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1002">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">if(@xml:id) then (@xml:id) else('no line info')</span>" /&gt;<span class="xmlverb-text">|</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1004">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">if(@n) then(concat('line ',@n)) else('no line info')</span>" /&gt;<span class="xmlverb-text">",<br></br>
                                                                                        "text" : </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1006">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">var</span>"&gt;&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1007">apply-templates</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">current-group()[not(self::tei:pb)]</span>" <span class="xmlverb-attr-name">mode</span>="<span class="xmlverb-attr-content">dipl</span>" /&gt;&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">variable</span>&gt;<span class="xmlverb-text">"</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1009">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">fn:normalize-space($var)</span>" /&gt;<span class="xmlverb-text">",<br></br>
                                                                                        "tags" : "</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1011">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">ancestor::tei:sourceDoc/@xml:id</span>" /&gt;<span class="xmlverb-text">|</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1014">choose</a></span>&gt;&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1015">when</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">ancestor::tei:sourceDoc/@n</span>"&gt;&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1016">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">ancestor::tei:sourceDoc/@n</span>" /&gt;&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">when</span>&gt;&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1017">otherwise</a></span>&gt;&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1018">call-template</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">generateTextLabel</span>"&gt;&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1019">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">text_id</span>"&gt;&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1020">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">ancestor::tei:sourceDoc/@xml:id</span>" /&gt;&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">with-param</span>&gt;&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">call-template</span>&gt;&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">otherwise</span>&gt;&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">choose</span>&gt;<span class="xmlverb-text">",<br></br>
                                                                                        "loc" : "</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1022">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$pageId</span>" /&gt;<span class="xmlverb-text">|</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1024">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$pageLabel</span>" /&gt;<span class="xmlverb-text">"<br></br>
                                                                                        }<br></br>
                                                                                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">otherwise</span>&gt;<span class="xmlverb-text"><br></br>
                                                                        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">choose</span>&gt;<span class="xmlverb-text"><br></br>
                                                                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">for-each-group</span>&gt;<span class="xmlverb-text"><br></br>
                                                        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">when</span>&gt;<span class="xmlverb-text"><br></br>
                                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1030">otherwise</a></span>&gt;<span class="xmlverb-text"><br></br>
                                                                {<br></br>
                                                                "line" : "no line info|no line info",<br></br>
                                                                "text" : "</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1032">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">var</span>"&gt;&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1033">apply-templates</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">current()</span>" <span class="xmlverb-attr-name">mode</span>="<span class="xmlverb-attr-content">dipl</span>" /&gt;&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">variable</span>&gt;&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1034">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">var1</span>"&gt;&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1035">apply-templates</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$var</span>" <span class="xmlverb-attr-name">mode</span>="<span class="xmlverb-attr-content">delete_el2</span>" /&gt;&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">variable</span>&gt;&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1036">copy-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$var1//text()</span>" /&gt;<span class="xmlverb-text">",<br></br>
                                                                "tags" : "</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1038">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">ancestor::tei:sourceDoc/@xml:id</span>" /&gt;<span class="xmlverb-text">|</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1040">choose</a></span>&gt;&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1041">when</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">ancestor::tei:sourceDoc/@n</span>"&gt;&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1042">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">ancestor::tei:sourceDoc/@n</span>" /&gt;&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">when</span>&gt;&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1043">otherwise</a></span>&gt;&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1044">call-template</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">generateTextLabel</span>"&gt;&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1045">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">text_id</span>"&gt;&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1046">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">ancestor::tei:sourceDoc/@xml:id</span>" /&gt;&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">with-param</span>&gt;&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">call-template</span>&gt;&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">otherwise</span>&gt;&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">choose</span>&gt;<span class="xmlverb-text">",<br></br>
                                                                "loc" : "</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1048">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$pageId</span>" /&gt;<span class="xmlverb-text">|</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1051">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$pageLabel</span>" /&gt;<span class="xmlverb-text">"<br></br>
                                                                },<br></br>
                                                        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">otherwise</span>&gt;<span class="xmlverb-text"><br></br>
                                                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">choose</span>&gt;<span class="xmlverb-text"><br></br>
                                        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">if</span>&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">for-each</span>&gt;<span class="xmlverb-text"><br></br>
                                ]}<br></br>
                        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">result-document</span>&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">if</span>&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1059">if</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">$edition_array[2]!=''</span>"&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1061">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">edition_current</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">lower-case($edition_array[2])</span>" /&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1063">result-document</a></span> <span class="xmlverb-attr-name">method</span>="<span class="xmlverb-attr-content">text</span>" <span class="xmlverb-attr-name">href</span>="<span class="xmlverb-attr-content">{$filePrefix}/data/output_data/{$edition_current}/{$edition_current}.json</span>" <span class="xmlverb-attr-name">indent</span>="<span class="xmlverb-attr-content">no</span>"&gt;<span class="xmlverb-text"><br></br>
                                {"pages": [<br></br>
                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1065">for-each</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$root//tei:surface</span>"&gt;<span class="xmlverb-text"><br></br>
                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1067">if</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">current()/@xml:id</span>"&gt;<span class="xmlverb-text"><br></br>
                                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1069">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">pageId</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">if(@xml:id) then (@xml:id) else (@n)</span>" /&gt;<span class="xmlverb-text"><br></br>
                                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1071">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">pageLabel</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">if(@n) then (@n) else (@xml:id)</span>" /&gt;<span class="xmlverb-text"><br></br>
                                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1073">choose</a></span>&gt;<span class="xmlverb-text"><br></br>
                                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1075">when</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">current()/(descendant-or-self::lb)</span>"&gt;<span class="xmlverb-text"><br></br>
                                                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1077">for-each-group</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">current()</span>" <span class="xmlverb-attr-name">group-starting-with</span>="<span class="xmlverb-attr-content">tei:lb</span>"&gt;<span class="xmlverb-text"><br></br>
                                                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1079">if</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">current-group()[not((string-length(normalize-space()))= 0)]</span>"&gt;<span class="xmlverb-text"><br></br>
                                                                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1081">choose</a></span>&gt;<span class="xmlverb-text"><br></br>
                                                                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1083">when</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">following::lb</span>"&gt;<span class="xmlverb-text"><br></br>
                                                                                                { <br></br>
                                                                                                "line" : "</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1085">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">if(self::tei:lb/@n) then(concat(self::tei:lb/@n, '|line ',self::tei:lb/@n)) else('no line info |no line info')</span>" /&gt;<span class="xmlverb-text">",<br></br>
                                                                                                "text" : "</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1087">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">var</span>"&gt;&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1088">apply-templates</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">current-group()[not(self::tei:lb)]</span>" <span class="xmlverb-attr-name">mode</span>="<span class="xmlverb-attr-content">interp</span>" /&gt;&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">variable</span>&gt;<span class="xmlverb-text"><br></br>
                                                                                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1090">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">var1</span>"&gt;&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1091">apply-templates</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$var</span>" <span class="xmlverb-attr-name">mode</span>="<span class="xmlverb-attr-content">delete_el2</span>" /&gt;&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">variable</span>&gt;<span class="xmlverb-text"><br></br>
                                                                                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1093">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">var2</span>"&gt;&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1094">apply-templates</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$var1//text()[not(ancestor::span)]</span>" <span class="xmlverb-attr-name">mode</span>="<span class="xmlverb-attr-content">deleteSpaces</span>" /&gt;&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">variable</span>&gt;<span class="xmlverb-text"><br></br>
                                                                                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1096">copy-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">replace($var2, '(\\|/)', '$1$1')</span>" /&gt;<span class="xmlverb-text">",<br></br>
                                                                                                "tags" : "</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1099">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">ancestor::tei:sourceDoc/@xml:id</span>" /&gt;<span class="xmlverb-text">|</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1101">choose</a></span>&gt;&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1102">when</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">ancestor::tei:sourceDoc/@n</span>"&gt;&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1103">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">ancestor::tei:sourceDoc/@n</span>" /&gt;&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">when</span>&gt;&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1104">otherwise</a></span>&gt;&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1105">call-template</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">generateTextLabel</span>"&gt;&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1106">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">text_id</span>"&gt;&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1107">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">ancestor::tei:sourceDoc/@xml:id</span>" /&gt;&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">with-param</span>&gt;&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">call-template</span>&gt;&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">otherwise</span>&gt;&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">choose</span>&gt;<span class="xmlverb-text">",<br></br>
                                                                                                "loc" : "</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1109">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$pageId</span>" /&gt;<span class="xmlverb-text">|</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1111">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$pageLabel</span>" /&gt;<span class="xmlverb-text">"<br></br>
                                                                                                },<br></br>
                                                                                        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">when</span>&gt;<span class="xmlverb-text"><br></br>
                                                                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1114">otherwise</a></span>&gt;<span class="xmlverb-text"><br></br>
                                                                                                { <br></br>
                                                                                                "line" : "</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1116">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">if(self::tei:lb/@n) then(concat(self::tei:lb/@n, '|line ',self::tei:lb/@n)) else('no line info |no line info')</span>" /&gt;<span class="xmlverb-text">",<br></br>
                                                                                                "text" : "</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1118">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">var</span>"&gt;&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1119">apply-templates</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">current-group()[not(self::tei:lb)]</span>" <span class="xmlverb-attr-name">mode</span>="<span class="xmlverb-attr-content">interp</span>" /&gt;&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">variable</span>&gt;<span class="xmlverb-text"><br></br>
                                                                                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1121">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">var1</span>"&gt;&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1122">apply-templates</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$var</span>" <span class="xmlverb-attr-name">mode</span>="<span class="xmlverb-attr-content">delete_el2</span>" /&gt;&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">variable</span>&gt;<span class="xmlverb-text"><br></br>
                                                                                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1124">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">var2</span>"&gt;&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1125">apply-templates</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$var1//text()[not(ancestor::span)]</span>" <span class="xmlverb-attr-name">mode</span>="<span class="xmlverb-attr-content">deleteSpaces</span>" /&gt;&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">variable</span>&gt;<span class="xmlverb-text"><br></br>
                                                                                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1127">copy-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">replace($var2, '(\\|/)', '$1$1')</span>" /&gt;<span class="xmlverb-text">",<br></br>
                                                                                                "tags" : "</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1130">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">ancestor::tei:sourceDoc/@xml:id</span>" /&gt;<span class="xmlverb-text">|</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1132">choose</a></span>&gt;&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1133">when</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">ancestor::tei:sourceDoc/@n</span>"&gt;&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1134">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">ancestor::tei:sourceDoc/@n</span>" /&gt;&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">when</span>&gt;&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1135">otherwise</a></span>&gt;&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1136">call-template</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">generateTextLabel</span>"&gt;&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1137">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">text_id</span>"&gt;&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1138">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">ancestor::tei:sourceDoc/@xml:id</span>" /&gt;&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">with-param</span>&gt;&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">call-template</span>&gt;&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">otherwise</span>&gt;&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">choose</span>&gt;<span class="xmlverb-text">",<br></br>
                                                                                                "loc" : "</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1140">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$pageId</span>" /&gt;<span class="xmlverb-text">|</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1142">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$pageLabel</span>" /&gt;<span class="xmlverb-text">"<br></br>
                                                                                                }<br></br>
                                                                                        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">otherwise</span>&gt;<span class="xmlverb-text"><br></br>
                                                                                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">choose</span>&gt;<span class="xmlverb-text"><br></br>
                                                                        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">if</span>&gt;<span class="xmlverb-text"><br></br>
                                                                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">for-each-group</span>&gt;<span class="xmlverb-text"><br></br>
                                                        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">when</span>&gt;<span class="xmlverb-text"><br></br>
                                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1149">when</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">current()/(descendant-or-self::p)</span>"&gt;<span class="xmlverb-text"><br></br>
                                                                </span>&lt;!--<span class="xmlverb-comment">&lt;xsl:variable name="var"&gt;&lt;xsl:apply-templates select="current-group()[not(self::tei:pb)]" mode="interp"/&gt;&lt;/xsl:variable&gt;<br></br>
                                                                &lt;xsl:copy-of select="$var//text()"&gt;&lt;/xsl:copy-of&gt;</span>--&gt;<span class="xmlverb-text"><br></br>
                                                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1153">for-each-group</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">current()/descendant::p</span>" <span class="xmlverb-attr-name">group-starting-with</span>="<span class="xmlverb-attr-content">//tei:p</span>"&gt;<span class="xmlverb-text"><br></br>
                                                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1155">choose</a></span>&gt;<span class="xmlverb-text"><br></br>
                                                                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1157">when</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">following::p</span>"&gt;<span class="xmlverb-text"><br></br>
                                                                                        {<br></br>
                                                                                        "line" : "</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1159">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">if(@xml:id) then (@xml:id) else('no par info')</span>" /&gt;<span class="xmlverb-text">|</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1161">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">if(@n) then(concat('par ',@n)) else('no par info')</span>" /&gt;<span class="xmlverb-text">",<br></br>
                                                                                        "text" : </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1163">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">var</span>"&gt;&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1164">apply-templates</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">current-group()[not(self::tei:pb)]</span>" <span class="xmlverb-attr-name">mode</span>="<span class="xmlverb-attr-content">dipl</span>" /&gt;&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">variable</span>&gt;<span class="xmlverb-text">"</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1166">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">fn:normalize-space($var)</span>" /&gt;<span class="xmlverb-text">",<br></br>
                                                                                        "tags" : "</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1168">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">ancestor::tei:sourceDoc/@xml:id</span>" /&gt;<span class="xmlverb-text">|</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1171">choose</a></span>&gt;&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1172">when</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">ancestor::tei:sourceDoc/@n</span>"&gt;&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1173">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">ancestor::tei:sourceDoc/@n</span>" /&gt;&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">when</span>&gt;&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1174">otherwise</a></span>&gt;&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1175">call-template</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">generateTextLabel</span>"&gt;&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1176">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">text_id</span>"&gt;&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1177">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">ancestor::tei:sourceDoc/@xml:id</span>" /&gt;&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">with-param</span>&gt;&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">call-template</span>&gt;&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">otherwise</span>&gt;&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">choose</span>&gt;<span class="xmlverb-text">",<br></br>
                                                                                        "loc" : "</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1179">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$pageId</span>" /&gt;<span class="xmlverb-text">|</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1181">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$pageLabel</span>" /&gt;<span class="xmlverb-text">"<br></br>
                                                                                        },<br></br>
                                                                                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">when</span>&gt;<span class="xmlverb-text"><br></br>
                                                                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1184">otherwise</a></span>&gt;<span class="xmlverb-text"><br></br>
                                                                                        {<br></br>
                                                                                        "line" : "</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1186">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">if(@xml:id) then (@xml:id) else('no par info')</span>" /&gt;<span class="xmlverb-text">|</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1188">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">if(@n) then(concat('par ',@n)) else('no par info')</span>" /&gt;<span class="xmlverb-text">",<br></br>
                                                                                        "text" : </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1190">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">var</span>"&gt;&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1191">apply-templates</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">current-group()[not(self::tei:pb)]</span>" <span class="xmlverb-attr-name">mode</span>="<span class="xmlverb-attr-content">dipl</span>" /&gt;&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">variable</span>&gt;<span class="xmlverb-text">"</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1193">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">fn:normalize-space($var)</span>" /&gt;<span class="xmlverb-text">",<br></br>
                                                                                        "tags" : "</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1195">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">ancestor::tei:sourceDoc/@xml:id</span>" /&gt;<span class="xmlverb-text">|</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1198">choose</a></span>&gt;&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1199">when</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">ancestor::tei:sourceDoc/@n</span>"&gt;&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1200">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">ancestor::tei:sourceDoc/@n</span>" /&gt;&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">when</span>&gt;&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1201">otherwise</a></span>&gt;&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1202">call-template</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">generateTextLabel</span>"&gt;&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1203">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">text_id</span>"&gt;&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1204">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">ancestor::tei:sourceDoc/@xml:id</span>" /&gt;&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">with-param</span>&gt;&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">call-template</span>&gt;&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">otherwise</span>&gt;&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">choose</span>&gt;<span class="xmlverb-text">",<br></br>
                                                                                        "loc" : "</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1206">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$pageId</span>" /&gt;<span class="xmlverb-text">|</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1208">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$pageLabel</span>" /&gt;<span class="xmlverb-text">"<br></br>
                                                                                        }<br></br>
                                                                                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">otherwise</span>&gt;<span class="xmlverb-text"><br></br>
                                                                        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">choose</span>&gt;<span class="xmlverb-text"><br></br>
                                                                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">for-each-group</span>&gt;<span class="xmlverb-text"><br></br>
                                                        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">when</span>&gt;<span class="xmlverb-text"><br></br>
                                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1214">when</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">current()/(descendant-or-self::line)</span>"&gt;<span class="xmlverb-text"><br></br>
                                                                </span>&lt;!--<span class="xmlverb-comment">&lt;xsl:variable name="var"&gt;&lt;xsl:apply-templates select="current-group()[not(self::tei:pb)]" mode="interp"/&gt;&lt;/xsl:variable&gt;<br></br>
                                                                &lt;xsl:copy-of select="$var//text()"&gt;&lt;/xsl:copy-of&gt;</span>--&gt;<span class="xmlverb-text"><br></br>
                                                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1218">for-each-group</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">current()/descendant::line</span>" <span class="xmlverb-attr-name">group-starting-with</span>="<span class="xmlverb-attr-content">//tei:line</span>"&gt;<span class="xmlverb-text"><br></br>
                                                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1220">choose</a></span>&gt;<span class="xmlverb-text"><br></br>
                                                                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1222">when</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">following::line</span>"&gt;<span class="xmlverb-text"><br></br>
                                                                                        {<br></br>
                                                                                        "line" : "</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1224">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">if(@xml:id) then (@xml:id) else('no line info')</span>" /&gt;<span class="xmlverb-text">|</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1226">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">if(@n) then(concat('line ',@n)) else('no line info')</span>" /&gt;<span class="xmlverb-text">",<br></br>
                                                                                        "text" : </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1228">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">var</span>"&gt;&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1229">apply-templates</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">current-group()[not(self::tei:pb)]</span>" <span class="xmlverb-attr-name">mode</span>="<span class="xmlverb-attr-content">dipl</span>" /&gt;&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">variable</span>&gt;<span class="xmlverb-text">"</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1231">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">fn:normalize-space($var)</span>" /&gt;<span class="xmlverb-text">",<br></br>
                                                                                        "tags" : "</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1233">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">ancestor::tei:sourceDoc/@xml:id</span>" /&gt;<span class="xmlverb-text">|</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1236">choose</a></span>&gt;&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1237">when</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">ancestor::tei:sourceDoc/@n</span>"&gt;&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1238">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">ancestor::tei:sourceDoc/@n</span>" /&gt;&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">when</span>&gt;&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1239">otherwise</a></span>&gt;&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1240">call-template</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">generateTextLabel</span>"&gt;&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1241">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">text_id</span>"&gt;&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1242">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">ancestor::tei:sourceDoc/@xml:id</span>" /&gt;&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">with-param</span>&gt;&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">call-template</span>&gt;&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">otherwise</span>&gt;&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">choose</span>&gt;<span class="xmlverb-text">",<br></br>
                                                                                        "loc" : "</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1244">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$pageId</span>" /&gt;<span class="xmlverb-text">|</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1246">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$pageLabel</span>" /&gt;<span class="xmlverb-text">"<br></br>
                                                                                        },<br></br>
                                                                                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">when</span>&gt;<span class="xmlverb-text"><br></br>
                                                                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1249">otherwise</a></span>&gt;<span class="xmlverb-text"><br></br>
                                                                                        {<br></br>
                                                                                        "line" : "</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1251">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">if(@xml:id) then (@xml:id) else('no line info')</span>" /&gt;<span class="xmlverb-text">|</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1253">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">if(@n) then(concat('line ',@n)) else('no line info')</span>" /&gt;<span class="xmlverb-text">",<br></br>
                                                                                        "text" : </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1255">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">var</span>"&gt;&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1256">apply-templates</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">current-group()[not(self::tei:pb)]</span>" <span class="xmlverb-attr-name">mode</span>="<span class="xmlverb-attr-content">dipl</span>" /&gt;&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">variable</span>&gt;<span class="xmlverb-text">"</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1258">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">fn:normalize-space($var)</span>" /&gt;<span class="xmlverb-text">",<br></br>
                                                                                        "tags" : "</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1260">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">ancestor::tei:sourceDoc/@xml:id</span>" /&gt;<span class="xmlverb-text">|</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1263">choose</a></span>&gt;&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1264">when</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">ancestor::tei:sourceDoc/@n</span>"&gt;&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1265">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">ancestor::tei:sourceDoc/@n</span>" /&gt;&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">when</span>&gt;&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1266">otherwise</a></span>&gt;&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1267">call-template</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">generateTextLabel</span>"&gt;&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1268">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">text_id</span>"&gt;&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1269">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">ancestor::tei:sourceDoc/@xml:id</span>" /&gt;&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">with-param</span>&gt;&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">call-template</span>&gt;&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">otherwise</span>&gt;&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">choose</span>&gt;<span class="xmlverb-text">",<br></br>
                                                                                        "loc" : "</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1271">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$pageId</span>" /&gt;<span class="xmlverb-text">|</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1273">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$pageLabel</span>" /&gt;<span class="xmlverb-text">"<br></br>
                                                                                        }<br></br>
                                                                                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">otherwise</span>&gt;<span class="xmlverb-text"><br></br>
                                                                        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">choose</span>&gt;<span class="xmlverb-text"><br></br>
                                                                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">for-each-group</span>&gt;<span class="xmlverb-text"><br></br>
                                                        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">when</span>&gt;<span class="xmlverb-text"><br></br>
                                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1279">otherwise</a></span>&gt;<span class="xmlverb-text"><br></br>
                                                                {<br></br>
                                                                "line" : "no line info|no line info",<br></br>
                                                                "text" : "</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1281">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">var</span>"&gt;&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1282">apply-templates</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">current()</span>" <span class="xmlverb-attr-name">mode</span>="<span class="xmlverb-attr-content">interp</span>" /&gt;&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">variable</span>&gt;&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1283">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">var1</span>"&gt;&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1284">apply-templates</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$var</span>" <span class="xmlverb-attr-name">mode</span>="<span class="xmlverb-attr-content">delete_el2</span>" /&gt;&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">variable</span>&gt;&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1285">copy-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$var1//text()</span>" /&gt;<span class="xmlverb-text">",<br></br>
                                                                "tags" : "</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1287">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">ancestor::tei:sourceDoc/@xml:id</span>" /&gt;<span class="xmlverb-text">|</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1289">choose</a></span>&gt;&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1290">when</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">ancestor::tei:sourceDoc/@n</span>"&gt;&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1291">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">ancestor::tei:sourceDoc/@n</span>" /&gt;&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">when</span>&gt;&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1292">otherwise</a></span>&gt;&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1293">call-template</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">generateTextLabel</span>"&gt;&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1294">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">text_id</span>"&gt;&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1295">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">ancestor::tei:sourceDoc/@xml:id</span>" /&gt;&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">with-param</span>&gt;&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">call-template</span>&gt;&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">otherwise</span>&gt;&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">choose</span>&gt;<span class="xmlverb-text">",<br></br>
                                                                "loc" : "</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1297">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$pageId</span>" /&gt;<span class="xmlverb-text">|</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1300">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$pageLabel</span>" /&gt;<span class="xmlverb-text">"<br></br>
                                                                },<br></br>
                                                        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">otherwise</span>&gt;<span class="xmlverb-text"><br></br>
                                                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">choose</span>&gt;<span class="xmlverb-text"><br></br>
                                        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">if</span>&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">for-each</span>&gt;<span class="xmlverb-text"><br></br>
                                ]}<br></br>
                        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">result-document</span>&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">if</span>&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">template</span>&gt;<span class="xmlverb-text"><br></br>
        <br></br>
        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1309">template</a></span> <span class="xmlverb-attr-name">match</span>="<span class="xmlverb-attr-content">tei:emph</span>"&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;<span class="xmlverb-element-name"><a name="d20e1311">span</a></span> <span class="xmlverb-attr-name">class</span>="<span class="xmlverb-attr-content">emph</span>"&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1313">apply-templates</a></span> /&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;/<span class="xmlverb-element-name">span</span>&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">template</span>&gt;<span class="xmlverb-text"><br></br>
        <br></br>
        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1317">template</a></span> <span class="xmlverb-attr-name">match</span>="<span class="xmlverb-attr-content">tei:p</span>"&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;<span class="xmlverb-element-name"><a name="d20e1319">p</a></span>&gt;&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1320">apply-templates</a></span> /&gt;&lt;/<span class="xmlverb-element-name">p</span>&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">template</span>&gt;<span class="xmlverb-text"><br></br>
        <br></br>
        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1323">template</a></span> <span class="xmlverb-attr-name">match</span>="<span class="xmlverb-attr-content">tei:hi[@rend]</span>"&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1325">element</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">span</span>"&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1327">attribute</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">class</span>"&gt;&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1328">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">@rend</span>" /&gt;&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">attribute</span>&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1330">apply-templates</a></span> /&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">element</span>&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">template</span>&gt;<span class="xmlverb-text"><br></br>
</span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">stylesheet</span>&gt;<br></br>
</div>
</tt><br></br><br></br><br></br><br></br><br></br><br></br><br></br><br></br><br></br><br></br><br></br><br></br><br></br><br></br><br></br><br></br><br></br><br></br><br></br><br></br><br></br><br></br><br></br><br></br><br></br><br></br><br></br><br></br><br></br><br></br><br></br><br></br><br></br><br></br><br></br><br></br><br></br><br></br>v
         </body></html>
