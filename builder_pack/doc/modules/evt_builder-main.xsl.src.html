<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html><head><title>XML source view</title><link rel="stylesheet" type="text/css" href="../xmlverbatim.css"></link></head><body class="xmlverb-default"><tt>
<!-- converted by xmlverbatim.xsl 1.1, (c) O. Becker -->
<div xmlns:xd="http://www.pnp-software.com/XSLTdoc" class="xmlverb-default">&lt;!--<span class="xmlverb-comment"> <br></br>
    Copyright (C) 2013-2017 the EVT Development Team.<br></br>
    <br></br>
    EVT 1 is free software: you can redistribute it <br></br>
    and/or modify it under the terms of the <br></br>
    GNU General Public License version 2<br></br>
    available in the LICENSE file (or see &lt;http://www.gnu.org/licenses/&gt;).<br></br>
    <br></br>
    EVT 1 is distributed in the hope that it will be useful, <br></br>
    but WITHOUT ANY WARRANTY; without even the implied <br></br>
    warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  <br></br>
    See the GNU General Public License for more details. <br></br>
</span>--&gt;<br></br>
&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e2">stylesheet</a></span><span class="xmlverb-ns-name"> xmlns:xsl</span>="<span class="xmlverb-ns-uri">http://www.w3.org/1999/XSL/Transform</span>"<span class="xmlverb-ns-name"> xmlns:xs</span>="<span class="xmlverb-ns-uri">http://www.w3.org/2001/XMLSchema</span>"<span class="xmlverb-ns-name"> xmlns:eg</span>="<span class="xmlverb-ns-uri">http://www.tei-c.org/ns/Examples</span>"<span class="xmlverb-ns-name"> xmlns:xd</span>="<span class="xmlverb-ns-uri">http://www.pnp-software.com/XSLTdoc</span>"<span class="xmlverb-ns-name"> xmlns:fn</span>="<span class="xmlverb-ns-uri">http://www.w3.org/2005/xpath-functions</span>"<span class="xmlverb-ns-name"> xmlns:tei</span>="<span class="xmlverb-ns-uri">http://www.tei-c.org/ns/1.0</span>"<span class="xmlverb-ns-name"> xmlns</span>="<span class="xmlverb-ns-uri">http://www.w3.org/1999/xhtml</span>" <span class="xmlverb-attr-name">xpath-default-namespace</span>="<span class="xmlverb-attr-content">http://www.tei-c.org/ns/1.0</span>" <span class="xmlverb-attr-name">version</span>="<span class="xmlverb-attr-content">2.0</span>" <span class="xmlverb-attr-name">exclude-result-prefixes</span>="<span class="xmlverb-attr-content">#all</span>"&gt;<span class="xmlverb-text"><br></br>
        <br></br>
        </span><div class="xd">
	
	&lt;<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name"><a name="d20e4">doc</a></span> <span class="xmlverb-attr-name">type</span>="<span class="xmlverb-attr-content">stylesheet</span>"&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name"><a name="d20e6">short</a></span>&gt;<span class="xmlverb-text"><br></br>
                        EN: Main calls for building the system<br></br>
                        IT: Le chiamate principali per il build del sistema<br></br>
                </span>&lt;/<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name">short</span>&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;/<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name">doc</span>&gt;</div><span class="xmlverb-text"><br></br>
<br></br>
        </span>&lt;!--<span class="xmlverb-comment"> All </span>--&gt;<span class="xmlverb-text"><br></br>
    </span><div class="xd">
	
	&lt;<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name"><a name="d20e12">doc</a></span>&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name"><a name="d20e14">short</a></span>&gt;<span class="xmlverb-text"><br></br>
                        EN: Main system call<br></br>
                        IT: Chiamata principale del sistema<br></br>
        </span>&lt;/<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name">short</span>&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name"><a name="d20e17">detail</a></span>&gt;<span class="xmlverb-text"><br></br>
                        EN: The first part outputs the HTML files for the different edition levels, while the second one calls the general template to build the index.<br></br>
                        IT: La prima parte produce in output i file HTML delle diverse edizioni, mentre la seconda richiama il template generale per il build della index.<br></br>
                </span>&lt;/<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name">detail</span>&gt;<span class="xmlverb-text"><br></br>
    </span>&lt;/<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name">doc</span>&gt;</div><span class="xmlverb-text"><br></br>
        <br></br>
        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e21">output</a></span> <span class="xmlverb-attr-name">indent</span>="<span class="xmlverb-attr-content">yes</span>" <span class="xmlverb-attr-name">method</span>="<span class="xmlverb-attr-content">html</span>" <span class="xmlverb-attr-name">encoding</span>="<span class="xmlverb-attr-content">UTF-8</span>" <span class="xmlverb-attr-name">media-type</span>="<span class="xmlverb-attr-content">text/plain</span>" <span class="xmlverb-attr-name">doctype-public</span>="<span class="xmlverb-attr-content">-//W3C//DTD XHTML 1.0 Strict//EN</span>" <span class="xmlverb-attr-name">doctype-system</span>="<span class="xmlverb-attr-content">http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd</span>" /&gt;<span class="xmlverb-text"><br></br>
<br></br>
        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e23">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">root</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">/</span>" /&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e26">template</a></span> <span class="xmlverb-attr-name">match</span>="<span class="xmlverb-attr-content">/</span>" <span class="xmlverb-attr-name">priority</span>="<span class="xmlverb-attr-content">1</span>"&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;!--<span class="xmlverb-comment"> Found the node(s) for embedded transcription</span>--&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;!--<span class="xmlverb-comment"> <br></br>
                        &lt;xsl:choose&gt;<br></br>
                                &lt;xsl:when test="tei:TEI/tei:sourceDoc"&gt;<br></br>
                                <br></br>
                                &lt;xsl:apply-templates select="." mode="splitPages4embedded"&gt;&lt;/xsl:apply-templates&gt;<br></br>
                                &lt;xsl:apply-templates select="." mode="structure_generation4embedded"&gt;&lt;/xsl:apply-templates&gt;<br></br>
                        &lt;/xsl:when&gt;<br></br>
                        &lt;xsl:otherwise&gt;<br></br>
                                &lt;xsl:apply-templates select="$step0" mode="splitPages"&gt;&lt;/xsl:apply-templates&gt;<br></br>
                                &lt;xsl:apply-templates select="$step0" mode="file4search"&gt;&lt;/xsl:apply-templates&gt;<br></br>
                                &lt;xsl:apply-templates select="$step0" mode="structure_generation"&gt;&lt;/xsl:apply-templates&gt;<br></br>
                        &lt;/xsl:otherwise&gt;<br></br>
                &lt;/xsl:choose&gt;</span>--&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;!--<span class="xmlverb-comment"> CDP: Embedded </span>--&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;!--<span class="xmlverb-comment"> EN: If there is at least a &lt;sourceDoc&gt; element the transformations for embedded are activated </span>--&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;!--<span class="xmlverb-comment"> IT: Le trasformazioni per l'embedded transcription vengono attivate se nel documento esiste almeno un elemento &lt;sourceDoc&gt; </span>--&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e39">if</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">tei:TEI/tei:sourceDoc</span>"&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e41">apply-templates</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">.</span>" <span class="xmlverb-attr-name">mode</span>="<span class="xmlverb-attr-content">splitPages4embedded</span>" /&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;!--<span class="xmlverb-comment"> SEARCH </span>--&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e45">if</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">$search=true()</span>"&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e47">apply-templates</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">.</span>" <span class="xmlverb-attr-name">mode</span>="<span class="xmlverb-attr-content">file4search4embedded</span>" /&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">if</span>&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">if</span>&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;!--<span class="xmlverb-comment"> EN: If there is at least a &lt;text&gt; element the transformations for parallel transcription are activated </span>--&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;!--<span class="xmlverb-comment"> IT: Le trasformazioni per la parallel transcription vengono attivate se nel documento esiste almeno un elemento &lt;text&gt; </span>--&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e55">if</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">tei:TEI/tei:text</span>"&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e57">apply-templates</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$step0</span>" <span class="xmlverb-attr-name">mode</span>="<span class="xmlverb-attr-content">splitPages</span>" /&gt;<span class="xmlverb-text"><br></br>
                        <br></br>
                        </span>&lt;!--<span class="xmlverb-comment"> HEADER INFORMATION </span>--&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e61">if</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">$headerInfo=true()</span>"&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e63">call-template</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">headerInfo</span>" /&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">if</span>&gt;<span class="xmlverb-text"><br></br>
                        <br></br>
                        </span>&lt;!--<span class="xmlverb-comment"> MANUSCRIPT DESCRIPTION </span>--&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e68">if</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">$msDesc=true()</span>"&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e70">call-template</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">msDesc</span>" /&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">if</span>&gt;<span class="xmlverb-text"><br></br>
                        <br></br>
                        </span>&lt;!--<span class="xmlverb-comment"> REGESTO </span>--&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e76">if</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">$regesto=true()</span>"&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e78">for-each</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">tei:TEI/tei:text/tei:group/tei:text</span>"&gt;<span class="xmlverb-text"><br></br>
                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e80">call-template</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">regesto</span>" /&gt;<span class="xmlverb-text">        <br></br>
                                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">for-each</span>&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">if</span>&gt;<span class="xmlverb-text"><br></br>
                        <br></br>
                        </span>&lt;!--<span class="xmlverb-comment"> FRONT INFORMATION </span>--&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e86">if</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">$frontInfo=true()</span>"&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e88">choose</a></span>&gt;<span class="xmlverb-text"><br></br>
                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e90">when</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">$root//tei:text/tei:group</span>"&gt;<span class="xmlverb-text"><br></br>
                                                </span>&lt;!--<span class="xmlverb-comment"> Gestione TEXT multipli in tei:group </span>--&gt;<span class="xmlverb-text"><br></br>
                                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e94">for-each</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$root//tei:text/tei:group/tei:text</span>"&gt;<span class="xmlverb-text"><br></br>
                                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e96">if</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">current()/tei:front</span>"&gt;<span class="xmlverb-text"><br></br>
                                                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e98">call-template</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">front</span>" /&gt;<span class="xmlverb-text"><br></br>
                                                        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">if</span>&gt;<span class="xmlverb-text">                                                <br></br>
                                                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">for-each</span>&gt;<span class="xmlverb-text"><br></br>
                                        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">when</span>&gt;<span class="xmlverb-text"><br></br>
                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e103">otherwise</a></span>&gt;<span class="xmlverb-text"><br></br>
                                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e105">for-each</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">tei:TEI/tei:text</span>"&gt;<span class="xmlverb-text"><br></br>
                                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e107">if</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">current()/tei:front</span>"&gt;<span class="xmlverb-text"><br></br>
                                                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e109">call-template</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">front</span>" /&gt;<span class="xmlverb-text"><br></br>
                                                        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">if</span>&gt;<span class="xmlverb-text"><br></br>
                                                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">for-each</span>&gt;<span class="xmlverb-text"><br></br>
                                        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">otherwise</span>&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">choose</span>&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">if</span>&gt;<span class="xmlverb-text"><br></br>
                        <br></br>
                        </span>&lt;!--<span class="xmlverb-comment"> LISTS </span>--&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e118">if</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">$list_person=true()</span>"&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e120">result-document</a></span> <span class="xmlverb-attr-name">method</span>="<span class="xmlverb-attr-content">html</span>" <span class="xmlverb-attr-name">encoding</span>="<span class="xmlverb-attr-content">UTF-8</span>" <span class="xmlverb-attr-name">media-type</span>="<span class="xmlverb-attr-content">text/plain</span>" <span class="xmlverb-attr-name">byte-order-mark</span>="<span class="xmlverb-attr-content">yes</span>" <span class="xmlverb-attr-name">href</span>="<span class="xmlverb-attr-content">{$filePrefix}/data/output_data/liste/listPerson.html</span>" <span class="xmlverb-attr-name">indent</span>="<span class="xmlverb-attr-content">yes</span>"&gt;<span class="xmlverb-text"><br></br>
                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e122">element</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">div</span>"&gt;<span class="xmlverb-text"><br></br>
                                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e124">attribute</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">id</span>"&gt;<span class="xmlverb-text">listPerson</span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">attribute</span>&gt;<span class="xmlverb-text"><br></br>
                                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e127">attribute</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">class</span>"&gt;<span class="xmlverb-text">can-change-font-size</span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">attribute</span>&gt;<span class="xmlverb-text"><br></br>
                                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e130">call-template</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">listPerson</span>" /&gt;<span class="xmlverb-text"><br></br>
                                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e132">apply-templates</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$step0</span>" <span class="xmlverb-attr-name">mode</span>="<span class="xmlverb-attr-content">listPersonOccurences</span>" /&gt;<span class="xmlverb-text"><br></br>
                                        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">element</span>&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">result-document</span>&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">if</span>&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e137">if</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">$list_place=true()</span>"&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e139">result-document</a></span> <span class="xmlverb-attr-name">method</span>="<span class="xmlverb-attr-content">html</span>" <span class="xmlverb-attr-name">encoding</span>="<span class="xmlverb-attr-content">UTF-8</span>" <span class="xmlverb-attr-name">media-type</span>="<span class="xmlverb-attr-content">text/plain</span>" <span class="xmlverb-attr-name">byte-order-mark</span>="<span class="xmlverb-attr-content">yes</span>" <span class="xmlverb-attr-name">href</span>="<span class="xmlverb-attr-content">{$filePrefix}/data/output_data/liste/listPlace.html</span>" <span class="xmlverb-attr-name">indent</span>="<span class="xmlverb-attr-content">yes</span>"&gt;<span class="xmlverb-text"><br></br>
                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e141">element</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">div</span>"&gt;<span class="xmlverb-text"><br></br>
                                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e143">attribute</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">id</span>"&gt;<span class="xmlverb-text">listPlace</span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">attribute</span>&gt;<span class="xmlverb-text"><br></br>
                                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e146">attribute</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">class</span>"&gt;<span class="xmlverb-text">can-change-font-size</span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">attribute</span>&gt;<span class="xmlverb-text"><br></br>
                                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e149">call-template</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">listPlace</span>" /&gt;<span class="xmlverb-text"><br></br>
                                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e151">apply-templates</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$step0</span>" <span class="xmlverb-attr-name">mode</span>="<span class="xmlverb-attr-content">listPlaceOccurences</span>" /&gt;<span class="xmlverb-text"><br></br>
                                        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">element</span>&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">result-document</span>&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">if</span>&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e157">if</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">$list_org=true()</span>"&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e159">result-document</a></span> <span class="xmlverb-attr-name">method</span>="<span class="xmlverb-attr-content">html</span>" <span class="xmlverb-attr-name">encoding</span>="<span class="xmlverb-attr-content">UTF-8</span>" <span class="xmlverb-attr-name">media-type</span>="<span class="xmlverb-attr-content">text/plain</span>" <span class="xmlverb-attr-name">byte-order-mark</span>="<span class="xmlverb-attr-content">yes</span>" <span class="xmlverb-attr-name">href</span>="<span class="xmlverb-attr-content">{$filePrefix}/data/output_data/liste/listOrg.html</span>" <span class="xmlverb-attr-name">indent</span>="<span class="xmlverb-attr-content">yes</span>"&gt;<span class="xmlverb-text"><br></br>
                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e161">element</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">div</span>"&gt;<span class="xmlverb-text"><br></br>
                                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e163">attribute</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">id</span>"&gt;<span class="xmlverb-text">listOrg</span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">attribute</span>&gt;<span class="xmlverb-text"><br></br>
                                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e166">attribute</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">class</span>"&gt;<span class="xmlverb-text">can-change-font-size</span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">attribute</span>&gt;<span class="xmlverb-text"><br></br>
                                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e169">call-template</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">listOrg</span>" /&gt;<span class="xmlverb-text"><br></br>
                                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e171">apply-templates</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$step0</span>" <span class="xmlverb-attr-name">mode</span>="<span class="xmlverb-attr-content">listOrgOccurences</span>" /&gt;<span class="xmlverb-text"><br></br>
                                        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">element</span>&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">result-document</span>&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">if</span>&gt;<span class="xmlverb-text"><br></br>
                        <br></br>
                        </span>&lt;!--<span class="xmlverb-comment"> SEARCH </span>--&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e178">if</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">$search=true()</span>"&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e180">apply-templates</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$step0</span>" <span class="xmlverb-attr-name">mode</span>="<span class="xmlverb-attr-content">file4search</span>" /&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">if</span>&gt;<span class="xmlverb-text"><br></br>
                        <br></br>
                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">if</span>&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;!--<span class="xmlverb-comment"> EN: The index and structure generation are the same for both the parallel and the embedded  </span>--&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;!--<span class="xmlverb-comment"> IT: La generazione dell'index e della struttura sono uguali sia per la parallel sia per l'embedded </span>--&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e189">call-template</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">index</span>" /&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e191">apply-templates</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">.</span>" <span class="xmlverb-attr-name">mode</span>="<span class="xmlverb-attr-content">structure_generation</span>" /&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">template</span>&gt;<span class="xmlverb-text"><br></br>
        <br></br>
        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e194">template</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">index</span>"&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;!--<span class="xmlverb-comment"> EN: Index generation. The index_build template can be found in html_build/evt_builder-callhtml.xsl </span>--&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;!--<span class="xmlverb-comment"> IT: Generazione della index. Il template index_build si trova in html_build/evt_builder-callhtml.xsl </span>--&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e200">result-document</a></span> <span class="xmlverb-attr-name">method</span>="<span class="xmlverb-attr-content">html</span>" <span class="xmlverb-attr-name">encoding</span>="<span class="xmlverb-attr-content">UTF-8</span>" <span class="xmlverb-attr-name">media-type</span>="<span class="xmlverb-attr-content">text/plain</span>" <span class="xmlverb-attr-name">href</span>="<span class="xmlverb-attr-content">{$filePrefix}/index.html</span>" <span class="xmlverb-attr-name">indent</span>="<span class="xmlverb-attr-content">yes</span>"&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e202">call-template</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">index_build</span>" /&gt;<span class="xmlverb-text">                        <br></br>
                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">result-document</span>&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">template</span>&gt;<span class="xmlverb-text"><br></br>
<br></br>
        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e206">template</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">page</span>"&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;!--<span class="xmlverb-comment"> CDP:embedded </span>--&gt;<span class="xmlverb-text">        <br></br>
                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e210">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">pb_n</span>"&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e212">choose</a></span>&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e214">when</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">@xml:id</span>"&gt;<span class="xmlverb-text"><br></br>
                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e216">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">@xml:id</span>" /&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">when</span>&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e219">when</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">@n</span>"&gt;<span class="xmlverb-text"><br></br>
                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e221">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">@n</span>" /&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">when</span>&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e224">when</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">@facs</span>"&gt;<span class="xmlverb-text"><br></br>
                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e226">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">@facs</span>" /&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">when</span>&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e229">otherwise</a></span>&gt;<span class="xmlverb-text"><br></br>
                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e231">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">position()</span>" /&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">otherwise</span>&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">choose</span>&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">variable</span>&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;!--<span class="xmlverb-comment"> EN: For every single page, the system generates the corresponding edition. Data_structure template is in html_builder/evt_builder-callhtml.xsl </span>--&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;!--<span class="xmlverb-comment"> IT: Per ogni pagina, genera le corrispettive edizioni. Il template data_structure si trova in html_build/evt_builder-callhtml.xsl </span>--&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e240">for-each</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$edition_array</span>"&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e242">if</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">.!=''</span>"&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e244">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">edition_current</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">lower-case(.)</span>" /&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e246">result-document</a></span> <span class="xmlverb-attr-name">method</span>="<span class="xmlverb-attr-content">html</span>" <span class="xmlverb-attr-name">encoding</span>="<span class="xmlverb-attr-content">UTF-8</span>" <span class="xmlverb-attr-name">media-type</span>="<span class="xmlverb-attr-content">text/plain</span>" <span class="xmlverb-attr-name">byte-order-mark</span>="<span class="xmlverb-attr-content">yes</span>" <span class="xmlverb-attr-name">href</span>="<span class="xmlverb-attr-content">{$filePrefix}/data/output_data/{$edition_current}/page_{$pb_n}_{$edition_current}.html</span>" <span class="xmlverb-attr-name">indent</span>="<span class="xmlverb-attr-content">yes</span>"&gt;<span class="xmlverb-text"><br></br>
                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e248">call-template</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">data_structure</span>"&gt;<span class="xmlverb-text"><br></br>
                                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e250">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">output</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$edition_current</span>" /&gt;<span class="xmlverb-text"><br></br>
                                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e252">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">pb_n</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$pb_n</span>" /&gt;<span class="xmlverb-text"><br></br>
                                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e254">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">edition_pos</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">position()</span>" /&gt;<span class="xmlverb-text"><br></br>
                                        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">call-template</span>&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">result-document</span>&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">if</span>&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">for-each</span>&gt;<span class="xmlverb-text"><br></br>
    </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">template</span>&gt;<span class="xmlverb-text"><br></br>
        <br></br>
        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e261">template</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">edition_level</span>"&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e263">param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">pb_n</span>" /&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e265">param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">edition_pos</span>" /&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e267">if</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">$edition_pos=1</span>"&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e269">choose</a></span>&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;!--<span class="xmlverb-comment"> CDP:embedded </span>--&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;!--<span class="xmlverb-comment"> Se il file e' codificato in Embedded Transcription e almeno un elemento &lt;zone&gt; presenta le coordinate spaziali <br></br>
                                        viene attivata la trasformazione per il collegamento testo immagine </span>--&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e275">when</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">($root//tei:sourceDoc)and(current-group()/tei:zone[@lrx][@lry][@ulx][@uly])</span>"&gt;<span class="xmlverb-text"><br></br>
                                        </span>&lt;!--<span class="xmlverb-comment">&lt;xsl:copy-of select="current-group()"/&gt; </span>--&gt;&lt;!--<span class="xmlverb-comment"> &lt;-use this to find split errors </span>--&gt;<span class="xmlverb-text"><br></br>
                                        </span>&lt;!--<span class="xmlverb-comment">&lt;xsl:variable name="text"&gt;&lt;xsl:apply-templates select="current-group()" mode="dipl"/&gt;&lt;/xsl:variable&gt;</span>--&gt;<span class="xmlverb-text"><br></br>
                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e282">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">text</span>"&gt;&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e283">apply-templates</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">current-group()</span>" <span class="xmlverb-attr-name">mode</span>="<span class="xmlverb-attr-content">ITLembedded</span>"&gt;<span class="xmlverb-text"><br></br>
                                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e285">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">edition_level</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$ed_name1</span>" /&gt;<span class="xmlverb-text"><br></br>
                                        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">apply-templates</span>&gt;&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">variable</span>&gt;<span class="xmlverb-text"><br></br>
                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e288">apply-templates</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$text</span>" <span class="xmlverb-attr-name">mode</span>="<span class="xmlverb-attr-content">dipl</span>" /&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">when</span>&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;!--<span class="xmlverb-comment"> IT: Se c'è il surface viene creato un albero temporaneo che corrisponde al gruppo corrente trasformato in base al livello di edizione;<br></br>
                                                                                 a questo viene applicato il template per il collegamento testo-immagine</span>--&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e293">when</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">$root//tei:facsimile/tei:surface[translate(@corresp, '#', '')=replace($pb_n, '-front', '')]//tei:zone[@rendition='Line']</span>"&gt;<span class="xmlverb-text"><br></br>
                                        </span>&lt;!--<span class="xmlverb-comment">&lt;xsl:copy-of select="current-group()"/&gt;</span>--&gt;<span class="xmlverb-text"> </span>&lt;!--<span class="xmlverb-comment"> &lt;-use this to find split errors </span>--&gt;<span class="xmlverb-text"><br></br>
                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e299">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">text</span>"&gt;&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e300">apply-templates</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">current-group()</span>" <span class="xmlverb-attr-name">mode</span>="<span class="xmlverb-attr-content">dipl</span>" /&gt;&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">variable</span>&gt;<span class="xmlverb-text"><br></br>
                                        </span>&lt;!--<span class="xmlverb-comment"> IT: aggiungi elementi div per linee di testo </span>--&gt;<span class="xmlverb-text"><br></br>
                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e304">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">text2</span>"&gt;<span class="xmlverb-text"><br></br>
                                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e306">call-template</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">divCb</span>"&gt;<span class="xmlverb-text"><br></br>
                                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e308">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">text</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$text</span>" /&gt;<span class="xmlverb-text"><br></br>
                                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e310">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">ed_name</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$ed_name1</span>" /&gt;<span class="xmlverb-text"><br></br>
                                                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">call-template</span>&gt;<span class="xmlverb-text"><br></br>
                                        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">variable</span>&gt;<span class="xmlverb-text"><br></br>
                                        <br></br>
                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e315">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">text3</span>"&gt;<span class="xmlverb-text"><br></br>
                                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e317">call-template</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">divLine</span>"&gt;<span class="xmlverb-text"><br></br>
                                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e319">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">text</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$text2</span>" /&gt;<span class="xmlverb-text"><br></br>
                                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e321">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">ed_name</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$ed_name1</span>" /&gt;<span class="xmlverb-text"><br></br>
                                                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">call-template</span>&gt;<span class="xmlverb-text"><br></br>
                                        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">variable</span>&gt;<span class="xmlverb-text"><br></br>
                                        </span>&lt;!--<span class="xmlverb-comment"> IT: trasforma el per ITL e HS</span>--&gt;<span class="xmlverb-text"><br></br>
                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e327">apply-templates</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$text3</span>" <span class="xmlverb-attr-name">mode</span>="<span class="xmlverb-attr-content">ITL</span>" /&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">when</span>&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;!--<span class="xmlverb-comment"> EN: If the surface element is not present only the diplomatic edition templates are applied </span>--&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;!--<span class="xmlverb-comment"> IT: Se non c'è il surface devo applicare direttamente i templates per l'edizione diplomatica </span>--&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e335">otherwise</a></span>&gt;<span class="xmlverb-text"><br></br>
                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e337">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">text</span>"&gt;<span class="xmlverb-text"><br></br>
                                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e339">apply-templates</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">current-group()</span>" <span class="xmlverb-attr-name">mode</span>="<span class="xmlverb-attr-content">dipl</span>" /&gt;&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">variable</span>&gt;<span class="xmlverb-text"><br></br>
                                        </span>&lt;!--<span class="xmlverb-comment"> IT: aggiungi elementi div per linee di testo </span>--&gt;<span class="xmlverb-text"><br></br>
                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e343">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">text2</span>"&gt;<span class="xmlverb-text"><br></br>
                                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e345">call-template</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">divCb</span>"&gt;<span class="xmlverb-text"><br></br>
                                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e347">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">text</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$text</span>" /&gt;<span class="xmlverb-text"><br></br>
                                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e349">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">ed_name</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$ed_name1</span>" /&gt;<span class="xmlverb-text"><br></br>
                                                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">call-template</span>&gt;<span class="xmlverb-text"><br></br>
                                        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">variable</span>&gt;<span class="xmlverb-text"><br></br>
                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e353">call-template</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">divLine</span>"&gt;<span class="xmlverb-text"><br></br>
                                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e355">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">text</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$text2</span>" /&gt;<span class="xmlverb-text"><br></br>
                                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e357">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">ed_name</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$ed_name1</span>" /&gt;<span class="xmlverb-text"><br></br>
                                        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">call-template</span>&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">otherwise</span>&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">choose</span>&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">if</span>&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e363">if</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">$edition_pos=2</span>"&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e365">choose</a></span>&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;!--<span class="xmlverb-comment"> CDP:embedded </span>--&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;!--<span class="xmlverb-comment"> EN: If the text is encoded in Embedded Transcription and there is at least one &lt;one&gt; element with spatial coordinates<br></br>
                                                 the transformation for the image-text link will be activated </span>--&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;!--<span class="xmlverb-comment"> IT: Se il file e' codificato in Embedded Transcription e almeno un elemento &lt;zone&gt; presenta le coordinate spaziali <br></br>
                                                 viene attivata la trasformazione per il collegamento testo immagine </span>--&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e373">when</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">($root//tei:sourceDoc)and(current-group()/tei:zone[@lrx][@lry][@ulx][@uly])</span>"&gt;<span class="xmlverb-text"><br></br>
                                        </span>&lt;!--<span class="xmlverb-comment">&lt;xsl:copy-of select="current-group()"/&gt;</span>--&gt;<span class="xmlverb-text"> </span>&lt;!--<span class="xmlverb-comment"> &lt;-use this to find split errors </span>--&gt;<span class="xmlverb-text"><br></br>
                                        </span>&lt;!--<span class="xmlverb-comment">&lt;xsl:variable name="text"&gt;&lt;xsl:apply-templates select="current-group()" mode="interp"/&gt;&lt;/xsl:variable&gt;</span>--&gt;<span class="xmlverb-text"><br></br>
                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e381">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">text</span>"&gt;&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e382">apply-templates</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">current-group()</span>" <span class="xmlverb-attr-name">mode</span>="<span class="xmlverb-attr-content">ITLembedded</span>"&gt;<span class="xmlverb-text"><br></br>
                                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e384">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">edition_level</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$ed_name2</span>" /&gt;<span class="xmlverb-text"><br></br>
                                        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">apply-templates</span>&gt;&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">variable</span>&gt;<span class="xmlverb-text"><br></br>
                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e387">apply-templates</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$text</span>" <span class="xmlverb-attr-name">mode</span>="<span class="xmlverb-attr-content">interp</span>" /&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">when</span>&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;!--<span class="xmlverb-comment"> IT: Se c'è il surface viene creato un albero temporaneo che corrisponde al gruppo corrente trasformato in base al livello di edizione;<br></br>
                                                                                 a questo viene applicato il template per il collegamento testo-immagine</span>--&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e393">when</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">$root//tei:facsimile/tei:surface[translate(@corresp, '#', '')=replace($pb_n, '-front', '')]//tei:zone[@rendition='Line']</span>"&gt;<span class="xmlverb-text"><br></br>
                                        </span>&lt;!--<span class="xmlverb-comment">&lt;xsl:copy-of select="current-group()"/&gt;</span>--&gt;<span class="xmlverb-text"> </span>&lt;!--<span class="xmlverb-comment"> &lt;-use this to find split errors </span>--&gt;<span class="xmlverb-text"><br></br>
                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e399">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">text</span>"&gt;&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e400">apply-templates</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">current-group()</span>" <span class="xmlverb-attr-name">mode</span>="<span class="xmlverb-attr-content">interp</span>" /&gt;&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">variable</span>&gt;<span class="xmlverb-text"><br></br>
                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e402">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">text2</span>"&gt;<span class="xmlverb-text"><br></br>
                                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e404">call-template</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">divLine</span>"&gt;<span class="xmlverb-text"><br></br>
                                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e406">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">text</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$text</span>" /&gt;<span class="xmlverb-text"><br></br>
                                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e408">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">ed_name</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$ed_name2</span>" /&gt;<span class="xmlverb-text"><br></br>
                                                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">call-template</span>&gt;<span class="xmlverb-text"><br></br>
                                        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">variable</span>&gt;<span class="xmlverb-text"><br></br>
                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e412">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">text3</span>"&gt;<span class="xmlverb-text"><br></br>
                                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e414">call-template</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">divLine</span>"&gt;<span class="xmlverb-text"><br></br>
                                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e416">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">text</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$text2</span>" /&gt;<span class="xmlverb-text"><br></br>
                                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e418">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">ed_name</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$ed_name2</span>" /&gt;<span class="xmlverb-text"><br></br>
                                                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">call-template</span>&gt;<span class="xmlverb-text"><br></br>
                                        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">variable</span>&gt;<span class="xmlverb-text"><br></br>
                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e423">apply-templates</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$text3</span>" <span class="xmlverb-attr-name">mode</span>="<span class="xmlverb-attr-content">ITL</span>" /&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">when</span>&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;!--<span class="xmlverb-comment"> EN: If the surface element is not present only the diplomatic edition templates are applied </span>--&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;!--<span class="xmlverb-comment"> IT: Se non c'è il surface devo applicare direttamente i templates per l'edizione diplomatica</span>--&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e430">otherwise</a></span>&gt;<span class="xmlverb-text"><br></br>
                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e432">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">text</span>"&gt;<span class="xmlverb-text"><br></br>
                                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e434">apply-templates</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">current-group()</span>" <span class="xmlverb-attr-name">mode</span>="<span class="xmlverb-attr-content">interp</span>" /&gt;&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">variable</span>&gt;<span class="xmlverb-text"><br></br>
                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e436">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">text2</span>"&gt;<span class="xmlverb-text"><br></br>
                                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e438">call-template</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">divCb</span>"&gt;<span class="xmlverb-text"><br></br>
                                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e440">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">text</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$text</span>" /&gt;<span class="xmlverb-text"><br></br>
                                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e442">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">ed_name</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$ed_name2</span>" /&gt;<span class="xmlverb-text"><br></br>
                                                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">call-template</span>&gt;<span class="xmlverb-text"><br></br>
                                        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">variable</span>&gt;<span class="xmlverb-text"><br></br>
                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e446">call-template</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">divLine</span>"&gt;<span class="xmlverb-text"><br></br>
                                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e448">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">text</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$text2</span>" /&gt;<span class="xmlverb-text"><br></br>
                                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e450">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">ed_name</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$ed_name2</span>" /&gt;<span class="xmlverb-text"><br></br>
                                        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">call-template</span>&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">otherwise</span>&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">choose</span>&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">if</span>&gt;<span class="xmlverb-text"><br></br>
                <br></br>
        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">template</span>&gt;<span class="xmlverb-text"><br></br>
        <br></br>
        </span>&lt;!--<span class="xmlverb-comment"> HEADER INFO </span>--&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e459">template</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">headerInfo</span>"&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e461">result-document</a></span> <span class="xmlverb-attr-name">method</span>="<span class="xmlverb-attr-content">html</span>" <span class="xmlverb-attr-name">encoding</span>="<span class="xmlverb-attr-content">UTF-8</span>" <span class="xmlverb-attr-name">media-type</span>="<span class="xmlverb-attr-content">text/plain</span>" <span class="xmlverb-attr-name">byte-order-mark</span>="<span class="xmlverb-attr-content">yes</span>" <span class="xmlverb-attr-name">href</span>="<span class="xmlverb-attr-content">{$filePrefix}/data/output_data/prefatory_matter/header_info.html</span>" <span class="xmlverb-attr-name">indent</span>="<span class="xmlverb-attr-content">yes</span>"&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e463">call-template</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">headerInfo_generation</span>" /&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">result-document</span>&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">template</span>&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;!--<span class="xmlverb-comment"> MS DESCRIPTION </span>--&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e470">template</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">msDesc</span>"&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e472">result-document</a></span> <span class="xmlverb-attr-name">method</span>="<span class="xmlverb-attr-content">html</span>" <span class="xmlverb-attr-name">encoding</span>="<span class="xmlverb-attr-content">UTF-8</span>" <span class="xmlverb-attr-name">media-type</span>="<span class="xmlverb-attr-content">text/plain</span>" <span class="xmlverb-attr-name">byte-order-mark</span>="<span class="xmlverb-attr-content">yes</span>" <span class="xmlverb-attr-name">href</span>="<span class="xmlverb-attr-content">{$filePrefix}/data/output_data/prefatory_matter/ms_desc.html</span>" <span class="xmlverb-attr-name">indent</span>="<span class="xmlverb-attr-content">yes</span>"&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e474">call-template</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">msDesc_generation</span>" /&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">result-document</span>&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">template</span>&gt;<span class="xmlverb-text"><br></br>
        <br></br>
        </span>&lt;!--<span class="xmlverb-comment"> FRONT </span>--&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e480">template</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">front</span>"&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e482">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">front</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">current()/tei:front</span>" /&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e484">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">doc_id</span>"&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e486">choose</a></span>&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e488">when</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">current()/@xml:id</span>"&gt;<span class="xmlverb-text"><br></br>
                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e490">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">current()/@xml:id</span>" /&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">when</span>&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e493">when</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">current()/tei:body/tei:div[@subtype='edition_text']/@xml:id</span>"&gt;<span class="xmlverb-text"><br></br>
                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e495">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">current()/tei:body/tei:div[@subtype='edition_text']/@xml:id</span>" /&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">when</span>&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e498">otherwise</a></span>&gt;<span class="xmlverb-text"><br></br>
                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e500">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">count(preceding-sibling::tei:text) + 1</span>" /&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">otherwise</span>&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">choose</span>&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">variable</span>&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e505">if</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">not($doc_id='')</span>"&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e507">result-document</a></span> <span class="xmlverb-attr-name">method</span>="<span class="xmlverb-attr-content">html</span>" <span class="xmlverb-attr-name">encoding</span>="<span class="xmlverb-attr-content">UTF-8</span>" <span class="xmlverb-attr-name">media-type</span>="<span class="xmlverb-attr-content">text/plain</span>" <span class="xmlverb-attr-name">byte-order-mark</span>="<span class="xmlverb-attr-content">yes</span>" <span class="xmlverb-attr-name">href</span>="<span class="xmlverb-attr-content">{$filePrefix}/data/output_data/prefatory_matter/front/front_doc_{$doc_id}.html</span>" <span class="xmlverb-attr-name">indent</span>="<span class="xmlverb-attr-content">yes</span>"&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e509">call-template</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">front_generation</span>"&gt;<span class="xmlverb-text"><br></br>
                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e511">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">front</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$front</span>" /&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">call-template</span>&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">result-document</span>&gt;<span class="xmlverb-text">        <br></br>
                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">if</span>&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">template</span>&gt;<span class="xmlverb-text"><br></br>
        <br></br>
        </span>&lt;!--<span class="xmlverb-comment"> REGESTO </span>--&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e519">template</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">regesto</span>"&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e521">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">doc_id</span>"&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e523">choose</a></span>&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e525">when</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">current()/@xml:id</span>"&gt;<span class="xmlverb-text"><br></br>
                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e527">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">current()/@xml:id</span>" /&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">when</span>&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e530">when</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">current()/tei:body/tei:div[@subtype='edition_text']/@xml:id</span>"&gt;<span class="xmlverb-text"><br></br>
                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e532">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">current()/tei:body/tei:div[@subtype='edition_text']/@xml:id</span>" /&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">when</span>&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e535">otherwise</a></span>&gt;<span class="xmlverb-text"><br></br>
                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e537">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">count(preceding-sibling::tei:text) + 1</span>" /&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">otherwise</span>&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">choose</span>&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">variable</span>&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e542">result-document</a></span> <span class="xmlverb-attr-name">method</span>="<span class="xmlverb-attr-content">html</span>" <span class="xmlverb-attr-name">encoding</span>="<span class="xmlverb-attr-content">UTF-8</span>" <span class="xmlverb-attr-name">media-type</span>="<span class="xmlverb-attr-content">text/plain</span>" <span class="xmlverb-attr-name">byte-order-mark</span>="<span class="xmlverb-attr-content">yes</span>" <span class="xmlverb-attr-name">href</span>="<span class="xmlverb-attr-content">{$filePrefix}/data/output_data/prefatory_matter/regesto/regesto_doc_{$doc_id}.html</span>" <span class="xmlverb-attr-name">indent</span>="<span class="xmlverb-attr-content">yes</span>"&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e544">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">front</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">current()/tei:front</span>" /&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e546">call-template</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">doc_regesto</span>"&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e548">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">doc_id</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$doc_id</span>" /&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e550">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">front</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$front</span>" /&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">call-template</span>&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">result-document</span>&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">template</span>&gt;<span class="xmlverb-text"><br></br>
        <br></br>
        </span>&lt;!--<span class="xmlverb-comment"> LIST PERSON </span>--&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e558">template</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">listPerson</span>"&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e560">element</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">ul</span>"&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e562">attribute</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">id</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">'ul_listPerson'</span>" /&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e564">attribute</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">class</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">'ul_list'</span>" /&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e566">for-each</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$root//tei:listPerson/person</span>"&gt;<span class="xmlverb-text"><br></br>
                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e568">element</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">li</span>"&gt;<span class="xmlverb-text"><br></br>
                                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e570">attribute</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">id</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">@xml:id</span>" /&gt;<span class="xmlverb-text"><br></br>
                                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e572">attribute</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">class</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">'list_element'</span>" /&gt;<span class="xmlverb-text"><br></br>
                                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e574">attribute</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">data-order-list</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">substring(tei:persName/tei:forename, 1, 1)</span>" /&gt;<span class="xmlverb-text"><br></br>
                                                        </span>&lt;!--<span class="xmlverb-comment">&lt;xsl:value-of select="substring(@xml:id, 1, 1)"/&gt;</span>--&gt;<span class="xmlverb-text"><br></br>
                                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e578">call-template</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">person</span>" /&gt;<span class="xmlverb-text"><br></br>
                                        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">element</span>&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">for-each</span>&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">element</span>&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">template</span>&gt;<span class="xmlverb-text"><br></br>
        <br></br>
        </span>&lt;!--<span class="xmlverb-comment"> LIST PLACE </span>--&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e586">template</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">listPlace</span>"&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e588">element</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">ul</span>"&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e590">attribute</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">id</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">'ul_listPlace'</span>" /&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e592">attribute</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">class</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">'ul_list'</span>" /&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e594">for-each</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$root//tei:listPlace/place</span>"&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e596">element</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">li</span>"&gt;<span class="xmlverb-text"><br></br>
                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e598">attribute</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">id</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">@xml:id</span>" /&gt;<span class="xmlverb-text"><br></br>
                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e600">attribute</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">class</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">'list_element'</span>" /&gt;<span class="xmlverb-text"><br></br>
                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e602">attribute</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">data-order-list</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">substring(tei:settlement, 1, 1)</span>" /&gt;<span class="xmlverb-text"><br></br>
                                                </span>&lt;!--<span class="xmlverb-comment">&lt;xsl:value-of select="substring(@xml:id, 1, 1)"/&gt;</span>--&gt;<span class="xmlverb-text"><br></br>
                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e606">call-template</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">place</span>" /&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">element</span>&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">for-each</span>&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">element</span>&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">template</span>&gt;<span class="xmlverb-text"><br></br>
        <br></br>
        </span>&lt;!--<span class="xmlverb-comment"> LIST ORG </span>--&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e614">template</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">listOrg</span>"&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e616">element</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">ul</span>"&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e618">attribute</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">id</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">'ul_listOrg'</span>" /&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e620">attribute</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">class</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">'ul_list'</span>" /&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e622">for-each</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$root//tei:listOrg/org</span>"&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e624">element</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">li</span>"&gt;<span class="xmlverb-text"><br></br>
                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e626">attribute</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">id</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">@xml:id</span>" /&gt;<span class="xmlverb-text"><br></br>
                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e628">attribute</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">class</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">'list_element'</span>" /&gt;<span class="xmlverb-text"><br></br>
                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e630">attribute</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">data-order-list</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">substring(@xml:id, 1, 1)</span>" /&gt;<span class="xmlverb-text"><br></br>
                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e632">call-template</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">org</span>" /&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">element</span>&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">for-each</span>&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">element</span>&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">template</span>&gt;<span class="xmlverb-text"><br></br>
        <br></br>
        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e638">template</a></span> <span class="xmlverb-attr-name">match</span>="<span class="xmlverb-attr-content">text()</span>" <span class="xmlverb-attr-name">mode</span>="<span class="xmlverb-attr-content">deleteSpaces</span>"&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e640">choose</a></span>&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e642">when</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">ancestor::*[@xml:space][1]/@xml:space='preserve'</span>"&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e644">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">.</span>" /&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">when</span>&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e647">otherwise</a></span>&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;!--<span class="xmlverb-comment"> Retain one leading space if node isn't first, has non-space content, and has leading space.</span>--&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e651">if</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">position()!=1 and matches(.,'^\s') and normalize-space()!=''</span>"&gt;<span class="xmlverb-text"><br></br>
                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e653">text</a></span>&gt;<span class="xmlverb-text"> </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">text</span>&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">if</span>&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e657">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">normalize-space(.)</span>" /&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e659">choose</a></span>&gt;<span class="xmlverb-text"><br></br>
                                        </span>&lt;!--<span class="xmlverb-comment"> node is an only child, and has content but it's all space </span>--&gt;<span class="xmlverb-text"><br></br>
                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e663">when</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">last()=1 and string-length()!=0 and normalize-space()=''</span>"&gt;<span class="xmlverb-text"><br></br>
                                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e665">text</a></span>&gt;<span class="xmlverb-text"> </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">text</span>&gt;<span class="xmlverb-text"><br></br>
                                        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">when</span>&gt;<span class="xmlverb-text"><br></br>
                                        </span>&lt;!--<span class="xmlverb-comment"> node isn't last, isn't first, and has trailing space </span>--&gt;<span class="xmlverb-text"><br></br>
                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e671">when</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">position()!=1 and position()!=last() and matches(.,'\s$')</span>"&gt;<span class="xmlverb-text"><br></br>
                                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e673">text</a></span>&gt;<span class="xmlverb-text"> </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">text</span>&gt;<span class="xmlverb-text"><br></br>
                                        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">when</span>&gt;<span class="xmlverb-text"><br></br>
                                        </span>&lt;!--<span class="xmlverb-comment"> node isn't last, is first, has trailing space, and has non-space content   </span>--&gt;<span class="xmlverb-text"><br></br>
                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e680">when</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">position()=1 and matches(.,'\s$') and normalize-space()!=''</span>"&gt;<span class="xmlverb-text"><br></br>
                                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e682">text</a></span>&gt;<span class="xmlverb-text"> </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">text</span>&gt;<span class="xmlverb-text"><br></br>
                                        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">when</span>&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">choose</span>&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">otherwise</span>&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">choose</span>&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">template</span>&gt;<span class="xmlverb-text"><br></br>
        <br></br>
        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e691">template</a></span> <span class="xmlverb-attr-name">match</span>="<span class="xmlverb-attr-content">@*|node()</span>" <span class="xmlverb-attr-name">mode</span>="<span class="xmlverb-attr-content">delete_el1</span>"&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e693">copy</a></span>&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e695">apply-templates</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">@*|node()</span>" <span class="xmlverb-attr-name">mode</span>="<span class="xmlverb-attr-content">#current</span>" /&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">copy</span>&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">template</span>&gt;<span class="xmlverb-text"><br></br>
        <br></br>
        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e699">template</a></span> <span class="xmlverb-attr-name">match</span>="<span class="xmlverb-attr-content">node()[name()='span'][@class='dipl-choice_popup']/node()[name()='span'][@class='dipl-reg']</span>" <span class="xmlverb-attr-name">mode</span>="<span class="xmlverb-attr-content">delete_el1</span>"&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;!--<span class="xmlverb-comment"> DO NOTHING </span>--&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">template</span>&gt;<span class="xmlverb-text"><br></br>
        <br></br>
        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e704">template</a></span> <span class="xmlverb-attr-name">match</span>="<span class="xmlverb-attr-content">node()[name()='div'][@class='dipl-zone']</span>" <span class="xmlverb-attr-name">mode</span>="<span class="xmlverb-attr-content">delete_el1</span>"&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;!--<span class="xmlverb-comment"> DO NOTHING </span>--&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">template</span>&gt;<span class="xmlverb-text"><br></br>
        <br></br>
        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e709">template</a></span> <span class="xmlverb-attr-name">match</span>="<span class="xmlverb-attr-content">node()[name()='div'][@class='dipl-attachment']</span>" <span class="xmlverb-attr-name">mode</span>="<span class="xmlverb-attr-content">delete_el1</span>"&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;!--<span class="xmlverb-comment"> DO NOTHING </span>--&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">template</span>&gt;<span class="xmlverb-text"><br></br>
        <br></br>
        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e714">template</a></span> <span class="xmlverb-attr-name">match</span>="<span class="xmlverb-attr-content">@*|node()</span>" <span class="xmlverb-attr-name">mode</span>="<span class="xmlverb-attr-content">delete_el2</span>"&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e716">copy</a></span>&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e718">apply-templates</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">@*|node()</span>" <span class="xmlverb-attr-name">mode</span>="<span class="xmlverb-attr-content">#current</span>" /&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">copy</span>&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">template</span>&gt;<span class="xmlverb-text"><br></br>
        <br></br>
        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e722">template</a></span> <span class="xmlverb-attr-name">match</span>="<span class="xmlverb-attr-content">node()[name()='span'][@class='interp-choice_popup']/node()[name()='span'][@class='interp-orig']|node()[name()='span'][@class='interp-corr']</span>" <span class="xmlverb-attr-name">mode</span>="<span class="xmlverb-attr-content">delete_el2</span>"&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;!--<span class="xmlverb-comment"> DO NOTHING </span>--&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">template</span>&gt;<span class="xmlverb-text"><br></br>
        <br></br>
        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e728">template</a></span> <span class="xmlverb-attr-name">match</span>="<span class="xmlverb-attr-content">node()[name()='div'][@class='interp-zone']</span>" <span class="xmlverb-attr-name">mode</span>="<span class="xmlverb-attr-content">delete_el2</span>"&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;!--<span class="xmlverb-comment"> DO NOTHING </span>--&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">template</span>&gt;<span class="xmlverb-text"><br></br>
        <br></br>
        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e733">template</a></span> <span class="xmlverb-attr-name">match</span>="<span class="xmlverb-attr-content">node()[name()='div'][@class='interp-attachment']</span>" <span class="xmlverb-attr-name">mode</span>="<span class="xmlverb-attr-content">delete_el2</span>"&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;!--<span class="xmlverb-comment"> DO NOTHING </span>--&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">template</span>&gt;<span class="xmlverb-text"><br></br>
        <br></br>
        <br></br>
        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e738">template</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">search_file</span>"&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e740">if</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">$edition_array[1]!=''</span>"&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e742">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">edition_current</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">lower-case($edition_array[1])</span>" /&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e744">result-document</a></span> <span class="xmlverb-attr-name">method</span>="<span class="xmlverb-attr-content">text</span>" <span class="xmlverb-attr-name">href</span>="<span class="xmlverb-attr-content">{$filePrefix}/data/output_data/{$edition_current}/{$edition_current}.json</span>" <span class="xmlverb-attr-name">indent</span>="<span class="xmlverb-attr-content">no</span>"&gt;<span class="xmlverb-text"><br></br>
                                {"pages": [<br></br>
                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e746">for-each-group</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">//node()[name()=$ed_content]/descendant-or-self::node()[name()=$start_split]/node()</span>" <span class="xmlverb-attr-name">group-starting-with</span>="<span class="xmlverb-attr-content">//tei:pb</span>"&gt;<span class="xmlverb-text"><br></br>
                                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e748">choose</a></span>&gt;<span class="xmlverb-text"><br></br>
                                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e750">when</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">current-group()/(descendant-or-self::lb)</span>"&gt;<span class="xmlverb-text"><br></br>
                                                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e752">for-each-group</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">current-group()[not(self::pb)]</span>" <span class="xmlverb-attr-name">group-starting-with</span>="<span class="xmlverb-attr-content">tei:lb</span>"&gt;<span class="xmlverb-text"><br></br>
                                                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e754">if</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">current-group()[not((string-length(normalize-space()))= 0)]</span>"&gt;<span class="xmlverb-text"><br></br>
                                                                                </span>&lt;!--<span class="xmlverb-comment"> TEXTUAL CONTENT </span>--&gt;<span class="xmlverb-text"><br></br>
                                                                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e758">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">current_text</span>"&gt;<span class="xmlverb-text"><br></br>
                                                                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e760">apply-templates</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">current-group()[not(self::tei:lb)]</span>" <span class="xmlverb-attr-name">mode</span>="<span class="xmlverb-attr-content">dipl</span>" /&gt;<span class="xmlverb-text"><br></br>
                                                                                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">variable</span>&gt;<span class="xmlverb-text"><br></br>
                                                                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e763">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">current_text1</span>"&gt;<span class="xmlverb-text"><br></br>
                                                                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e765">apply-templates</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$current_text</span>" <span class="xmlverb-attr-name">mode</span>="<span class="xmlverb-attr-content">delete_el1</span>" /&gt;<span class="xmlverb-text"><br></br>
                                                                                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">variable</span>&gt;<span class="xmlverb-text"><br></br>
                                                                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e768">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">current_text2</span>"&gt;<span class="xmlverb-text"><br></br>
                                                                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e770">apply-templates</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$current_text1//text()[not(ancestor::span)]</span>" <span class="xmlverb-attr-name">mode</span>="<span class="xmlverb-attr-content">deleteSpaces</span>" /&gt;<span class="xmlverb-text"><br></br>
                                                                                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">variable</span>&gt;<span class="xmlverb-text"><br></br>
                                                                                { <br></br>
                                                                                        "line" : "</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e773">call-template</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">line_refs4search</span>" /&gt;<span class="xmlverb-text">",<br></br>
                                                                                        "text" : "</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e776">copy-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">replace($current_text2, '(\\|/)', '$1$1')</span>" /&gt;<span class="xmlverb-text">",<br></br>
                                                                                        "tags" : "</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e778">call-template</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">doc_refs4search</span>" /&gt;<span class="xmlverb-text">",<br></br>
                                                                                        "loc" : "</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e780">call-template</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">page_refs4search</span>" /&gt;<span class="xmlverb-text">"<br></br>
                                                                                },<br></br>
                                                                        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">if</span>&gt;<span class="xmlverb-text"><br></br>
                                                                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">for-each-group</span>&gt;<span class="xmlverb-text"><br></br>
                                                        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">when</span>&gt;<span class="xmlverb-text"><br></br>
                                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e785">when</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">current-group()/(descendant-or-self::p)</span>"&gt;<span class="xmlverb-text"><br></br>
                                                                </span>&lt;!--<span class="xmlverb-comment">&lt;xsl:variable name="var"&gt;&lt;xsl:apply-templates select="current-group()[not(self::tei:pb)]" mode="interp"/&gt;&lt;/xsl:variable&gt;<br></br>
                                                                &lt;xsl:copy-of select="$var//text()"&gt;&lt;/xsl:copy-of&gt;</span>--&gt;<span class="xmlverb-text"><br></br>
                                                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e789">for-each-group</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">current-group()/descendant::p</span>" <span class="xmlverb-attr-name">group-starting-with</span>="<span class="xmlverb-attr-content">//tei:p</span>"&gt;<span class="xmlverb-text"><br></br>
                                                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e791">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">current_text</span>"&gt;<span class="xmlverb-text"><br></br>
                                                                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e793">apply-templates</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">current-group()[not(self::tei:pb)]</span>" <span class="xmlverb-attr-name">mode</span>="<span class="xmlverb-attr-content">inter</span>" /&gt;<span class="xmlverb-text"><br></br>
                                                                        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">variable</span>&gt;<span class="xmlverb-text"><br></br>
                                                                        {<br></br>
                                                                        "line" : "</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e796">call-template</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">paragraph_refs4search</span>" /&gt;<span class="xmlverb-text">",<br></br>
                                                                        "text" : "</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e798">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">fn:normalize-space($current_text)</span>" /&gt;<span class="xmlverb-text">",<br></br>
                                                                        "tags" : "</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e800">call-template</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">doc_refs4search</span>" /&gt;<span class="xmlverb-text">",<br></br>
                                                                        "loc" : "</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e802">call-template</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">page_refs4search</span>" /&gt;<span class="xmlverb-text">"<br></br>
                                                                        },<br></br>
                                                                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">for-each-group</span>&gt;<span class="xmlverb-text"><br></br>
                                                        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">when</span>&gt;<span class="xmlverb-text"><br></br>
                                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e806">otherwise</a></span>&gt;<span class="xmlverb-text"><br></br>
                                                                </span>&lt;!--<span class="xmlverb-comment"> TEXTUAL CONTENT </span>--&gt;<span class="xmlverb-text"><br></br>
                                                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e810">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">current_text</span>"&gt;<span class="xmlverb-text"><br></br>
                                                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e812">apply-templates</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">current-group()[not(self::tei:pb)]</span>" <span class="xmlverb-attr-name">mode</span>="<span class="xmlverb-attr-content">dipl</span>" /&gt;<span class="xmlverb-text"><br></br>
                                                                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">variable</span>&gt;<span class="xmlverb-text"><br></br>
                                                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e815">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">current_text1</span>"&gt;<span class="xmlverb-text"><br></br>
                                                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e817">apply-templates</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$current_text</span>" <span class="xmlverb-attr-name">mode</span>="<span class="xmlverb-attr-content">delete_el1</span>" /&gt;<span class="xmlverb-text"><br></br>
                                                                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">variable</span>&gt;<span class="xmlverb-text"><br></br>
                                                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e820">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">current_text2</span>"&gt;<span class="xmlverb-text"><br></br>
                                                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e822">apply-templates</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$current_text1//text()[not(ancestor::span)]</span>" <span class="xmlverb-attr-name">mode</span>="<span class="xmlverb-attr-content">deleteSpaces</span>" /&gt;<span class="xmlverb-text"><br></br>
                                                                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">variable</span>&gt;<span class="xmlverb-text"><br></br>
                                                                { <br></br>
                                                                        "line" : "</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e825">call-template</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">line_refs4search</span>" /&gt;<span class="xmlverb-text">",<br></br>
                                                                        "text" : "</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e828">copy-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">replace($current_text2, '(\\|/)', '$1$1')</span>" /&gt;<span class="xmlverb-text">",<br></br>
                                                                        "tags" : "</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e830">call-template</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">doc_refs4search</span>" /&gt;<span class="xmlverb-text">",<br></br>
                                                                        "loc" : "</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e832">call-template</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">page_refs4search</span>" /&gt;<span class="xmlverb-text">"<br></br>
                                                                },<br></br>
                                                        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">otherwise</span>&gt;<span class="xmlverb-text"><br></br>
                                                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">choose</span>&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">for-each-group</span>&gt;<span class="xmlverb-text"><br></br>
                                {<br></br>
                                        "line" : "",<br></br>
                                        "text" : "",<br></br>
                                        "tags" : "",<br></br>
                                        "loc" : ""<br></br>
                                }]}<br></br>
                        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">result-document</span>&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">if</span>&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e839">if</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">$edition_array[2]!=''</span>"&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e841">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">edition_current</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">lower-case($edition_array[2])</span>" /&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e843">result-document</a></span> <span class="xmlverb-attr-name">method</span>="<span class="xmlverb-attr-content">text</span>" <span class="xmlverb-attr-name">href</span>="<span class="xmlverb-attr-content">{$filePrefix}/data/output_data/{$edition_current}/{$edition_current}.json</span>" <span class="xmlverb-attr-name">indent</span>="<span class="xmlverb-attr-content">no</span>"&gt;<span class="xmlverb-text"><br></br>
                                {"pages": [<br></br>
                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e845">for-each-group</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">//node()[name()=$ed_content]/descendant-or-self::node()[name()=$start_split]/node()</span>" <span class="xmlverb-attr-name">group-starting-with</span>="<span class="xmlverb-attr-content">//tei:pb</span>"&gt;<span class="xmlverb-text"><br></br>
                                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e847">choose</a></span>&gt;<span class="xmlverb-text"><br></br>
                                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e849">when</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">current-group()/(descendant-or-self::lb)</span>"&gt;<span class="xmlverb-text"><br></br>
                                                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e851">for-each-group</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">current-group()[not(self::pb)]</span>" <span class="xmlverb-attr-name">group-starting-with</span>="<span class="xmlverb-attr-content">tei:lb</span>"&gt;<span class="xmlverb-text"><br></br>
                                                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e853">if</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">current-group()[not((string-length(normalize-space()))= 0)]</span>"&gt;<span class="xmlverb-text"><br></br>
                                                                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e855">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">current_text</span>"&gt;<span class="xmlverb-text"><br></br>
                                                                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e857">apply-templates</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">current-group()[not(self::tei:lb)]</span>" <span class="xmlverb-attr-name">mode</span>="<span class="xmlverb-attr-content">interp</span>" /&gt;<span class="xmlverb-text"><br></br>
                                                                                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">variable</span>&gt;<span class="xmlverb-text"><br></br>
                                                                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e860">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">current_text1</span>"&gt;<span class="xmlverb-text"><br></br>
                                                                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e862">apply-templates</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$current_text</span>" <span class="xmlverb-attr-name">mode</span>="<span class="xmlverb-attr-content">delete_el2</span>" /&gt;<span class="xmlverb-text"><br></br>
                                                                                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">variable</span>&gt;<span class="xmlverb-text"><br></br>
                                                                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e865">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">current_text2</span>"&gt;<span class="xmlverb-text"><br></br>
                                                                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e867">apply-templates</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$current_text1//text()[not(ancestor::span)]</span>" <span class="xmlverb-attr-name">mode</span>="<span class="xmlverb-attr-content">deleteSpaces</span>" /&gt;<span class="xmlverb-text"><br></br>
                                                                                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">variable</span>&gt;<span class="xmlverb-text"><br></br>
                                                                                { <br></br>
                                                                                        "line" : "</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e870">call-template</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">line_refs4search</span>" /&gt;<span class="xmlverb-text">",<br></br>
                                                                                        "text" : "</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e872">copy-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">replace($current_text2, '(\\|/)', '$1$1')</span>" /&gt;<span class="xmlverb-text">",<br></br>
                                                                                        "tags" : "</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e875">call-template</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">doc_refs4search</span>" /&gt;<span class="xmlverb-text">",<br></br>
                                                                                        "loc" : "</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e877">call-template</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">page_refs4search</span>" /&gt;<span class="xmlverb-text">"<br></br>
                                                                                },<br></br>
                                                                        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">if</span>&gt;<span class="xmlverb-text"><br></br>
                                                                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">for-each-group</span>&gt;<span class="xmlverb-text"><br></br>
                                                        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">when</span>&gt;<span class="xmlverb-text"><br></br>
                                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e882">when</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">current-group()/(descendant-or-self::p)</span>"&gt;<span class="xmlverb-text"><br></br>
                                                                </span>&lt;!--<span class="xmlverb-comment">&lt;xsl:variable name="var"&gt;&lt;xsl:apply-templates select="current-group()[not(self::tei:pb)]" mode="interp"/&gt;&lt;/xsl:variable&gt;<br></br>
                                                                &lt;xsl:copy-of select="$var//text()"&gt;&lt;/xsl:copy-of&gt;</span>--&gt;<span class="xmlverb-text"><br></br>
                                                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e886">for-each-group</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">current-group()/descendant::p</span>" <span class="xmlverb-attr-name">group-starting-with</span>="<span class="xmlverb-attr-content">//tei:p</span>"&gt;<span class="xmlverb-text"><br></br>
                                                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e888">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">current_text</span>"&gt;<span class="xmlverb-text"><br></br>
                                                                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e890">apply-templates</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">current-group()[not(self::tei:pb)]</span>" <span class="xmlverb-attr-name">mode</span>="<span class="xmlverb-attr-content">dipl</span>" /&gt;<span class="xmlverb-text"><br></br>
                                                                        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">variable</span>&gt;<span class="xmlverb-text"><br></br>
                                                                        {<br></br>
                                                                        "line" : "</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e893">call-template</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">paragraph_refs4search</span>" /&gt;<span class="xmlverb-text">",<br></br>
                                                                        "text" : "</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e895">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">fn:normalize-space($current_text)</span>" /&gt;<span class="xmlverb-text">",<br></br>
                                                                        "tags" : "</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e897">call-template</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">doc_refs4search</span>" /&gt;<span class="xmlverb-text">",<br></br>
                                                                        "loc" : "</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e899">call-template</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">page_refs4search</span>" /&gt;<span class="xmlverb-text">"<br></br>
                                                                        },<br></br>
                                                                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">for-each-group</span>&gt;<span class="xmlverb-text"><br></br>
                                                        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">when</span>&gt;<span class="xmlverb-text"><br></br>
                                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e903">otherwise</a></span>&gt;<span class="xmlverb-text"><br></br>
                                                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e905">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">current_text</span>"&gt;<span class="xmlverb-text"><br></br>
                                                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e907">apply-templates</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">current-group()[not(self::tei:pb)]</span>" <span class="xmlverb-attr-name">mode</span>="<span class="xmlverb-attr-content">interp</span>" /&gt;<span class="xmlverb-text"><br></br>
                                                                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">variable</span>&gt;<span class="xmlverb-text"><br></br>
                                                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e910">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">current_text1</span>"&gt;<span class="xmlverb-text"><br></br>
                                                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e912">apply-templates</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$current_text</span>" <span class="xmlverb-attr-name">mode</span>="<span class="xmlverb-attr-content">delete_el2</span>" /&gt;<span class="xmlverb-text"><br></br>
                                                                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">variable</span>&gt;<span class="xmlverb-text"><br></br>
                                                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e915">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">current_text2</span>"&gt;<span class="xmlverb-text"><br></br>
                                                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e917">apply-templates</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$current_text1//text()[not(ancestor::span)]</span>" <span class="xmlverb-attr-name">mode</span>="<span class="xmlverb-attr-content">deleteSpaces</span>" /&gt;<span class="xmlverb-text"><br></br>
                                                                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">variable</span>&gt;<span class="xmlverb-text"><br></br>
                                                                {<br></br>
                                                                "line" : "</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e920">call-template</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">paragraph_refs4search</span>" /&gt;<span class="xmlverb-text">",<br></br>
                                                                "text" : "</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e922">copy-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">replace($current_text2, '(\\|/)', '$1$1')</span>" /&gt;<span class="xmlverb-text">",<br></br>
                                                                "tags" : "</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e925">call-template</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">doc_refs4search</span>" /&gt;<span class="xmlverb-text">",<br></br>
                                                                "loc" : "</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e927">call-template</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">page_refs4search</span>" /&gt;<span class="xmlverb-text">"<br></br>
                                                                },<br></br>
                                                        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">otherwise</span>&gt;<span class="xmlverb-text"><br></br>
                                                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">choose</span>&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">for-each-group</span>&gt;<span class="xmlverb-text"><br></br>
                                {<br></br>
                                "line" : "",<br></br>
                                "text" : "",<br></br>
                                "tags" : "",<br></br>
                                "loc" : ""<br></br>
                                }]}<br></br>
                        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">result-document</span>&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">if</span>&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">template</span>&gt;<span class="xmlverb-text"><br></br>
        <br></br>
        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e935">template</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">doc_refs4search</span>"&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e937">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">doc_id</span>"&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e939">choose</a></span>&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e941">when</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">current-group()/ancestor-or-self::tei:text[1]/@xml:id</span>"&gt;<span class="xmlverb-text"><br></br>
                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e943">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">current-group()/ancestor-or-self::tei:text[1]/@xml:id</span>" /&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">when</span>&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e946">when</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">current-group()/ancestor-or-self::tei:body[1]/tei:div[@subtype='edition_text'][1]/@xml:id</span>"&gt;<span class="xmlverb-text"><br></br>
                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e948">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">current-group()/ancestor-or-self::tei:body[1]/tei:div[@subtype='edition_text'][1]/@xml:id</span>" /&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">when</span>&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e951">otherwise</a></span>&gt;<span class="xmlverb-text"><br></br>
                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e953">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">concat('text_',current-group()/ancestor-or-self::tei:text[1]/position())</span>" /&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">otherwise</span>&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">choose</span>&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">variable</span>&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e958">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">doc_label</span>"&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e960">choose</a></span>&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e962">when</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">current-group()/ancestor-or-self::tei:text[1]/@n</span>"&gt;<span class="xmlverb-text"><br></br>
                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e964">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">current-group()/ancestor-or-self::tei:text[1]/@n</span>" /&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">when</span>&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e967">when</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">current-group()/ancestor-or-self::tei:body[1]/tei:div[@subtype='edition_text'][1]/@n</span>"&gt;<span class="xmlverb-text"><br></br>
                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e969">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">current-group()/ancestor-or-self::tei:body[1]/tei:div[@subtype='edition_text'][1]/@n</span>" /&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">when</span>&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e972">otherwise</a></span>&gt;<span class="xmlverb-text"><br></br>
                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e974">call-template</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">generateTextLabel</span>"&gt;<span class="xmlverb-text"><br></br>
                                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e976">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">text_id</span>"&gt;<span class="xmlverb-text"><br></br>
                                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e978">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$doc_id</span>" /&gt;<span class="xmlverb-text"><br></br>
                                                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">with-param</span>&gt;<span class="xmlverb-text"><br></br>
                                        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">call-template</span>&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">otherwise</span>&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">choose</span>&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">variable</span>&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e985">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$doc_id</span>" /&gt;<span class="xmlverb-text">|</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e987">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$doc_label</span>" /&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">template</span>&gt;<span class="xmlverb-text"><br></br>
        <br></br>
        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e990">template</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">page_refs4search</span>"&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e992">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">page_id</span>"&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e994">choose</a></span>&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e996">when</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">preceding::pb[1]/@xml:id</span>"&gt;<span class="xmlverb-text"><br></br>
                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e998">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">preceding::pb[1]/@xml:id</span>" /&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">when</span>&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1001">otherwise</a></span>&gt;<span class="xmlverb-text">no_page_info</span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">otherwise</span>&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">choose</span>&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">variable</span>&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1006">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">page_label</span>"&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1008">choose</a></span>&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1010">when</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">preceding::pb[1]/@n</span>"&gt;<span class="xmlverb-text"><br></br>
                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1012">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">preceding::pb[1]/@n</span>" /&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">when</span>&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1015">when</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">preceding::pb[1]/@xml:id</span>"&gt;<span class="xmlverb-text"><br></br>
                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1017">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">preceding::pb[1]/@xml:id</span>" /&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">when</span>&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1020">otherwise</a></span>&gt;<span class="xmlverb-text">no_page_info</span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">otherwise</span>&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">choose</span>&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">variable</span>&gt;<span class="xmlverb-text"><br></br>
                <br></br>
                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1025">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$page_id</span>" /&gt;<span class="xmlverb-text">|</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1027">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$page_label</span>" /&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">template</span>&gt;<span class="xmlverb-text"><br></br>
        <br></br>
        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1030">template</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">line_refs4search</span>"&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1032">choose</a></span>&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1034">when</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">self::tei:lb/@n</span>"&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1036">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">concat(self::tei:lb/@n, '|line ',self::tei:lb/@n)</span>" /&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">when</span>&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1039">otherwise</a></span>&gt;<span class="xmlverb-text">no line info |no line info</span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">otherwise</span>&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">choose</span>&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">template</span>&gt;<span class="xmlverb-text"><br></br>
        <br></br>
        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1045">template</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">paragraph_refs4search</span>"&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1047">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">p_id</span>"&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1049">choose</a></span>&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1051">when</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">@xml:id</span>"&gt;<span class="xmlverb-text"><br></br>
                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1053">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">@xml:id</span>" /&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">when</span>&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1056">otherwise</a></span>&gt;&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1057">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">''</span>" /&gt;&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">otherwise</span>&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">choose</span>&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">variable</span>&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1061">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">p_label</span>"&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1063">choose</a></span>&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1065">when</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">@n</span>"&gt;<span class="xmlverb-text"><br></br>
                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1067">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">concat('par ', @n)</span>" /&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">when</span>&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1070">when</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">@xml:id</span>"&gt;<span class="xmlverb-text"><br></br>
                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1072">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">concat('par ', @xml:id)</span>" /&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">when</span>&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1075">otherwise</a></span>&gt;<span class="xmlverb-text"> </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1077">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">''</span>" /&gt;&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">otherwise</span>&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">choose</span>&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">variable</span>&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1081">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$p_id</span>" /&gt;<span class="xmlverb-text">|</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1083">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$p_label</span>" /&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">template</span>&gt;<span class="xmlverb-text"><br></br>
        <br></br>
        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1086">template</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">search_file4embedded</span>"&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1088">if</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">$edition_array[1]!=''</span>"&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1090">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">edition_current</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">lower-case($edition_array[1])</span>" /&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1092">result-document</a></span> <span class="xmlverb-attr-name">method</span>="<span class="xmlverb-attr-content">text</span>" <span class="xmlverb-attr-name">href</span>="<span class="xmlverb-attr-content">{$filePrefix}/data/output_data/{$edition_current}/{$edition_current}.json</span>" <span class="xmlverb-attr-name">indent</span>="<span class="xmlverb-attr-content">no</span>"&gt;<span class="xmlverb-text"><br></br>
                                {"pages": [<br></br>
                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1094">for-each</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$root//tei:surface</span>"&gt;<span class="xmlverb-text"><br></br>
                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1096">if</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">current()/@xml:id</span>"&gt;<span class="xmlverb-text"><br></br>
                                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1098">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">pageId</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">if(@xml:id) then (@xml:id) else (@n)</span>" /&gt;<span class="xmlverb-text"><br></br>
                                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1100">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">pageLabel</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">if(@n) then (@n) else (@xml:id)</span>" /&gt;<span class="xmlverb-text"><br></br>
                                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1102">choose</a></span>&gt;<span class="xmlverb-text"><br></br>
                                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1104">when</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">current()/(descendant-or-self::lb)</span>"&gt;<span class="xmlverb-text"><br></br>
                                                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1106">for-each-group</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">current()[not(self::pb)]</span>" <span class="xmlverb-attr-name">group-starting-with</span>="<span class="xmlverb-attr-content">tei:lb</span>"&gt;<span class="xmlverb-text"><br></br>
                                                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1108">if</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">current-group()[not((string-length(normalize-space()))= 0)]</span>"&gt;<span class="xmlverb-text"><br></br>
                                                                                { <br></br>
                                                                                "line" : "</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1110">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">if(self::tei:lb/@n) then(concat(self::tei:lb/@n, '|line ',self::tei:lb/@n)) else('no line info|no line info')</span>" /&gt;<span class="xmlverb-text">",<br></br>
                                                                                "text" : "</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1112">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">var</span>"&gt;&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1113">apply-templates</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">current-group()[not(self::tei:lb)]</span>" <span class="xmlverb-attr-name">mode</span>="<span class="xmlverb-attr-content">dipl</span>" /&gt;&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">variable</span>&gt;&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1114">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">var1</span>"&gt;&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1115">apply-templates</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$var</span>" <span class="xmlverb-attr-name">mode</span>="<span class="xmlverb-attr-content">delete_el1</span>" /&gt;&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">variable</span>&gt;&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1116">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">var2</span>"&gt;&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1117">apply-templates</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$var1//text()[not(ancestor::span)]</span>" <span class="xmlverb-attr-name">mode</span>="<span class="xmlverb-attr-content">deleteSpaces</span>" /&gt;&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">variable</span>&gt;&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1118">copy-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">replace($var2, '(\\|/)', '$1$1')</span>" /&gt;<span class="xmlverb-text">",<br></br>
                                                                                "tags" : "</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1120">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">ancestor::tei:sourceDoc/@xml:id</span>" /&gt;<span class="xmlverb-text">|</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1122">choose</a></span>&gt;&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1123">when</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">ancestor::tei:sourceDoc/@n</span>"&gt;&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1124">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">ancestor::tei:sourceDoc/@n</span>" /&gt;&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">when</span>&gt;&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1125">otherwise</a></span>&gt;&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1126">call-template</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">generateTextLabel</span>"&gt;&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1127">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">text_id</span>"&gt;&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1128">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">ancestor::tei:sourceDoc/@xml:id</span>" /&gt;&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">with-param</span>&gt;&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">call-template</span>&gt;&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">otherwise</span>&gt;&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">choose</span>&gt;<span class="xmlverb-text">",<br></br>
                                                                                "loc" : "</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1131">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$pageId</span>" /&gt;<span class="xmlverb-text">|</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1133">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$pageLabel</span>" /&gt;<span class="xmlverb-text">"<br></br>
                                                                                },<br></br>
                                                                        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">if</span>&gt;<span class="xmlverb-text"><br></br>
                                                                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">for-each-group</span>&gt;<span class="xmlverb-text"><br></br>
                                                        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">when</span>&gt;<span class="xmlverb-text"><br></br>
                                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1138">when</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">current()/(descendant-or-self::line)</span>"&gt;<span class="xmlverb-text"><br></br>
                                                                </span>&lt;!--<span class="xmlverb-comment">&lt;xsl:variable name="var"&gt;&lt;xsl:apply-templates select="current-group()[not(self::tei:pb)]" mode="interp"/&gt;&lt;/xsl:variable&gt;<br></br>
                                                                &lt;xsl:copy-of select="$var//text()"&gt;&lt;/xsl:copy-of&gt;</span>--&gt;<span class="xmlverb-text"><br></br>
                                                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1142">for-each-group</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">current()/descendant::line</span>" <span class="xmlverb-attr-name">group-starting-with</span>="<span class="xmlverb-attr-content">//tei:line</span>"&gt;<span class="xmlverb-text"><br></br>
                                                                        {<br></br>
                                                                        "line" : "</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1144">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">if(@xml:id) then (@xml:id) else('no line info')</span>" /&gt;<span class="xmlverb-text">|</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1146">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">if(@n) then(concat('line ',@n)) else('no line info')</span>" /&gt;<span class="xmlverb-text">",<br></br>
                                                                        "text" : "</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1148">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">var</span>"&gt;&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1149">apply-templates</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">current-group()[not(self::tei:pb)]</span>" <span class="xmlverb-attr-name">mode</span>="<span class="xmlverb-attr-content">dipl</span>" /&gt;&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">variable</span>&gt;&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1150">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">fn:normalize-space($var)</span>" /&gt;<span class="xmlverb-text">",<br></br>
                                                                        "tags" : "</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1152">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">ancestor::tei:sourceDoc/@xml:id</span>" /&gt;<span class="xmlverb-text">|</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1154">choose</a></span>&gt;&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1155">when</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">ancestor::tei:sourceDoc/@n</span>"&gt;&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1156">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">ancestor::tei:sourceDoc/@n</span>" /&gt;&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">when</span>&gt;&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1157">otherwise</a></span>&gt;&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1158">call-template</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">generateTextLabel</span>"&gt;&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1159">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">text_id</span>"&gt;&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1160">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">ancestor::tei:sourceDoc/@xml:id</span>" /&gt;&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">with-param</span>&gt;&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">call-template</span>&gt;&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">otherwise</span>&gt;&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">choose</span>&gt;<span class="xmlverb-text">",<br></br>
                                                                        "loc" : "</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1163">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$pageId</span>" /&gt;<span class="xmlverb-text">|</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1165">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$pageLabel</span>" /&gt;<span class="xmlverb-text">"<br></br>
                                                                        },<br></br>
                                                                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">for-each-group</span>&gt;<span class="xmlverb-text"><br></br>
                                                        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">when</span>&gt;<span class="xmlverb-text"><br></br>
                                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1169">otherwise</a></span>&gt;<span class="xmlverb-text"><br></br>
                                                                {<br></br>
                                                                "line" : "no line info|no line info",<br></br>
                                                                "text" : "</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1171">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">var</span>"&gt;&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1172">apply-templates</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">current()</span>" <span class="xmlverb-attr-name">mode</span>="<span class="xmlverb-attr-content">dipl</span>" /&gt;&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">variable</span>&gt;&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1173">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">var1</span>"&gt;&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1174">apply-templates</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$var</span>" <span class="xmlverb-attr-name">mode</span>="<span class="xmlverb-attr-content">delete_el2</span>" /&gt;&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">variable</span>&gt;&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1175">copy-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$var1//text()</span>" /&gt;<span class="xmlverb-text">",<br></br>
                                                                "tags" : "</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1177">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">ancestor::tei:sourceDoc/@xml:id</span>" /&gt;<span class="xmlverb-text">|</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1179">choose</a></span>&gt;&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1180">when</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">ancestor::tei:sourceDoc/@n</span>"&gt;&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1181">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">ancestor::tei:sourceDoc/@n</span>" /&gt;&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">when</span>&gt;&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1182">otherwise</a></span>&gt;&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1183">call-template</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">generateTextLabel</span>"&gt;&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1184">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">text_id</span>"&gt;&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1185">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">ancestor::tei:sourceDoc/@xml:id</span>" /&gt;&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">with-param</span>&gt;&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">call-template</span>&gt;&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">otherwise</span>&gt;&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">choose</span>&gt;<span class="xmlverb-text">",<br></br>
                                                                "loc" : "</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1187">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$pageId</span>" /&gt;<span class="xmlverb-text">|</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1190">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$pageLabel</span>" /&gt;<span class="xmlverb-text">"<br></br>
                                                                },<br></br>
                                                        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">otherwise</span>&gt;<span class="xmlverb-text"><br></br>
                                                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">choose</span>&gt;<span class="xmlverb-text"><br></br>
                                        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">if</span>&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">for-each</span>&gt;<span class="xmlverb-text"><br></br>
                                {<br></br>
                                "line" : "",<br></br>
                                "text" : "",<br></br>
                                "tags" : "",<br></br>
                                "loc" : ""<br></br>
                                }]}<br></br>
                        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">result-document</span>&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">if</span>&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1198">if</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">$edition_array[2]!=''</span>"&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1200">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">edition_current</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">lower-case($edition_array[2])</span>" /&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1202">result-document</a></span> <span class="xmlverb-attr-name">method</span>="<span class="xmlverb-attr-content">text</span>" <span class="xmlverb-attr-name">href</span>="<span class="xmlverb-attr-content">{$filePrefix}/data/output_data/{$edition_current}/{$edition_current}.json</span>" <span class="xmlverb-attr-name">indent</span>="<span class="xmlverb-attr-content">no</span>"&gt;<span class="xmlverb-text"><br></br>
                                {"pages": [<br></br>
                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1204">for-each</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$root//tei:surface</span>"&gt;<span class="xmlverb-text"><br></br>
                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1206">if</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">current()/@xml:id</span>"&gt;<span class="xmlverb-text"><br></br>
                                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1208">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">pageId</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">if(@xml:id) then (@xml:id) else (@n)</span>" /&gt;<span class="xmlverb-text"><br></br>
                                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1210">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">pageLabel</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">if(@n) then (@n) else (@xml:id)</span>" /&gt;<span class="xmlverb-text"><br></br>
                                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1212">choose</a></span>&gt;<span class="xmlverb-text"><br></br>
                                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1214">when</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">current()/(descendant-or-self::lb)</span>"&gt;<span class="xmlverb-text"><br></br>
                                                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1216">for-each-group</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">current()</span>" <span class="xmlverb-attr-name">group-starting-with</span>="<span class="xmlverb-attr-content">tei:lb</span>"&gt;<span class="xmlverb-text"><br></br>
                                                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1218">if</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">current-group()[not((string-length(normalize-space()))= 0)]</span>"&gt;<span class="xmlverb-text"><br></br>
                                                                                { <br></br>
                                                                                "line" : "</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1220">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">if(self::tei:lb/@n) then(concat(self::tei:lb/@n, '|line ',self::tei:lb/@n)) else('no line info |no line info')</span>" /&gt;<span class="xmlverb-text">",<br></br>
                                                                                "text" : "</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1222">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">var</span>"&gt;&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1223">apply-templates</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">current-group()[not(self::tei:lb)]</span>" <span class="xmlverb-attr-name">mode</span>="<span class="xmlverb-attr-content">interp</span>" /&gt;&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">variable</span>&gt;&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1224">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">var1</span>"&gt;&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1225">apply-templates</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$var</span>" <span class="xmlverb-attr-name">mode</span>="<span class="xmlverb-attr-content">delete_el2</span>" /&gt;&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">variable</span>&gt;&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1226">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">var2</span>"&gt;&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1227">apply-templates</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$var1//text()[not(ancestor::span)]</span>" <span class="xmlverb-attr-name">mode</span>="<span class="xmlverb-attr-content">deleteSpaces</span>" /&gt;&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">variable</span>&gt;&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1228">copy-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">replace($var2, '(\\|/)', '$1$1')</span>" /&gt;<span class="xmlverb-text">",<br></br>
                                                                                "tags" : "</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1230">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">ancestor::tei:sourceDoc/@xml:id</span>" /&gt;<span class="xmlverb-text">|</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1232">choose</a></span>&gt;&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1233">when</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">ancestor::tei:sourceDoc/@n</span>"&gt;&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1234">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">ancestor::tei:sourceDoc/@n</span>" /&gt;&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">when</span>&gt;&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1235">otherwise</a></span>&gt;&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1236">call-template</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">generateTextLabel</span>"&gt;&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1237">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">text_id</span>"&gt;&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1238">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">ancestor::tei:sourceDoc/@xml:id</span>" /&gt;&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">with-param</span>&gt;&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">call-template</span>&gt;&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">otherwise</span>&gt;&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">choose</span>&gt;<span class="xmlverb-text">",<br></br>
                                                                                "loc" : "</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1241">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$pageId</span>" /&gt;<span class="xmlverb-text">|</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1243">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$pageLabel</span>" /&gt;<span class="xmlverb-text">"<br></br>
                                                                                },<br></br>
                                                                        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">if</span>&gt;<span class="xmlverb-text"><br></br>
                                                                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">for-each-group</span>&gt;<span class="xmlverb-text"><br></br>
                                                        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">when</span>&gt;<span class="xmlverb-text"><br></br>
                                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1248">when</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">current()/(descendant-or-self::p)</span>"&gt;<span class="xmlverb-text"><br></br>
                                                                </span>&lt;!--<span class="xmlverb-comment">&lt;xsl:variable name="var"&gt;&lt;xsl:apply-templates select="current-group()[not(self::tei:pb)]" mode="interp"/&gt;&lt;/xsl:variable&gt;<br></br>
                                                                &lt;xsl:copy-of select="$var//text()"&gt;&lt;/xsl:copy-of&gt;</span>--&gt;<span class="xmlverb-text"><br></br>
                                                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1252">for-each-group</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">current()/descendant::p</span>" <span class="xmlverb-attr-name">group-starting-with</span>="<span class="xmlverb-attr-content">//tei:p</span>"&gt;<span class="xmlverb-text"><br></br>
                                                                        {<br></br>
                                                                        "line" : "</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1254">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">if(@xml:id) then (@xml:id) else('no par info')</span>" /&gt;<span class="xmlverb-text">|</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1256">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">if(@n) then(concat('par ',@n)) else('no par info')</span>" /&gt;<span class="xmlverb-text">",<br></br>
                                                                        "text" : "</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1258">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">var</span>"&gt;&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1259">apply-templates</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">current-group()[not(self::tei:pb)]</span>" <span class="xmlverb-attr-name">mode</span>="<span class="xmlverb-attr-content">dipl</span>" /&gt;&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">variable</span>&gt;&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1260">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">fn:normalize-space($var)</span>" /&gt;<span class="xmlverb-text">",<br></br>
                                                                        "tags" : "</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1262">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">ancestor::tei:sourceDoc/@xml:id</span>" /&gt;<span class="xmlverb-text">|</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1264">choose</a></span>&gt;&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1265">when</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">ancestor::tei:sourceDoc/@n</span>"&gt;&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1266">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">ancestor::tei:sourceDoc/@n</span>" /&gt;&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">when</span>&gt;&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1267">otherwise</a></span>&gt;&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1268">call-template</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">generateTextLabel</span>"&gt;&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1269">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">text_id</span>"&gt;&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1270">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">ancestor::tei:sourceDoc/@xml:id</span>" /&gt;&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">with-param</span>&gt;&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">call-template</span>&gt;&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">otherwise</span>&gt;&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">choose</span>&gt;<span class="xmlverb-text">",<br></br>
                                                                        "loc" : "</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1273">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$pageId</span>" /&gt;<span class="xmlverb-text">|</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1275">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$pageLabel</span>" /&gt;<span class="xmlverb-text">"<br></br>
                                                                        },<br></br>
                                                                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">for-each-group</span>&gt;<span class="xmlverb-text"><br></br>
                                                        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">when</span>&gt;<span class="xmlverb-text"><br></br>
                                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1279">when</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">current()/(descendant-or-self::line)</span>"&gt;<span class="xmlverb-text"><br></br>
                                                                </span>&lt;!--<span class="xmlverb-comment">&lt;xsl:variable name="var"&gt;&lt;xsl:apply-templates select="current-group()[not(self::tei:pb)]" mode="interp"/&gt;&lt;/xsl:variable&gt;<br></br>
                                                                &lt;xsl:copy-of select="$var//text()"&gt;&lt;/xsl:copy-of&gt;</span>--&gt;<span class="xmlverb-text"><br></br>
                                                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1283">for-each-group</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">current()/descendant::line</span>" <span class="xmlverb-attr-name">group-starting-with</span>="<span class="xmlverb-attr-content">//tei:line</span>"&gt;<span class="xmlverb-text"><br></br>
                                                                        {<br></br>
                                                                        "line" : "</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1285">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">if(@xml:id) then (@xml:id) else('no line info')</span>" /&gt;<span class="xmlverb-text">|</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1287">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">if(@n) then(concat('line ',@n)) else('no line info')</span>" /&gt;<span class="xmlverb-text">",<br></br>
                                                                        "text" : "</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1289">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">var</span>"&gt;&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1290">apply-templates</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">current-group()[not(self::tei:pb)]</span>" <span class="xmlverb-attr-name">mode</span>="<span class="xmlverb-attr-content">dipl</span>" /&gt;&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">variable</span>&gt;&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1291">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">fn:normalize-space($var)</span>" /&gt;<span class="xmlverb-text">",<br></br>
                                                                        "tags" : "</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1293">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">ancestor::tei:sourceDoc/@xml:id</span>" /&gt;<span class="xmlverb-text">|</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1295">choose</a></span>&gt;&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1296">when</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">ancestor::tei:sourceDoc/@n</span>"&gt;&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1297">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">ancestor::tei:sourceDoc/@n</span>" /&gt;&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">when</span>&gt;&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1298">otherwise</a></span>&gt;&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1299">call-template</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">generateTextLabel</span>"&gt;&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1300">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">text_id</span>"&gt;&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1301">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">ancestor::tei:sourceDoc/@xml:id</span>" /&gt;&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">with-param</span>&gt;&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">call-template</span>&gt;&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">otherwise</span>&gt;&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">choose</span>&gt;<span class="xmlverb-text">",<br></br>
                                                                        "loc" : "</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1304">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$pageId</span>" /&gt;<span class="xmlverb-text">|</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1306">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$pageLabel</span>" /&gt;<span class="xmlverb-text">"<br></br>
                                                                        },<br></br>
                                                                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">for-each-group</span>&gt;<span class="xmlverb-text"><br></br>
                                                        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">when</span>&gt;<span class="xmlverb-text"><br></br>
                                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1310">otherwise</a></span>&gt;<span class="xmlverb-text"><br></br>
                                                                {<br></br>
                                                                "line" : "no line info|no line info",<br></br>
                                                                "text" : "</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1312">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">var</span>"&gt;&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1313">apply-templates</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">current()</span>" <span class="xmlverb-attr-name">mode</span>="<span class="xmlverb-attr-content">interp</span>" /&gt;&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">variable</span>&gt;&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1314">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">var1</span>"&gt;&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1315">apply-templates</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$var</span>" <span class="xmlverb-attr-name">mode</span>="<span class="xmlverb-attr-content">delete_el2</span>" /&gt;&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">variable</span>&gt;&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1316">copy-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$var1//text()</span>" /&gt;<span class="xmlverb-text">",<br></br>
                                                                "tags" : "</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1318">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">ancestor::tei:sourceDoc/@xml:id</span>" /&gt;<span class="xmlverb-text">|</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1320">choose</a></span>&gt;&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1321">when</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">ancestor::tei:sourceDoc/@n</span>"&gt;&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1322">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">ancestor::tei:sourceDoc/@n</span>" /&gt;&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">when</span>&gt;&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1323">otherwise</a></span>&gt;&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1324">call-template</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">generateTextLabel</span>"&gt;&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1325">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">text_id</span>"&gt;&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1326">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">ancestor::tei:sourceDoc/@xml:id</span>" /&gt;&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">with-param</span>&gt;&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">call-template</span>&gt;&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">otherwise</span>&gt;&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">choose</span>&gt;<span class="xmlverb-text">",<br></br>
                                                                "loc" : "</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1328">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$pageId</span>" /&gt;<span class="xmlverb-text">|</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1331">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$pageLabel</span>" /&gt;<span class="xmlverb-text">"<br></br>
                                                                },<br></br>
                                                        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">otherwise</span>&gt;<span class="xmlverb-text"><br></br>
                                                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">choose</span>&gt;<span class="xmlverb-text"><br></br>
                                        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">if</span>&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">for-each</span>&gt;<span class="xmlverb-text"><br></br>
                                {<br></br>
                                "line" : "",<br></br>
                                "text" : "",<br></br>
                                "tags" : "",<br></br>
                                "loc" : ""<br></br>
                                }]}<br></br>
                        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">result-document</span>&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">if</span>&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">template</span>&gt;<span class="xmlverb-text"><br></br>
        <br></br>
        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1340">template</a></span> <span class="xmlverb-attr-name">match</span>="<span class="xmlverb-attr-content">tei:emph</span>"&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;<span class="xmlverb-element-name"><a name="d20e1342">span</a></span> <span class="xmlverb-attr-name">class</span>="<span class="xmlverb-attr-content">emph</span>"&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1344">apply-templates</a></span> /&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;/<span class="xmlverb-element-name">span</span>&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">template</span>&gt;<span class="xmlverb-text"><br></br>
        <br></br>
        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1348">template</a></span> <span class="xmlverb-attr-name">match</span>="<span class="xmlverb-attr-content">tei:p</span>"&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;<span class="xmlverb-element-name"><a name="d20e1350">p</a></span>&gt;&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1351">apply-templates</a></span> /&gt;&lt;/<span class="xmlverb-element-name">p</span>&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">template</span>&gt;<span class="xmlverb-text"><br></br>
        <br></br>
        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1354">template</a></span> <span class="xmlverb-attr-name">match</span>="<span class="xmlverb-attr-content">tei:hi[@rend]</span>"&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1356">element</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">span</span>"&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1358">attribute</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">class</span>"&gt;&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1359">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">@rend</span>" /&gt;&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">attribute</span>&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d20e1361">apply-templates</a></span> /&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">element</span>&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">template</span>&gt;<span class="xmlverb-text"><br></br>
</span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">stylesheet</span>&gt;<br></br>
</div>
</tt><br></br><br></br><br></br><br></br><br></br><br></br><br></br><br></br><br></br><br></br><br></br><br></br><br></br><br></br><br></br><br></br><br></br><br></br><br></br><br></br><br></br><br></br><br></br><br></br><br></br><br></br><br></br><br></br><br></br><br></br><br></br><br></br><br></br><br></br><br></br><br></br><br></br><br></br>v
         </body></html>
