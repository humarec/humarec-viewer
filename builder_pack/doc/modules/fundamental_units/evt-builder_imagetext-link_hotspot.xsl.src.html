<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html><head><title>XML source view</title><link rel="stylesheet" type="text/css" href="../../xmlverbatim.css"></link></head><body class="xmlverb-default"><tt>
<!-- converted by xmlverbatim.xsl 1.1, (c) O. Becker -->
<div xmlns:xd="http://www.pnp-software.com/XSLTdoc" class="xmlverb-default">&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d28e1">stylesheet</a></span><span class="xmlverb-ns-name"> xmlns:xsl</span>="<span class="xmlverb-ns-uri">http://www.w3.org/1999/XSL/Transform</span>"<span class="xmlverb-ns-name"> xmlns:xs</span>="<span class="xmlverb-ns-uri">http://www.w3.org/2001/XMLSchema</span>"<span class="xmlverb-ns-name"> xmlns:eg</span>="<span class="xmlverb-ns-uri">http://www.tei-c.org/ns/Examples</span>"<span class="xmlverb-ns-name"> xmlns:xd</span>="<span class="xmlverb-ns-uri">http://www.pnp-software.com/XSLTdoc</span>"<span class="xmlverb-ns-name"> xmlns:fn</span>="<span class="xmlverb-ns-uri">http://www.w3.org/2005/xpath-functions</span>"<span class="xmlverb-ns-name"> xmlns:tei</span>="<span class="xmlverb-ns-uri">http://www.tei-c.org/ns/1.0</span>"<span class="xmlverb-ns-name"> xmlns</span>="<span class="xmlverb-ns-uri">http://www.w3.org/1999/xhtml</span>" <span class="xmlverb-attr-name">xpath-default-namespace</span>="<span class="xmlverb-attr-content">http://www.tei-c.org/ns/1.0</span>" <span class="xmlverb-attr-name">version</span>="<span class="xmlverb-attr-content">2.0</span>" <span class="xmlverb-attr-name">exclude-result-prefixes</span>="<span class="xmlverb-attr-content">#all</span>"&gt;<span class="xmlverb-text"><br></br>
<br></br>
        </span><div class="xd">

	&lt;<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name"><a name="d28e3">doc</a></span> <span class="xmlverb-attr-name">type</span>="<span class="xmlverb-attr-content">stylesheet</span>"&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name"><a name="d28e5">short</a></span>&gt;<span class="xmlverb-text"><br></br>
                        EN: Template to create all necessary elements for text-image linking.<br></br>
                        IT: Template per la creazione degli elementi necessari per il collegamento testo immagine.<br></br>
                </span>&lt;/<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name">short</span>&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;/<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name">doc</span>&gt;</div><span class="xmlverb-text"><br></br>
<br></br>
        </span>&lt;!--<span class="xmlverb-comment"><br></br>
        &lt;xsl:variable name="DocTitle"&gt;DORT&lt;/xsl:variable&gt;<br></br>
        &lt;xsl:variable name="DocFileName"&gt;DORT&lt;/xsl:variable&gt;<br></br>
        &lt;xsl:variable name="ScaledImageWidth"&gt;480&lt;/xsl:variable&gt;<br></br>
        &lt;xsl:variable name="ScaledImageHeight"&gt;720&lt;/xsl:variable&gt;<br></br>
        &lt;xsl:variable name="ZoomImageWidth"&gt;1200&lt;/xsl:variable&gt;<br></br>
        &lt;xsl:variable name="ZoomImageHeight"&gt;1800&lt;/xsl:variable&gt;<br></br>
        &lt;xsl:variable name="ImageScaleFactor"&gt;0.4&lt;/xsl:variable&gt;<br></br>
        &lt;xsl:variable name="ScaledImageFileName"&gt;VB-104V.jpg&lt;/xsl:variable&gt;<br></br>
        &lt;xsl:variable name="ZoomImageFileName"&gt;VB-104V-B.jpg&lt;/xsl:variable&gt;<br></br>
        </span>--&gt;<span class="xmlverb-text"><br></br>
<br></br>
        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d28e11">template</a></span> <span class="xmlverb-attr-name">match</span>="<span class="xmlverb-attr-content">/</span>" <span class="xmlverb-attr-name">mode</span>="<span class="xmlverb-attr-content">ITL</span>"&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d28e13">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">n</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">tei:pb/@xml:id</span>" /&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;!--<span class="xmlverb-comment"> EN: The menu of categories and annotations. </span>--&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;!--<span class="xmlverb-comment"> IT: Il menu di categorie e associazioni. </span>--&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d28e19">element</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">div</span>"&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d28e21">attribute</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">id</span>"&gt;<span class="xmlverb-text">AnnMenu</span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">attribute</span>&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d28e24">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">CurrCategory</span>"&gt;<span class="xmlverb-text">Line</span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">variable</span>&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;!--<span class="xmlverb-comment"> EN: Mod by JK </span>--&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d28e29">element</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">div</span>"&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d28e31">attribute</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">class</span>" <span class="xmlverb-attr-name">separator</span>="<span class="xmlverb-attr-content"></span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">'AnnSubmenu_',$CurrCategory</span>" /&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;!--<span class="xmlverb-comment">&lt;xsl:element name="span"&gt;<br></br>
                                        &lt;xsl:attribute name="class"&gt;CategoryTitleClosed&lt;/xsl:attribute&gt;<br></br>
                                        &lt;xsl:attribute name="onclick"&gt;ShowCategory(this)&lt;/xsl:attribute&gt;<br></br>
                                        &lt;xsl:value-of select="$CurrCategory"/&gt;<br></br>
                                        &lt;/xsl:element&gt;</span>--&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d28e35">element</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">div</span>"&gt;<span class="xmlverb-text"><br></br>
                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d28e37">attribute</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">class</span>"&gt;<span class="xmlverb-text">AnnSubmenu</span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">attribute</span>&gt;<span class="xmlverb-text"><br></br>
                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d28e40">for-each-group</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">node()</span>" <span class="xmlverb-attr-name">group-starting-with</span>="<span class="xmlverb-attr-content">//tei:lb</span>"&gt;<span class="xmlverb-text"><br></br>
                                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d28e42">if</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">current-group()[not((string-length(normalize-space()))= 0)]</span>"&gt;&lt;!--<span class="xmlverb-comment">IT: non considera le righe vuote</span>--&gt;<span class="xmlverb-text"><br></br>
                                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d28e45">choose</a></span>&gt;<span class="xmlverb-text"><br></br>
                                                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d28e47">when</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">if(@facs) then(translate(@facs, '#', '')=$root//tei:surface[translate(@corresp, '#', '')=$n]//tei:zone[@rendition='Line']/@xml:id) else(translate(@corresp, '#', '')=$root//tei:surface[translate(@corresp, '#', '')=$n]//tei:zone/@xml:id)</span>"&gt;<span class="xmlverb-text"><br></br>
                                                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d28e49">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">CurrAnnId</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">if(@facs) then(translate(@facs, '#', '')) else(translate(@corresp, '#', ''))</span>" /&gt;<span class="xmlverb-text"><br></br>
                                                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d28e51">element</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">div</span>"&gt;<span class="xmlverb-text"><br></br>
                                                                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d28e53">attribute</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">style</span>"&gt;<span class="xmlverb-text">list-style:none;</span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">attribute</span>&gt;<span class="xmlverb-text"><br></br>
                                                                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d28e56">attribute</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">class</span>"&gt;<span class="xmlverb-text">AnnMenuItem</span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">attribute</span>&gt;<span class="xmlverb-text"><br></br>
                                                                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d28e59">attribute</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">id</span>"&gt;<span class="xmlverb-text">MenuItem_</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d28e61">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$CurrAnnId</span>" /&gt;&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">attribute</span>&gt;<span class="xmlverb-text"><br></br>
                                                                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d28e63">attribute</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">onclick</span>"&gt;<span class="xmlverb-text">JumpTo('</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d28e65">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$CurrAnnId</span>" /&gt;<span class="xmlverb-text">')</span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">attribute</span>&gt;<span class="xmlverb-text"><br></br>
                                                                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d28e68">attribute</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">onmouseover</span>"&gt;<span class="xmlverb-text">Highlight('</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d28e70">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$CurrAnnId</span>" /&gt;<span class="xmlverb-text">')</span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">attribute</span>&gt;<span class="xmlverb-text"><br></br>
                                                                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d28e74">attribute</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">onmouseout</span>"&gt;<span class="xmlverb-text">UnHighlight()</span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">attribute</span>&gt;<span class="xmlverb-text"><br></br>
                                                                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d28e77">copy-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">current-group()[not(self::tei:lb|self::tei:pb)]</span>" /&gt;<span class="xmlverb-text"><br></br>
                                                                        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">element</span>&gt;<span class="xmlverb-text"><br></br>
                                                                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">when</span>&gt;<span class="xmlverb-text"><br></br>
                                                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d28e81">otherwise</a></span>&gt;<span class="xmlverb-text"><br></br>
                                                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d28e83">copy-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">current-group()[not(self::tei:lb|self::tei:pb)]</span>" /&gt;<span class="xmlverb-text"><br></br>
                                                                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">otherwise</span>&gt;<span class="xmlverb-text"><br></br>
                                                        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">choose</span>&gt;<span class="xmlverb-text"><br></br>
                                                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">if</span>&gt;<span class="xmlverb-text"><br></br>
                                        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">for-each-group</span>&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">element</span>&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">element</span>&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">element</span>&gt;<span class="xmlverb-text"><br></br>
                        <br></br>
                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d28e92">element</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">div</span>"&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d28e94">attribute</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">id</span>"&gt;<span class="xmlverb-text">areaAnnotations</span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">attribute</span>&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d28e97">element</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">div</span>"&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d28e99">attribute</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">id</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">'realImageWidth'</span>" /&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d28e101">attribute</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">style</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">'display:none;'</span>" /&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d28e103">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$root//tei:facsimile/tei:surface[translate(@corresp, '#', '')=$n]/tei:graphic[1]/@width</span>" /&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">element</span>&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d28e106">for-each</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$root//tei:facsimile/tei:surface[translate(@corresp, '#', '')=$n]/tei:zone</span>"&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;!--<span class="xmlverb-comment"> EN: Creates a div for area annotations </span>--&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;!--<span class="xmlverb-comment"> IT: Crea un div per area annotations </span>--&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d28e112">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">CurrClass</span>"&gt;&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d28e113">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">@rendition</span>" /&gt;&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">variable</span>&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d28e115">choose</a></span>&gt;<span class="xmlverb-text">        <br></br>
                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d28e117">when</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">$CurrClass='Line'</span>"&gt;<span class="xmlverb-text"><br></br>
                                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d28e119">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">idL</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">@xml:id</span>" /&gt;<span class="xmlverb-text"><br></br>
                                                </span>&lt;!--<span class="xmlverb-comment"> IT: crea un div area solo se esiste un lb corrispondente alla zona corrente </span>--&gt;<span class="xmlverb-text"><br></br>
                                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d28e123">if</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">//self::tei:lb/translate(@facs, '#', '')=$idL</span>"&gt;<span class="xmlverb-text"><br></br>
                                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d28e125">call-template</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">Area</span>" /&gt;<span class="xmlverb-text"><br></br>
                                                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">if</span>&gt;<span class="xmlverb-text">                <br></br>
                                        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">when</span>&gt;<span class="xmlverb-text"><br></br>
                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d28e129">when</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">$CurrClass='HotSpot'</span>"&gt;<span class="xmlverb-text"><br></br>
                                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d28e131">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">idL</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">@xml:id</span>" /&gt;<span class="xmlverb-text"><br></br>
                                                </span>&lt;!--<span class="xmlverb-comment"> IT: crea un div areaHS solo se esiste un div corrispondente alla zona corrente </span>--&gt;<span class="xmlverb-text"><br></br>
                                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d28e135">if</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">//tei:div[@type='hotspot']/tei:div/translate(@facs, '#', '')=$idL</span>"&gt;<span class="xmlverb-text"><br></br>
                                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d28e137">call-template</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">Area</span>"&gt;<span class="xmlverb-text"><br></br>
                                                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d28e139">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">suffix</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">'HS'</span>" /&gt;<span class="xmlverb-text"><br></br>
                                                        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">call-template</span>&gt;<span class="xmlverb-text"><br></br>
                                                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">if</span>&gt;<span class="xmlverb-text"><br></br>
                                        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">when</span>&gt;<span class="xmlverb-text"><br></br>
                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d28e144">otherwise</a></span>&gt;<span class="xmlverb-text"><br></br>
                                        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">otherwise</span>&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">choose</span>&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">for-each</span>&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">element</span>&gt;<span class="xmlverb-text"><br></br>
                <br></br>
                </span>&lt;!--<span class="xmlverb-comment"> Now the actual annotation data itself (which will be hidden until called up). </span>--&gt;<span class="xmlverb-text">  <br></br>
                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d28e153">for-each</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$root//tei:back//tei:div[if(@facs)then(translate(@facs, '#', '')=$root//tei:surface[ends-with(@corresp, $n)]//tei:zone[@rendition='HotSpot']/@xml:id) else(translate(@corresp, '#', '')=$root//tei:surface[ends-with(@corresp, $n)]//tei:zone[@rendition='HotSpot']/@xml:id)]</span>"&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;!--<span class="xmlverb-comment"> Find out the id it's linked to, whether it happens to use @facs or @corresp to point to it. </span>--&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d28e157">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">linkId</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">if(@facs) then(translate(@facs, '#', '')) else(translate(@corresp, '#', ''))</span>" /&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d28e159">element</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">div</span>"&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d28e161">attribute</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">id</span>"&gt;<span class="xmlverb-text">Ann_</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d28e163">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$linkId</span>" /&gt;&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">attribute</span>&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d28e165">attribute</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">class</span>"&gt;<span class="xmlverb-text">Annotation</span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">attribute</span>&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d28e168">element</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">div</span>"&gt;<span class="xmlverb-text"><br></br>
                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d28e170">attribute</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">class</span>"&gt;<span class="xmlverb-text">AnnTitlebar</span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">attribute</span>&gt;<span class="xmlverb-text"><br></br>
                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d28e173">element</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">div</span>"&gt;<span class="xmlverb-text"><br></br>
                                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d28e175">attribute</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">class</span>"&gt;<span class="xmlverb-text">PopupCloser</span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">attribute</span>&gt;<span class="xmlverb-text"><br></br>
                                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d28e178">attribute</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">onclick</span>"&gt;<span class="xmlverb-text">HideAnnHS('Ann_</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d28e180">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$linkId</span>" /&gt;<span class="xmlverb-text">')</span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">attribute</span>&gt;<span class="xmlverb-text">X</span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">element</span>&gt;<span class="xmlverb-text"><br></br>
                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d28e184">element</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">div</span>"&gt;<span class="xmlverb-text"><br></br>
                                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d28e186">attribute</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">class</span>"&gt;<span class="xmlverb-text">AnnTitle</span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">attribute</span>&gt;<span class="xmlverb-text"><br></br>
                                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d28e189">attribute</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">onmousedown</span>"&gt;<span class="xmlverb-text">BeginDragHS(this.parentNode.parentNode, event)</span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">attribute</span>&gt;<span class="xmlverb-text"><br></br>
                                                </span>&lt;!--<span class="xmlverb-comment">&lt;xsl:apply-templates select="tei:head"/&gt;</span>--&gt;<span class="xmlverb-text"><br></br>
                                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d28e194">text</a></span>&gt;<span class="xmlverb-text">   </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">text</span>&gt;<span class="xmlverb-text"><br></br>
                                        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">element</span>&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">element</span>&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d28e199">element</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">div</span>"&gt;<span class="xmlverb-text"><br></br>
                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d28e201">attribute</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">class</span>"&gt;<span class="xmlverb-text">AnnText</span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">attribute</span>&gt;<span class="xmlverb-text"><br></br>
                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d28e204">attribute</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">onmousedown</span>"&gt;<span class="xmlverb-text">doNothingHS(this, event)</span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">attribute</span>&gt;<span class="xmlverb-text"><br></br>
                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d28e207">if</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">tei:figure/tei:graphic/@url</span>"&gt;<span class="xmlverb-text"><br></br>
                                                </span>&lt;<span class="xmlverb-element-name"><a name="d28e209">img</a></span> <span class="xmlverb-attr-name">alt</span>="<span class="xmlverb-attr-content">HotSpot_{$linkId}</span>"&gt;<span class="xmlverb-text"><br></br>
                                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d28e211">attribute</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">src</span>"&gt;<span class="xmlverb-text">data/input_data/images/hotspot/</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d28e213">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">tei:figure/tei:graphic/@url</span>" /&gt;&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">attribute</span>&gt;<span class="xmlverb-text"><br></br>
                                                </span>&lt;/<span class="xmlverb-element-name">img</span>&gt;<span class="xmlverb-text"><br></br>
                                        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">if</span>&gt;<span class="xmlverb-text"><br></br>
                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d28e217">for-each</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">tei:p</span>"&gt;<span class="xmlverb-text"><br></br>
                                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d28e219">apply-templates</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">.</span>" /&gt;<span class="xmlverb-text"><br></br>
                                        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">for-each</span>&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">element</span>&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">element</span>&gt;<span class="xmlverb-text">   <br></br>
                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">for-each</span>&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">template</span>&gt;<span class="xmlverb-text"><br></br>
        <br></br>
        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d28e226">template</a></span> <span class="xmlverb-attr-name">match</span>="<span class="xmlverb-attr-content">.</span>" <span class="xmlverb-attr-name">mode</span>="<span class="xmlverb-attr-content">ITLembedded</span>"&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d28e228">param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">edition_level</span>" /&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;!--<span class="xmlverb-comment"> EN: The menu of categories and annotations. </span>--&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;!--<span class="xmlverb-comment"> IT: Il menu di categorie e associazioni. </span>--&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d28e234">element</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">div</span>"&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d28e236">attribute</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">id</span>"&gt;<span class="xmlverb-text">AnnMenu</span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">attribute</span>&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d28e239">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">CurrCategory</span>"&gt;<span class="xmlverb-text">Line</span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">variable</span>&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d28e242">element</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">div</span>"&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d28e244">attribute</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">class</span>" <span class="xmlverb-attr-name">separator</span>="<span class="xmlverb-attr-content"></span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">'AnnSubmenu_',$CurrCategory</span>" /&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d28e246">element</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">div</span>"&gt;<span class="xmlverb-text"><br></br>
                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d28e248">attribute</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">class</span>"&gt;<span class="xmlverb-text">AnnSubmenu</span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">attribute</span>&gt;<span class="xmlverb-text"><br></br>
                                        </span>&lt;!--<span class="xmlverb-comment"> EN: there is an iteration on each child node of the current &lt;surface&gt;. This is necessary in order to deal with text outside &lt;zone&gt; elements </span>--&gt;<span class="xmlverb-text"><br></br>
                                        </span>&lt;!--<span class="xmlverb-comment"> IT: ciclo sui nodi figli del &lt;surface&gt; corrente, necessario per gestire del testo esterno a &lt;zone&gt; </span>--&gt;<span class="xmlverb-text"><br></br>
                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d28e255">for-each</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">current-group()/child::node()</span>"&gt;<span class="xmlverb-text"><br></br>
                                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d28e257">choose</a></span>&gt;<span class="xmlverb-text"><br></br>
                                                        </span>&lt;!--<span class="xmlverb-comment"> EN: if the current node is &lt;zone&gt; </span>--&gt;<span class="xmlverb-text"><br></br>
                                                        </span>&lt;!--<span class="xmlverb-comment"> IT: se il nodo corrente è uno &lt;zone&gt; </span>--&gt;<span class="xmlverb-text"><br></br>
                                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d28e263">when</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">self::tei:zone</span>"&gt;<span class="xmlverb-text"><br></br>
                                                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d28e265">choose</a></span>&gt;<span class="xmlverb-text"><br></br>
                                                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d28e267">when</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">current()[@lrx][@lry][@ulx][@uly]</span>"&gt;&lt;!--<span class="xmlverb-comment"> Verifico se in &lt;zone&gt; ci sono le coordinate </span>--&gt;<span class="xmlverb-text"><br></br>
                                                                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d28e270">choose</a></span>&gt;<span class="xmlverb-text"><br></br>
                                                                                        </span>&lt;!--<span class="xmlverb-comment"> EN: if the &lt;zone&gt; element is empty I need to create an alignment with the corresponding &lt;line&gt;</span>--&gt;<span class="xmlverb-text"><br></br>
                                                                                        </span>&lt;!--<span class="xmlverb-comment"> IT: se &lt;zone&gt; e' vuoto devo creare un collegamento tra lui e il &lt;line&gt; corrispondente</span>--&gt;<span class="xmlverb-text"><br></br>
                                                                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d28e276">when</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">current()[((string-length(normalize-space()))= 0)]</span>"&gt;<span class="xmlverb-text"><br></br>
                                                                                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d28e278">choose</a></span>&gt;<span class="xmlverb-text"><br></br>
                                                                                                        </span>&lt;!--<span class="xmlverb-comment"> EN: there is a check on the existence of a &lt;line&gt; element that has @facs equal to @xml:id of the &lt;zone&gt;</span>--&gt;<span class="xmlverb-text"><br></br>
                                                                                                        </span>&lt;!--<span class="xmlverb-comment"> IT: Controllo se esiste una &lt;line&gt; con l'id cui la &lt;zone&gt; fa riferimento </span>--&gt;<span class="xmlverb-text"><br></br>
                                                                                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d28e284">when</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">concat('#', @xml:id)=following-sibling::tei:line/@facs</span>"&gt;<span class="xmlverb-text"><br></br>
                                                                                                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d28e286">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">CurrAnnId</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">@xml:id</span>" /&gt;<span class="xmlverb-text"><br></br>
                                                                                                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d28e288">element</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">div</span>"&gt;<span class="xmlverb-text"><br></br>
                                                                                                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d28e290">attribute</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">style</span>"&gt;<span class="xmlverb-text">list-style:none;</span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">attribute</span>&gt;<span class="xmlverb-text"><br></br>
                                                                                                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d28e293">attribute</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">class</span>"&gt;<span class="xmlverb-text">AnnMenuItem</span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">attribute</span>&gt;<span class="xmlverb-text"><br></br>
                                                                                                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d28e296">attribute</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">id</span>"&gt;<span class="xmlverb-text">MenuItem_</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d28e298">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$CurrAnnId</span>" /&gt;&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">attribute</span>&gt;<span class="xmlverb-text"><br></br>
                                                                                                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d28e300">attribute</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">onclick</span>"&gt;<span class="xmlverb-text">JumpTo('</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d28e302">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$CurrAnnId</span>" /&gt;<span class="xmlverb-text">')</span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">attribute</span>&gt;<span class="xmlverb-text"><br></br>
                                                                                                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d28e305">attribute</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">onmouseover</span>"&gt;<span class="xmlverb-text">Highlight('</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d28e307">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$CurrAnnId</span>" /&gt;<span class="xmlverb-text">')</span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">attribute</span>&gt;<span class="xmlverb-text"><br></br>
                                                                                                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d28e311">attribute</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">onmouseout</span>"&gt;<span class="xmlverb-text">UnHighlight()</span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">attribute</span>&gt;<span class="xmlverb-text"><br></br>
                                                                                                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d28e314">copy-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">//node()[@facs=concat('#', $CurrAnnId)]</span>" /&gt;<span class="xmlverb-text"><br></br>
                                                                                                                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">element</span>&gt;<span class="xmlverb-text">        <br></br>
                                                                                                        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">when</span>&gt;<span class="xmlverb-text"><br></br>
                                                                                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d28e318">otherwise</a></span> /&gt;<span class="xmlverb-text"><br></br>
                                                                                                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">choose</span>&gt;<span class="xmlverb-text"><br></br>
                                                                                        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">when</span>&gt;<span class="xmlverb-text"><br></br>
                                                                                        </span>&lt;!--<span class="xmlverb-comment"> EN: if the &lt;zone&gt; element is not empty the corresponding text is inside itself</span>--&gt;<span class="xmlverb-text"><br></br>
                                                                                        </span>&lt;!--<span class="xmlverb-comment"> IT: se &lt;zone&gt; non e' vuoto, vuol dire che i &lt;line&gt; sono all'interno di &lt;zone&gt; stesso </span>--&gt;<span class="xmlverb-text"><br></br>
                                                                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d28e327">otherwise</a></span>&gt;<span class="xmlverb-text"><br></br>
                                                                                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d28e329">choose</a></span>&gt;<span class="xmlverb-text"><br></br>
                                                                                                        </span>&lt;!--<span class="xmlverb-comment"> EN: if inside a &lt;zone&gt; there is a &lt;graphic&gt; element, this will be transformed as an HS </span>--&gt;<span class="xmlverb-text"><br></br>
                                                                                                        </span>&lt;!--<span class="xmlverb-comment"> IT: se il figlio di &lt;zone&gt; è un &lt;graphic&gt; questo zone viene trattato come HS </span>--&gt;<span class="xmlverb-text"><br></br>
                                                                                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d28e335">when</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">current()//tei:graphic</span>"&gt;<span class="xmlverb-text"><br></br>
                                                                                                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d28e337">call-template</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">Area</span>"&gt;<span class="xmlverb-text"><br></br>
                                                                                                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d28e339">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">suffix</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">'HS'</span>" /&gt;<span class="xmlverb-text"><br></br>
                                                                                                                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">call-template</span>&gt;<span class="xmlverb-text"><br></br>
                                                                                                        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">when</span>&gt;<span class="xmlverb-text"><br></br>
                                                                                                        </span>&lt;!--<span class="xmlverb-comment"> EN: otherwise the image-text link will be created </span>--&gt;<span class="xmlverb-text"><br></br>
                                                                                                        </span>&lt;!--<span class="xmlverb-comment"> IT: altrimenti viene semplicemente creato il collegamento testo immagine </span>--&gt;<span class="xmlverb-text"><br></br>
                                                                                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d28e348">otherwise</a></span>&gt;<span class="xmlverb-text"><br></br>
                                                                                                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d28e350">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">CurrAnnId</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">if(@xml:id) then(@xml:id) else(generate-id())</span>" /&gt;<span class="xmlverb-text"><br></br>
                                                                                                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d28e352">element</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">div</span>"&gt;<span class="xmlverb-text"><br></br>
                                                                                                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d28e354">attribute</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">style</span>"&gt;<span class="xmlverb-text">list-style:none;</span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">attribute</span>&gt;<span class="xmlverb-text"><br></br>
                                                                                                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d28e357">attribute</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">class</span>"&gt;<span class="xmlverb-text">AnnMenuItem</span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">attribute</span>&gt;<span class="xmlverb-text"><br></br>
                                                                                                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d28e360">attribute</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">id</span>"&gt;<span class="xmlverb-text">MenuItem_</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d28e362">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$CurrAnnId</span>" /&gt;&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">attribute</span>&gt;<span class="xmlverb-text"><br></br>
                                                                                                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d28e364">attribute</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">onclick</span>"&gt;<span class="xmlverb-text">JumpTo('</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d28e366">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$CurrAnnId</span>" /&gt;<span class="xmlverb-text">')</span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">attribute</span>&gt;<span class="xmlverb-text"><br></br>
                                                                                                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d28e369">attribute</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">onmouseover</span>"&gt;<span class="xmlverb-text">Highlight('</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d28e371">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$CurrAnnId</span>" /&gt;<span class="xmlverb-text">')</span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">attribute</span>&gt;<span class="xmlverb-text"><br></br>
                                                                                                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d28e375">attribute</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">onmouseout</span>"&gt;<span class="xmlverb-text">UnHighlight()</span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">attribute</span>&gt;<span class="xmlverb-text"><br></br>
                                                                                                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d28e378">copy-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">current()</span>" /&gt;<span class="xmlverb-text"><br></br>
                                                                                                                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">element</span>&gt;<span class="xmlverb-text"><br></br>
                                                                                                        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">otherwise</span>&gt;<span class="xmlverb-text"><br></br>
                                                                                                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">choose</span>&gt;<span class="xmlverb-text"><br></br>
                                                                                        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">otherwise</span>&gt;<span class="xmlverb-text"><br></br>
                                                                                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">choose</span>&gt;<span class="xmlverb-text"><br></br>
                                                                        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">when</span>&gt;<span class="xmlverb-text"><br></br>
                                                                        </span>&lt;!--<span class="xmlverb-comment"> EN: if in the current &lt;zone&gt; there aren't any coordinates, the content of element will be simply copied </span>--&gt;<span class="xmlverb-text"><br></br>
                                                                        </span>&lt;!--<span class="xmlverb-comment"> IT: se nello &lt;zone&gt; corrente non ci sono le coordinate, viene semplicemente copiato il contenuto dell'elemento stesso  </span>--&gt;<span class="xmlverb-text"><br></br>
                                                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d28e390">otherwise</a></span>&gt;<span class="xmlverb-text"><br></br>
                                                                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d28e392">copy-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">current()</span>" /&gt;<span class="xmlverb-text"><br></br>
                                                                        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">otherwise</span>&gt;<span class="xmlverb-text"><br></br>
                                                                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">choose</span>&gt;<span class="xmlverb-text"><br></br>
                                                        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">when</span>&gt;<span class="xmlverb-text"><br></br>
                                                        </span>&lt;!--<span class="xmlverb-comment"> EN: if the current node is not a &lt;line&gt; or is a &lt;line&gt; but doesn't have linking attributes referring to an existing &lt;zone&gt;, the content of element will be simply copied </span>--&gt;<span class="xmlverb-text"><br></br>
                                                        </span>&lt;!--<span class="xmlverb-comment"> IT: se il nodo corrente non e' &lt;line&gt; o e' &lt;line&gt; ma non ha attributi di collegamento che fanno riferimento ad uno &lt;zone&gt; esistente, viene semplicemente copiato il contenuto dell'elemento stesso</span>--&gt;<span class="xmlverb-text"><br></br>
                                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d28e402">when</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">not(self::tei:line) or self::tei:line[not (translate(@facs, '#', '')=//tei:zone/@xml:id)]</span>"&gt;<span class="xmlverb-text"><br></br>
                                                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d28e404">copy-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">current()</span>" /&gt;<span class="xmlverb-text"><br></br>
                                                        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">when</span>&gt;<span class="xmlverb-text"><br></br>
                                                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">choose</span>&gt;<span class="xmlverb-text"><br></br>
                                        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">for-each</span>&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">element</span>&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">element</span>&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">element</span>&gt;<span class="xmlverb-text"><br></br>
                <br></br>
                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d28e412">element</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">div</span>"&gt;&lt;!--<span class="xmlverb-comment"> Div vuoti per il collegamento </span>--&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d28e415">attribute</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">id</span>"&gt;<span class="xmlverb-text">areaAnnotations</span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">attribute</span>&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d28e418">element</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">div</span>"&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d28e420">attribute</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">id</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">'realImageWidth'</span>" /&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d28e422">attribute</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">style</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">'display:none;'</span>" /&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d28e424">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">current-group()/tei:graphic[1]/@width</span>" /&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">element</span>&gt;<span class="xmlverb-text"><br></br>
                        <br></br>
                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d28e427">for-each</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">current-group()/tei:zone</span>"&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;!--<span class="xmlverb-comment"> EN: Creates a div for area annotations </span>--&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;!--<span class="xmlverb-comment"> IT: Crea un div per area annotations </span>--&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d28e433">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">CurrClass</span>"&gt;&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d28e434">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">if(@rendition) then(@rendition) else ('Zone')</span>" /&gt;&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">variable</span>&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d28e436">choose</a></span>&gt;<span class="xmlverb-text"><br></br>
                                        </span>&lt;!--<span class="xmlverb-comment"> EN: if the current &lt;zone&gt; has @rendition='HotSpot' or has a &lt;graphic&gt; element as a child, the transformation for HS are activated </span>--&gt;<span class="xmlverb-text"><br></br>
                                        </span>&lt;!--<span class="xmlverb-comment"> IT: se l'attributo @rendition di &lt;zone&gt; e' 'HotSpot' oppure se lo zone ha un figlio &lt;graphic&gt; vengono attivate le trasformazioni per l'HS</span>--&gt;<span class="xmlverb-text"><br></br>
                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d28e442">when</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">($CurrClass='HotSpot')or(current()//tei:graphic)</span>"&gt;<span class="xmlverb-text"><br></br>
                                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d28e444">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">idL</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">if(@xml:id) then (@xml:id) else (generate-id())</span>" /&gt;<span class="xmlverb-text"><br></br>
                                                </span>&lt;!--<span class="xmlverb-comment"> EN: a div areaHS will be created only if exists a corresponding div in the current &lt;zone&gt;</span>--&gt;<span class="xmlverb-text"><br></br>
                                                </span>&lt;!--<span class="xmlverb-comment"> IT: crea un div areaHS solo se esiste un div corrispondente allo &lt;zone&gt; corrente </span>--&gt;<span class="xmlverb-text"><br></br>
                                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d28e450">if</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">current()/tei:graphic/@url</span>"&gt;&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d28e451">call-template</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">embeddedHS</span>" /&gt;&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">if</span>&gt;&lt;!--<span class="xmlverb-comment"> se zone ha un figlio &lt;graphic&gt; devo richiamare il template embeddedHS </span>--&gt;<span class="xmlverb-text"><br></br>
                                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d28e454">if</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">(//tei:div[@type='hotspot']/tei:div/translate(@facs, '#', '')=$idL) or (current()//tei:graphic/@url)</span>"&gt;<span class="xmlverb-text"><br></br>
                                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d28e456">call-template</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">Area</span>"&gt;<span class="xmlverb-text"><br></br>
                                                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d28e458">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">suffix</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">'HS'</span>" /&gt;<span class="xmlverb-text"><br></br>
                                                        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">call-template</span>&gt;<span class="xmlverb-text"><br></br>
                                                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">if</span>&gt;<span class="xmlverb-text"><br></br>
                                        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">when</span>&gt;<span class="xmlverb-text"><br></br>
                                        </span>&lt;!--<span class="xmlverb-comment"> EN: otherwise the transformations for ITL areas are activated </span>--&gt;<span class="xmlverb-text"><br></br>
                                        </span>&lt;!--<span class="xmlverb-comment"> IT: altrimenti vengono attivare le trasformazioni per la generazione delle aree per l'ITL </span>--&gt;<span class="xmlverb-text"><br></br>
                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d28e468">when</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">$CurrClass!=''</span>"&gt;<span class="xmlverb-text"><br></br>
                                                </span>&lt;!--<span class="xmlverb-comment"> EN: if &lt;zone&gt; is not empty or his @xml:id does not have a correspondance in any @facs of any &lt;line&gt;<br></br>
                                                                 a div AREA corresponding to the current &lt;zone&gt; will be created </span>--&gt;<span class="xmlverb-text"><br></br>
                                                </span>&lt;!--<span class="xmlverb-comment"> IT: Se &lt;zone&gt; non e' vuoto o se il suo attributo xml:id ha una corrispondenza nel @facs di un &lt;line&gt;<br></br>
                                                                viene creato un div AREA corrispondente alla zona corrente        </span>--&gt;<span class="xmlverb-text">                                        <br></br>
                                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d28e474">if</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">(current()[not((string-length(normalize-space()))= 0)])or(concat('#', @xml:id)=following-sibling::tei:line/@facs)</span>"&gt;<span class="xmlverb-text"><br></br>
                                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d28e476">call-template</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">Area</span>" /&gt;<span class="xmlverb-text"><br></br>
                                                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">if</span>&gt;<span class="xmlverb-text"><br></br>
                                        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">when</span>&gt;<span class="xmlverb-text"><br></br>
                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d28e480">otherwise</a></span>&gt;<span class="xmlverb-text"><br></br>
                                        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">otherwise</span>&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">choose</span>&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;!--<span class="xmlverb-comment"> EN: &lt;zone&gt; elements inside other &lt;zone&gt; elements are treted as HS, where the text is the content of the inner &lt;zone&gt;</span>--&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;!--<span class="xmlverb-comment"> IT: &lt;zone&gt; interni ad altri zone sono considerati HS, il cui testo e' il contenuto dello &lt;zone&gt; piu' interno</span>--&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d28e489">for-each</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">current()//tei:zone</span>"&gt;<span class="xmlverb-text"><br></br>
                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d28e491">call-template</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">embeddedHS</span>" /&gt;<span class="xmlverb-text"><br></br>
                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d28e493">if</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">(current()[not((string-length(normalize-space()))= 0)])or(concat('#', @xml:id)=following-sibling::tei:line/@facs)</span>"&gt;<span class="xmlverb-text"><br></br>
                                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d28e495">call-template</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">Area</span>"&gt;<span class="xmlverb-text"><br></br>
                                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d28e497">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">suffix</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">'HS'</span>" /&gt;<span class="xmlverb-text"><br></br>
                                                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">call-template</span>&gt;<span class="xmlverb-text"><br></br>
                                        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">if</span>&gt;<span class="xmlverb-text">                                        <br></br>
                                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">for-each</span>&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">for-each</span>&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">element</span>&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">template</span>&gt;<span class="xmlverb-text"><br></br>
        <br></br>
        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d28e505">template</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">embeddedHS</span>"&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d28e507">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">linkId</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">if(@xml:id) then(@xml:id) else(generate-id())</span>" /&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d28e509">element</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">div</span>"&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d28e511">attribute</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">id</span>"&gt;<span class="xmlverb-text">Ann_</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d28e513">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$linkId</span>" /&gt;&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">attribute</span>&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d28e515">attribute</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">class</span>"&gt;<span class="xmlverb-text">Annotation</span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">attribute</span>&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d28e518">element</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">div</span>"&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d28e520">attribute</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">class</span>"&gt;<span class="xmlverb-text">AnnTitlebar</span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">attribute</span>&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d28e523">element</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">div</span>"&gt;<span class="xmlverb-text"><br></br>
                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d28e525">attribute</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">class</span>"&gt;<span class="xmlverb-text">PopupCloser</span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">attribute</span>&gt;<span class="xmlverb-text"><br></br>
                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d28e528">attribute</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">onclick</span>"&gt;<span class="xmlverb-text">HideAnnHS('Ann_</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d28e530">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$linkId</span>" /&gt;<span class="xmlverb-text">')</span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">attribute</span>&gt;<span class="xmlverb-text">X</span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">element</span>&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d28e534">element</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">div</span>"&gt;<span class="xmlverb-text"><br></br>
                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d28e536">attribute</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">class</span>"&gt;<span class="xmlverb-text">AnnTitle</span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">attribute</span>&gt;<span class="xmlverb-text"><br></br>
                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d28e539">attribute</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">onmousedown</span>"&gt;<span class="xmlverb-text">BeginDragHS(this.parentNode.parentNode, event)</span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">attribute</span>&gt;<span class="xmlverb-text"><br></br>
                                        </span>&lt;!--<span class="xmlverb-comment">&lt;xsl:apply-templates select="tei:head"/&gt;</span>--&gt;<span class="xmlverb-text"><br></br>
                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d28e544">text</a></span>&gt;<span class="xmlverb-text">   </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">text</span>&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">element</span>&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">element</span>&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d28e549">element</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">div</span>"&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d28e551">attribute</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">class</span>"&gt;<span class="xmlverb-text">AnnText</span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">attribute</span>&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d28e554">attribute</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">onmousedown</span>"&gt;<span class="xmlverb-text">doNothingHS(this, event)</span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">attribute</span>&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d28e557">if</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">(tei:figure/tei:graphic/@url)or(current()//tei:graphic)</span>"&gt;<span class="xmlverb-text"><br></br>
                                        </span>&lt;<span class="xmlverb-element-name"><a name="d28e559">img</a></span> <span class="xmlverb-attr-name">alt</span>="<span class="xmlverb-attr-content">HotSpot_{$linkId}</span>"&gt;<span class="xmlverb-text"><br></br>
                                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d28e561">attribute</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">src</span>"&gt;<span class="xmlverb-text">data/input_data/images/hotspot/</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d28e563">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">if(current()/tei:graphic) then(current()/tei:graphic/@url) else (tei:figure/tei:graphic/@url)</span>" /&gt;&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">attribute</span>&gt;<span class="xmlverb-text"><br></br>
                                        </span>&lt;/<span class="xmlverb-element-name">img</span>&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">if</span>&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d28e567">for-each</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">current()</span>"&gt;<span class="xmlverb-text"><br></br>
                                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d28e569">apply-templates</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">.</span>" /&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">for-each</span>&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">element</span>&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">element</span>&gt;<span class="xmlverb-text">   <br></br>
        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">template</span>&gt;<span class="xmlverb-text"><br></br>
        <br></br>
        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d28e576">template</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">Area</span>"&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d28e578">param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">suffix</span>" /&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d28e580">element</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">div</span>"&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;!--<span class="xmlverb-comment">&lt;xsl:variable name="CurrRectId" select="@xml:id"/&gt;</span>--&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;!--<span class="xmlverb-comment"> CDP:embedded </span>--&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d28e586">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">CurrRectId</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">if(@xml:id) then(@xml:id) else(generate-id())</span>" /&gt;<span class="xmlverb-text"><br></br>
                        <br></br>
                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d28e588">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">RectWidth</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">number(@lrx) - number(@ulx)</span>" /&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d28e590">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">RectHeight</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">number(@lry) - number(@uly)</span>" /&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d28e593">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">suf</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">if ($suffix) then($suffix) else()</span>" /&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d28e595">attribute</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">id</span>"&gt;<span class="xmlverb-text">Area_</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d28e597">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$CurrRectId</span>" /&gt;&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">attribute</span>&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d28e599">attribute</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">class</span>"&gt;<span class="xmlverb-text">Area</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d28e601">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$suf</span>" /&gt;&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">attribute</span>&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d28e603">attribute</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">onclick</span>"&gt;<span class="xmlverb-text">ShowAnn</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d28e605">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$suf</span>" /&gt;<span class="xmlverb-text">('</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d28e607">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$CurrRectId</span>" /&gt;<span class="xmlverb-text">')</span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">attribute</span>&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;!--<span class="xmlverb-comment"> EN: Adds a double-click event to show the full-scale image fragment if using scale/zoom. </span>--&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;!--<span class="xmlverb-comment"> IT: Aggiunge un evento di tipo doppio click per mostrare il frammento di immagine a piena risoluzione se si usa lo zoom. </span>--&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;!--<span class="xmlverb-comment">&lt;xsl:if test="number($ImageScaleFactor) &amp;lt; 1"&gt;<br></br>
                                                &lt;xsl:attribute name="ondblclick"&gt;ShowZoom(&lt;xsl:value-of select="@ulx"/&gt;,&lt;xsl:value-of select="@uly"/&gt;,&lt;xsl:value-of<br></br>
                                                select="$RectWidth"/&gt;,&lt;xsl:value-of select="$RectHeight"/&gt;)&lt;/xsl:attribute&gt;<br></br>
                                        &lt;/xsl:if&gt;</span>--&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d28e617">attribute</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">onmouseover</span>"&gt;<span class="xmlverb-text">Highlight</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d28e619">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$suf</span>" /&gt;<span class="xmlverb-text">('</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d28e621">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$CurrRectId</span>" /&gt;<span class="xmlverb-text">')</span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">attribute</span>&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d28e624">attribute</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">onmouseout</span>"&gt;<span class="xmlverb-text">UnHighlight</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d28e626">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$suf</span>" /&gt;<span class="xmlverb-text">()</span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">attribute</span>&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;!--<span class="xmlverb-comment"> EN: Calculate the scaled dimensions of the annotation area on the image. </span>--&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;!--<span class="xmlverb-comment"> IT: Calcola le dimensioni in scala dell'area di annotazione dell'immagine. </span>--&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;!--<span class="xmlverb-comment">&lt;xsl:variable name="BoxL"&gt;&lt;xsl:value-of select="round(@ulx * number($ImageScaleFactor))"/&gt;&lt;/xsl:variable&gt;<br></br>
                                        &lt;xsl:variable name="BoxT"&gt;&lt;xsl:value-of select="round(@uly * number($ImageScaleFactor))"/&gt;&lt;/xsl:variable&gt;<br></br>
                                        &lt;xsl:variable name="BoxW"&gt;&lt;xsl:value-of select="round($RectWidth * number($ImageScaleFactor))"/&gt;&lt;/xsl:variable&gt;<br></br>
                                        &lt;xsl:variable name="BoxH"&gt;&lt;xsl:value-of select="round($RectHeight * number($ImageScaleFactor))"/&gt;&lt;/xsl:variable&gt;</span>--&gt;<span class="xmlverb-text"><br></br>
                        <br></br>
                        </span>&lt;!--<span class="xmlverb-comment"> EN: Creates the style tag. </span>--&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;!--<span class="xmlverb-comment"> IT: Crea lo style tag. </span>--&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d28e640">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">CurrStyle</span>"&gt;<span class="xmlverb-text"><br></br>
                                position: absolute; left: </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d28e642">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">@ulx</span>" /&gt;<span class="xmlverb-text">px; top: </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d28e644">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">@uly</span>" /&gt;<span class="xmlverb-text">px;<br></br>
                                width: </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d28e646">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$RectWidth</span>" /&gt;<span class="xmlverb-text">px; height: </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d28e648">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$RectHeight</span>" /&gt;<span class="xmlverb-text">px;<br></br>
                                </span>&lt;!--<span class="xmlverb-comment"> Add the colour setting from the tagsDecl in the header. </span>--&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;!--<span class="xmlverb-comment">&lt;xsl:value-of select="//tei:tagsDecl/tei:rendition[@xml:id=$CurrClass]/tei:code"/&gt;;</span>--&gt;<span class="xmlverb-text"><br></br>
                                padding: 0; cursor: pointer;<br></br>
                                </span>&lt;!--<span class="xmlverb-comment"> EN: Includes a font-size setting to make the non-breaking spaces take up most of the box. If we don't do this, then IE will not process mouseover messages for the box (except at the top left, where the nbsp is). Make the text centred in the box. </span>--&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;!--<span class="xmlverb-comment"> IT: Include un'impostazione relativa alle dimensioni del font per far sì che i gli spazi non-breaking occupino la maggior parte del box. Se non si agisce in questo modo, allora IE non interpreterà correttamente i messaggi mouseover per il box (fatta eccezione per in alto a sinistra, dove si trova il nbsp). Centra il testo nel box. </span>--&gt;<span class="xmlverb-text"><br></br>
                                font-size: </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d28e659">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">($RectHeight - 6)</span>" /&gt;<span class="xmlverb-text">px; text-align: center;<br></br>
                                vertical-align: middle; display: none;<br></br>
                                </span>&lt;!--<span class="xmlverb-comment"> EN: Sets it to overflow: hidden, so that we can be sure if there are too many spaces in the box, it will not cause scrollbars. </span>--&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;!--<span class="xmlverb-comment"> IT: Imposta l'opzione overflow: hidden, in modo da essere sicuri che se ci sono troppi spazi nel box non saranno create delle scrollbar. </span>--&gt;<span class="xmlverb-text"><br></br>
                                overflow: hidden;<br></br>
                                </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d28e665">if</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">@rotate</span>"&gt;<span class="xmlverb-text"><br></br>
                                        transform: rotate(</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d28e667">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">@rotate</span>" /&gt;<span class="xmlverb-text">deg);<br></br>
                                        -ms-transform: rotate(</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d28e669">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">@rotate</span>" /&gt;<span class="xmlverb-text">deg); /* IE 9 */<br></br>
                                        -webkit-transform: rotate(</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d28e671">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">@rotate</span>" /&gt;<span class="xmlverb-text">deg); /* Safari and Chrome */<br></br>
                                        -moz-transform:rotate(</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d28e673">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">@rotate</span>" /&gt;<span class="xmlverb-text">deg);</span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">if</span>&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">variable</span>&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d28e677">attribute</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">style</span>"&gt;&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d28e678">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">normalize-space($CurrStyle)</span>" /&gt;&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">attribute</span>&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;!--<span class="xmlverb-comment"> EN: Includes the string value of the head tag as a title element to give us a mouseover hint. </span>--&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;!--<span class="xmlverb-comment"> IT: Include il valore dell'elemento head come titolo per darci un mouseover hint. </span>--&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;!--<span class="xmlverb-comment">&lt;xsl:attribute name="title"&gt;<br></br>
                                                &lt;xsl:choose&gt;<br></br>
                                                        &lt;xsl:when test="//tei:div[@facs = concat('#', $CurrRectId)]"&gt;&lt;xsl:value-of select="//tei:div[@facs = $CurrRectId]/tei:head"/&gt;&lt;/xsl:when&gt;<br></br>
                                                        &lt;xsl:otherwise&gt;&lt;xsl:value-of select="//tei:div[@corresp = concat('#', $CurrRectId)]/tei:head"/&gt;&lt;/xsl:otherwise&gt;<br></br>
                                                &lt;/xsl:choose&gt;<br></br>
                                                &lt;xsl:if test="number($ImageScaleFactor) &amp;lt; 1"&gt;(Double-click to zoom.)&lt;/xsl:if&gt;<br></br>
                                        &lt;/xsl:attribute&gt;</span>--&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;!--<span class="xmlverb-comment"> EN: Adds a non-breaking spaces to give some real content. </span>--&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;!--<span class="xmlverb-comment"> IT: Aggiunge degli spazi per creare un contenuto effettivo. </span>--&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d28e691">text</a></span>&gt;<span class="xmlverb-text">   </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">text</span>&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">element</span>&gt;<span class="xmlverb-text"><br></br>
                <br></br>
        </span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">template</span>&gt;<span class="xmlverb-text"><br></br>
<br></br>
</span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">stylesheet</span>&gt;<br></br>
</div>
</tt><br></br><br></br><br></br><br></br><br></br><br></br><br></br><br></br><br></br><br></br><br></br><br></br><br></br><br></br><br></br><br></br><br></br><br></br><br></br><br></br><br></br><br></br><br></br><br></br><br></br><br></br><br></br><br></br><br></br><br></br><br></br><br></br><br></br><br></br><br></br><br></br><br></br><br></br>v
         </body></html>
